(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    206125,       5084]
NotebookOptionsPosition[    198576,       4953]
NotebookOutlinePosition[    198969,       4969]
CellTagsIndexPosition[    198926,       4966]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Misc", "Subsection",
 CellChangeTimes->{{3.948464730543132*^9, 3.9484647406995296`*^9}, {
  3.948614136762987*^9, 
  3.948614139549883*^9}},ExpressionUUID->"5343f9c6-9da5-429e-9fb4-\
f2612009e761"],

Cell[CellGroupData[{

Cell["Phase Space", "Subsubsection",
 CellChangeTimes->{{3.949850126259013*^9, 
  3.9498501300276327`*^9}},ExpressionUUID->"845d9d88-4bdb-4de3-b4be-\
d5c723641334"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bathTemps", "=", 
   RowBox[{"N", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"E", "^", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "2.5"}], ",", "4.5", ",", "0.2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gammas", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0.2", ",", "10.25", ",", "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"(", 
  RowBox[{
   RowBox[{"alpha", "=", "3.5"}], ";", " ", 
   RowBox[{"Q", "=", "99"}], ";", " ", 
   RowBox[{"P", "=", "130"}], ";", " ", 
   RowBox[{"NN", "=", "160"}], ";"}], ")"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setups", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "alpha", ",", "Q", ",", "P", ",", "NN", ",", "theta", ",", "gamma"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"theta", ",", "bathTemps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"gamma", ",", "gammas"}], "}"}]}], "]"}], ",", "1"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConfigNumber", "=", 
   RowBox[{"Length", "[", "setups", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"8a44a3e0-ce0e-478b-a929-7a2e7cfc0eed"]
}, Closed]],

Cell[CellGroupData[{

Cell["Helper Function", "Subsubsection",
 CellChangeTimes->{{3.948614141224743*^9, 
  3.9486141425937862`*^9}},ExpressionUUID->"cd6019d3-1057-4669-a05f-\
335ecf1bc5bc"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", " ", "Get"}]}]}]}]}]}]}]}], " ", "position", " ", 
     "on", " ", "phase", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"plot", " ", "--"}], "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", "-"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ind2Coord", "[", 
     RowBox[{"ind_", ",", 
      RowBox[{"rowLength_", ":", "36"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"row", ",", "column"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"row", "=", 
        RowBox[{"Quotient", "[", 
         RowBox[{"ind", ",", "rowLength"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"column", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{"ind", ",", "rowLength"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"row", ",", "column"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", " ", 
               RowBox[{"John", "'"}]}]}]}]}]}]}]}]}]}]}], "s", " ", 
     RowBox[{
      RowBox[{"setup", " ", "--"}], "--"}], 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"barrierE", "=", "2"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"deltaE", " ", "=", " ", "1.3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xm", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"johnPotential", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"barrierE", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["x", "xm"], ")"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["x", "xm"], ")"}], "4"]}], ")"}]}], "-", 
       RowBox[{
        FractionBox["deltaE", "2"], 
        RowBox[{"(", 
         FractionBox["x", "xm"], ")"}]}]}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CoefficientList", "[", 
     RowBox[{"johnPotential", ",", "x"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"johnsCoeff", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.65"}], ",", 
       RowBox[{"-", "8"}], ",", "0", ",", "8"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "johnPotential", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Potential", "[", 
     RowBox[{"x", ",", "johnsCoeff"}], "]"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"basis", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], 
                "--"}]}]}]}]}]}]}]}]}]}]}], 
     RowBox[{"--", 
      RowBox[{"--", "-"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"n_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "normalization", ",", " ", "gaussianPart", ",", " ", "hermitePart"}],
          "}"}], ",", "\n", "    ", 
        RowBox[{
         RowBox[{"normalization", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "^", "n"}], " ", 
             RowBox[{"n", "!"}], " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"2", " ", "\[Pi]"}], "]"}]}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}]}], ")"}]}]}], ";", "\n", "    ", 
         
         RowBox[{"gaussianPart", " ", "=", " ", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "^", "2"}], "/", "4"}], ")"}]}], ")"}]}]}], ";", 
         "\n", "    ", 
         RowBox[{"hermitePart", " ", "=", " ", 
          RowBox[{"HermiteH", "[", 
           RowBox[{"n", ",", " ", 
            RowBox[{"x", "/", 
             RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}]}], ";", "\n", "    ", 
         
         RowBox[{
         "normalization", "*", "gaussianPart", "*", "hermitePart"}]}]}], "\n",
        "    ", "]"}]}], ";"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "normalization", ",", "gaussianPart", ",", "hermitePart", ",", "p"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"Precision", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"normalization", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "^", "n"}], " ", 
              RowBox[{"n", "!"}], " ", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", " ", "\[Pi]"}], "]"}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}]}], ")"}]}], ",", "p"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"gaussianPart", "=", 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "^", "2"}], "/", "4"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hermitePart", "=", 
         RowBox[{"HermiteH", "[", 
          RowBox[{"n", ",", 
           RowBox[{"x", "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"SetPrecision", "[", 
              RowBox[{"2", ",", "p"}], "]"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "normalization", "*", "gaussianPart", "*", "hermitePart"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", "Force"}]}]}]}]}]}]}], " ", "from", " ", "the", " ", 
      
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"potential", "--"}], "--"}], "--"}], "--"}], "--"}], 
       "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"force", "[", 
       RowBox[{"x_", ",", " ", "polyCoeff_"}], "]"}], " ", ":=", "\n", "   ", 
      
      RowBox[{
       RowBox[{"polyCoeff", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "+", "\n", "    ", 
       RowBox[{
        RowBox[{"polyCoeff", "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", 
        RowBox[{"x", "^", "1"}]}], " ", "+", "\n", "    ", 
       RowBox[{
        RowBox[{"polyCoeff", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", 
        RowBox[{"x", "^", "2"}]}], " ", "+", "\n", "    ", 
       RowBox[{
        RowBox[{"polyCoeff", "[", 
         RowBox[{"[", "4", "]"}], "]"}], " ", 
        RowBox[{"x", "^", "3"}]}]}]}], ";"}], "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"force", "[", 
      RowBox[{"x_", ",", "polyCoeff_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "p", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Precision", "[", "x", "]"}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{"Precision", "/@", "polyCoeff"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SetPrecision", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"polyCoeff", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "p"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"polyCoeff", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "p"}], "]"}], "*", 
          RowBox[{"x", "^", "1"}]}], "+", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"polyCoeff", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "p"}], "]"}], "*", 
          RowBox[{"x", "^", "2"}]}], "+", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"polyCoeff", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", "p"}], "]"}], "*", 
          RowBox[{"x", "^", "3"}]}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", " ", "\[IndentingNewLine]", " ", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Potential", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], 
                "--"}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Potential", "[", 
       RowBox[{"x_", ",", " ", "polyCoeff_"}], "]"}], " ", ":=", "\n", "   ", 
      
      RowBox[{
       RowBox[{
        RowBox[{"polyCoeff", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", 
        RowBox[{
         RowBox[{"x", "^", "1"}], "/", "1"}]}], " ", "+", "\n", "    ", 
       RowBox[{
        RowBox[{"polyCoeff", "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "/", "2"}]}], " ", "+", "\n", "    ", 
       RowBox[{
        RowBox[{"polyCoeff", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", 
        RowBox[{
         RowBox[{"x", "^", "3"}], "/", "3"}]}], " ", "+", "\n", "    ", 
       RowBox[{
        RowBox[{"polyCoeff", "[", 
         RowBox[{"[", "4", "]"}], "]"}], " ", 
        RowBox[{
         RowBox[{"x", "^", "4"}], "/", "4"}]}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Potential", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"polyCoeff_", ":", "johnsCoeff"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "p", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Precision", "[", "x", "]"}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{"Precision", "/@", "polyCoeff"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SetPrecision", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"polyCoeff", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "p"}], "]"}], "*", 
          RowBox[{
           RowBox[{"x", "^", "1"}], "/", "1"}]}], "+", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"polyCoeff", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "p"}], "]"}], "*", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "/", "2"}]}], "+", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"polyCoeff", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "p"}], "]"}], "*", 
          RowBox[{
           RowBox[{"x", "^", "3"}], "/", "3"}]}], "+", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"polyCoeff", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", "p"}], "]"}], "*", 
          RowBox[{
           RowBox[{"x", "^", "4"}], "/", "4"}]}]}]}]}], "]"}]}], ";"}], "\n", 
   "\n", " ", "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Normalization", " ", "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], 
                "--"}]}]}]}]}]}]}]}]}]}]}], "-"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"positionPrefactor", "[", " ", 
       RowBox[{"theta_", " ", ",", "polyCoeff_"}], "]"}], " ", ":=", "\n", 
      "   ", 
      RowBox[{"1", "/", 
       RowBox[{"NIntegrate", "[", "\n", "     ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Potential", "[", 
             RowBox[{"x", ",", " ", "polyCoeff"}], "]"}]}], "/", "theta"}], 
          "]"}], ",", "\n", "     ", 
         RowBox[{"{", 
          RowBox[{"x", ",", " ", 
           RowBox[{"-", "Infinity"}], ",", " ", "Infinity"}], "}"}]}], "\n", 
        "     ", "]"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"positionPrefactor", "[", 
     RowBox[{"theta_", ",", "polyCoeff_"}], "]"}], ":=", 
    RowBox[{"1", "/", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Potential", "[", 
           RowBox[{"x", ",", "polyCoeff"}], "]"}]}], "/", "theta"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
       RowBox[{"WorkingPrecision", "->", 
        RowBox[{"Precision", "[", "theta", "]"}]}], ",", 
       RowBox[{"PrecisionGoal", "->", 
        RowBox[{"Min", "[", 
         RowBox[{"10", ",", 
          RowBox[{
           RowBox[{"Precision", "[", "theta", "]"}], "-", "5"}]}], "]"}]}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Stationary"}]}]}]}]}]}]}]}]}], " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"state", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}], "--"}], "--"}]}], "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"wst", "[", 
      RowBox[{"theta_", " ", ",", " ", "polyCoeff_"}], "]"}], " ", ":=", " ", 
     "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"N", "@", " ", 
        RowBox[{"positionPrefactor", "[", 
         RowBox[{"theta", ",", "polyCoeff"}], "]"}]}], " ", "/", 
       SqrtBox[
        RowBox[{
         RowBox[{"2", "/", "\[Pi]"}], "/", "theta"}]]}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Potential", "[", 
            RowBox[{"x", ",", " ", "polyCoeff"}], "]"}], " ", "+", " ", 
           RowBox[{
            SuperscriptBox["v", "2"], "/", "2"}]}], ")"}]}], "/", "theta"}], 
       "]"}]}]}], "\n", "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"wst", "[", 
     RowBox[{"theta_", ",", 
      RowBox[{"polyCoeff_", ":", "johnsCoeff"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"SetPrecision", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"positionPrefactor", "[", 
         RowBox[{"theta", ",", "polyCoeff"}], "]"}], "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"2", "/", "Pi"}], "/", "theta"}], "]"}]}], " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Potential", "[", 
             RowBox[{"x", ",", "polyCoeff"}], "]"}], "+", 
            RowBox[{
             RowBox[{"v", "^", "2"}], "/", "2"}]}], ")"}]}], "/", "theta"}], 
        "]"}]}], ",", 
      RowBox[{"Precision", "[", "theta", "]"}]}], "]"}]}], "\n", "\n", "\n", 
   " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Kramer"}]}]}]}]}]}]}]}]}], " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Operators", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}], "--"}], "--"}]}], "*)"}], "\n", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"adjointFokkerPlanck", "[", 
      RowBox[{"f_", ",", " ", "polyCoeff_"}], "]"}], " ", ":=", "\n", "     ", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"f", ",", " ", "x"}], "]"}], " ", "v"}], " ", "-", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gamma", " ", "v"}], " ", "+", " ", 
           RowBox[{"force", "[", 
            RowBox[{"x", ",", " ", "polyCoeff"}], "]"}]}], ")"}], " ", "f"}], 
        ",", " ", "v"}], "]"}], " ", "+", " ", 
      RowBox[{"gamma", " ", "theta", " ", 
       RowBox[{"D", "[", 
        RowBox[{"f", ",", " ", 
         RowBox[{"{", 
          RowBox[{"v", ",", " ", "2"}], "}"}]}], "]"}]}]}]}], ";"}], "\n", 
   " ", "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", "Adjoint"}]}]}]}]}]}]}], " ", "Kramer", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Operators", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
      "--"}]}], "*)"}], "\n", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"fokkerPlanck", "[", 
      RowBox[{"f_", ",", " ", "polyCoeff_"}], "]"}], " ", ":=", "\n", "   ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"D", "[", 
         RowBox[{"f", ",", " ", "x"}], "]"}]}], " ", "v"}], " ", "+", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gamma", " ", "v"}], " ", "+", " ", 
           RowBox[{"force", "[", 
            RowBox[{"x", ",", " ", "polyCoeff"}], "]"}]}], ")"}], " ", "f"}], 
        ",", " ", "v"}], "]"}], " ", "+", " ", 
      RowBox[{"gamma", " ", "theta", " ", 
       RowBox[{"D", "[", 
        RowBox[{"f", ",", " ", 
         RowBox[{"{", 
          RowBox[{"v", ",", " ", "2"}], "}"}]}], "]"}]}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQzdOxP0Uy+63jTrPXYPpq5dEaaSC94IBaLYhWObTL
whVIV6WutwTR05/yOoHoNb2XXVzB+gotk4D0P5n9ViB6x+3dcqlAel7eQUUQ
vfqlyOWfQLotyxJMq0e9uQ6il8ksvwmiM/rZXv4C0l7vDV6B6GUfbZ/k5rx1
VJqx4QWIFr9abX+r4K3jETENZxC9oPX+aRCtXGZzHUQ/EHxxT7sQ6I58y/sg
uuLwU8HrQDps1h9hEK0kddMfRCv7+gaA6KgrL7Rbi946Jnj81wPRffPnJE8E
0lbrS1JA9IE7Ht7vS986foyYD6aX8a49JFP21rGsaM1xEA0Ac5Sidg==
  "],ExpressionUUID->"6440dace-4702-4a83-b079-b623e148ae42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testValue", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "->", "0"}], ",", 
     RowBox[{"v", "->", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9488113323358917`*^9, 3.948811346343232*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"b4c7a629-b164-4514-8c43-2ddbcc7b1398"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot Shortcuts", "Subsubsection",
 CellChangeTimes->{{3.948614106611561*^9, 
  3.9486141137385073`*^9}},ExpressionUUID->"b08187f5-860e-4448-af56-\
8d856893b286"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"SME", " ", "Heat", " ", "map"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<WK_ti_tb.gif\>\"", ",", "listplots", ",", 
     RowBox[{"\"\<AnimationRepetitions\>\"", "->", "Infinity"}], ",", 
     RowBox[{"\"\<DisplayDurations\>\"", "->", "1"}]}], "]"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"listplots", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"GfileNames", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"fileNames", ",", 
          RowBox[{
           RowBox[{"StringMatchQ", "[", 
            RowBox[{"#", ",", 
             RowBox[{
             "___", "~~", "\"\</checkpoint_\>\"", "~~", "DigitCharacter", "~~",
               "DigitCharacter", "~~", "DigitCharacter", "~~", 
              "DigitCharacter", "~~", 
              RowBox[{"\"\<_\>\"", "<>", 
               RowBox[{"ToString", "[", "gamma", "]"}], "<>", "\"\<_\>\""}], "~~",
               "___"}]}], "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"Heatmap", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ckpt", "=", 
           RowBox[{"Import", "[", "filename", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "@", "ckpt"}], "=!=", "Association"}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ovlaps", "=", 
           RowBox[{
            RowBox[{"ckpt", "[", 
             RowBox[{"[", "\"\<Overlaps\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"reverse", "=", 
           RowBox[{"Sign", "[", 
            RowBox[{"ovlaps", "[", 
             RowBox[{"[", 
              RowBox[{"12", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ovlaps", "=", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Transpose", "[", "ovlaps", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"reverse", " ", 
               RowBox[{
                RowBox[{"Transpose", "[", "ovlaps", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"PrependTo", "[", 
             RowBox[{
              RowBox[{"ovlaps", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"ckpt", "[", 
               RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "ovlaps"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"Heatmap", ",", "ovlaps"}], "]"}]}], "\[IndentingNewLine]",
          ",", 
         RowBox[{"{", 
          RowBox[{"filename", ",", "GfileNames"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"listplots", ",", 
         RowBox[{"ListContourPlot", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Heatmap", ",", "1"}], "]"}], ",", 
           RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
           RowBox[{"Contours", "->", "Automatic"}]}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"gamma", ",", "gammas"}], "}"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.950288502614373*^9, 3.950288523933127*^9}, {
  3.950289912009893*^9, 3.950289915776723*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"a4480444-a9e3-4d7e-89d0-14b1e8d35e8c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plot3", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"bound_", ":", "3"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Plot3D", "[", 
    RowBox[{"f", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", 
       RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
     RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotC", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"bound_", ":", "3"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ContourPlot", "[", 
   RowBox[{"f", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"v", ",", 
      RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "->", "Automatic"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "->", "All"}], ",", "\[IndentingNewLine]", 
    RowBox[{"GridLines", "->", "Automatic"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.948614118770156*^9, 3.9486141189967613`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"1934686c-c9c1-4b7d-beb3-abb47521777a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"smPlots", "[", "SMstates_", "]"}], ":=", 
  RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{"SMstates", ",", "34"}], " ", 
     RowBox[{"(*", 
      RowBox[{"Length", "@", "gammas"}], "*)"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FrameTicks", "->", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"gammas", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "gammas", "]"}], ",", "5"}], "}"}]}], 
          "]"}], ",", "None"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"ScientificForm", "[", 
              RowBox[{
               RowBox[{"bathTemps", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}]}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "bathTemps", "]"}], ",", "5"}], "}"}]}], 
          "]"}], ",", "None"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ColorRules", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.5019607843137255, 0.8549019607843137, 0.9215686274509803]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"0", "->", 
        TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"1", "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.9921568627450981, 0.48627450980392156`, 0.43137254901960786`]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"0.5", "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"2", "->", 
        TemplateBox[<|
         "color" -> RGBColor[0.45098039215686275`, 0.4, 0.7411764705882353]|>,
         
         "RGBColorSwatchTemplate"]}]}], 
      RowBox[{"(*", 
       TemplateBox[<|
        "color" -> RGBColor[
          0.6352941176470588, 0.6352941176470588, 0.8156862745098039]|>,
        "RGBColorSwatchTemplate"], "*)"}], "}"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "->", "\[IndentingNewLine]", 
     RowBox[{"SwatchLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TemplateBox[<|
          "color" -> RGBColor[
            0.9921568627450981, 0.48627450980392156`, 0.43137254901960786`]|>,
          
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[
            0.5019607843137255, 0.8549019607843137, 0.9215686274509803]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[0.45098039215686275`, 0.4, 0.7411764705882353]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[
            0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
          "RGBColorSwatchTemplate"]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\"\<Direct sME\>\"", ",", "\"\<Inverse sME\>\"", 
         ",", "\"\<No sME\>\"", ",", "\"\<DsME & IsME\>\"", 
         ",", "\"\<Error\>\""}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"LegendMarkerSize", "->", "15"}], ",", "\[IndentingNewLine]", 
       RowBox[{"LegendLayout", "->", "\"\<Column\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<\[Gamma]\>\"", 
       ",", "\"\<\!\(\*SubscriptBox[\(k\), \(B\)]\)T/m\>\""}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLabel", "->", "\"\<Strong ME Phase Space\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9500466700708303`*^9, 3.950046771600979*^9}, {
  3.950606210277678*^9, 3.9506062547472687`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"c13e62f2-66b5-4831-85cf-78b22c183fee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wmPlots", "[", "WMstates_", "]"}], ":=", 
  RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{"WMstates", ",", "34"}], " ", "]"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"FrameTicks", "->", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"gammas", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "gammas", "]"}], ",", "5"}], "}"}]}], 
          "]"}], ",", "None"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"ScientificForm", "[", 
              RowBox[{
               RowBox[{"bathTemps", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}]}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "bathTemps", "]"}], ",", "5"}], "}"}]}], 
          "]"}], ",", "None"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ColorRules", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.6745098039215687, 0.8980392156862745, 0.9333333333333333]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"0", "->", 
        TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"1", "->", 
        TemplateBox[<|
         "color" -> RGBColor[1., 0.6274509803921569, 0.5372549019607843]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"0.5", "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"2", "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.615686274509804, 0.5058823529411764, 0.7294117647058823]|>,
         "RGBColorSwatchTemplate"]}]}], 
      RowBox[{"(*", 
       TemplateBox[<|
        "color" -> RGBColor[
          0.6352941176470588, 0.6352941176470588, 0.8156862745098039]|>,
        "RGBColorSwatchTemplate"], "*)"}], "}"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "->", "\[IndentingNewLine]", 
     RowBox[{"SwatchLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TemplateBox[<|
          "color" -> RGBColor[1., 0.6274509803921569, 0.5372549019607843]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[
            0.6745098039215687, 0.8980392156862745, 0.9333333333333333]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[
            0.615686274509804, 0.5058823529411764, 0.7294117647058823]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[
            0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
          "RGBColorSwatchTemplate"]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\"\<Direct ME\>\"", ",", "\"\<Inverse ME\>\"", 
         ",", "\"\<No ME\>\"", ",", "\"\<DME & IME\>\"", 
         ",", "\"\<Error\>\""}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"LegendMarkerSize", "->", "15"}], ",", "\[IndentingNewLine]", 
       RowBox[{"LegendLayout", "->", "\"\<Column\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<\[Gamma]\>\"", 
       ",", "\"\<\!\(\*SubscriptBox[\(k\), \(B\)]\)T/m\>\""}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLabel", "->", "\"\<Weak ME Phase Space\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9500467750046377`*^9, 3.950046787802302*^9}, {
  3.9500468182909937`*^9, 3.9500468362132187`*^9}, {3.950054389393147*^9, 
  3.950054389927209*^9}, {3.9506062421809883`*^9, 3.950606250133869*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"bbfd5e5c-4b1a-49ca-a78d-6f68930f8aab"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"MEplots", "[", 
    RowBox[{"MEstates_", ",", 
     RowBox[{"type_", ":", "\"\<Strong\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"colors", ",", "plot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"type", " ", "===", "\"\<Strong\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"colors", "=", 
         RowBox[{"{", 
          RowBox[{
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.9921568627450981, 0.48627450980392156`, 0.43137254901960786`]|>,
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.5019607843137255, 0.8549019607843137, 0.9215686274509803]|>,
            "RGBColorSwatchTemplate"], ",", 
           TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.45098039215686275`, 0.4, 0.7411764705882353]|>,
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
            "RGBColorSwatchTemplate"]}], "}"}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"colors", "=", 
         RowBox[{"{", 
          RowBox[{
           
           TemplateBox[<|
            "color" -> RGBColor[1., 0.6274509803921569, 0.5372549019607843]|>,
            
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.6745098039215687, 0.8980392156862745, 0.9333333333333333]|>,
            "RGBColorSwatchTemplate"], ",", 
           TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.615686274509804, 0.5058823529411764, 0.7294117647058823]|>,
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
            "RGBColorSwatchTemplate"]}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"MEstates", ",", "34"}], " ", 
          RowBox[{"(*", 
           RowBox[{"Length", "@", "gammas"}], "*)"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "->", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"gammas", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "gammas", "]"}], ",", "5"}], "}"}]}],
                "]"}], ",", "None"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"ScientificForm", "[", 
                   RowBox[{
                    RowBox[{"bathTemps", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"Length", "[", "bathTemps", "]"}], ",", "5"}], 
                 "}"}]}], "]"}], ",", "None"}], "}"}]}], 
           "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorRules", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "->", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "->", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"0", "->", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", ",", 
            RowBox[{"0.5", "->", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], ",", 
            RowBox[{"2", "->", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"PlotLegends", "->", "\[IndentingNewLine]", 
          RowBox[{"SwatchLegend", "[", 
           RowBox[{"colors", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             
             RowBox[{"\"\<Direct ME\>\"", ",", "\"\<Inverse ME\>\"", 
              ",", "\"\<No ME\>\"", ",", "\"\<DME & IME\>\"", 
              ",", "\"\<Not Checked it yet\>\""}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LegendMarkerSize", "->", "15"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LegendLayout", "->", "\"\<Column\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           
           RowBox[{"\"\<\[Gamma]\>\"", 
            ",", "\"\<\!\(\*SubscriptBox[\(k\), \(B\)]\)T/m\>\""}], "}"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "->", 
          RowBox[{"type", "<>", "\"\< ME Phase Space\>\""}]}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.950043263161426*^9, 3.950043325981654*^9}, {
   3.950043486951786*^9, 3.950043502730764*^9}, {3.950043609570236*^9, 
   3.950043710572798*^9}, {3.9500437530500193`*^9, 3.950043809019865*^9}, {
   3.950044019647345*^9, 3.9500440712163877`*^9}, {3.9500460545310507`*^9, 
   3.950046093254278*^9}, {3.950046168071248*^9, 3.9500461858565493`*^9}, {
   3.95004625638343*^9, 3.950046283529361*^9}, 3.9500463996433*^9, {
   3.950046503278286*^9, 3.950046511355567*^9}, 3.9500472111382017`*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"0d88eeca-9a79-477d-85be-837b81ac15b4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Graphics Grid", "Subsubsection",
 CellChangeTimes->{{3.948465117285396*^9, 3.9484651218067827`*^9}, {
  3.948465215307488*^9, 
  3.948465221959799*^9}},ExpressionUUID->"6858b706-db17-4b23-b969-\
86666657f48e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generatePlotsGrid", "[", 
   RowBox[{"psi_", ",", "cn_", ",", "polyCoeff_", ",", 
    RowBox[{"name_", ":", "\"\<Second\>\""}], ",", 
    RowBox[{"bound_", ":", "3"}], ",", 
    RowBox[{"type_", ":", "\"\<FP\>\""}], ",", "theta_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "p3", ",", "pc", ",", "pm", ",", "pfpc", ",", "pfp", ",", "label"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"p3", "=", 
       RowBox[{"Plot3D", "[", 
        RowBox[{"psi", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", 
           RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
         RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pc", "=", 
       RowBox[{"ContourPlot", "[", 
        RowBox[{"psi", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", 
           RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
         RowBox[{"GridLines", "->", "Automatic"}], ",", 
         RowBox[{"PlotRange", "->", "All"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
         RowBox[{"Contours", "->", "15"}], ",", 
         RowBox[{"PlotLabel", "->", 
          RowBox[{"name", "<>", "\"\< Eigenfunction\>\""}]}]}], "]"}]}], 
      ";"}], "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"type", "==", "\"\<FP\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pfp", "=", 
         RowBox[{"fokkerPlanck", "[", 
          RowBox[{"psi", ",", "polyCoeff"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"label", "=", "\"\<Apply Kramer's operator\>\""}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pm", "=", 
         RowBox[{"MatrixPlot", "[", 
          RowBox[{"cn", ",", 
           RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
           RowBox[{
           "PlotLabel", "->", "\"\<Right Eigenfunction Coefficients\>\""}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pm", "=", 
         RowBox[{"ContourPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"wst", "[", 
             RowBox[{"theta", ",", "polyCoeff"}], "]"}], " ", "psi"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v", ",", 
             RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
           RowBox[{"GridLines", "->", "Automatic"}], ",", 
           RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
           RowBox[{"Contours", "->", "20"}], ",", 
           RowBox[{"PlotLabel", "->", "\"\<Integrand of a2\>\""}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"pfp", "=", 
         RowBox[{"adjointFokkerPlanck", "[", 
          RowBox[{"psi", ",", "polyCoeff"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"label", "=", "\"\<Apply Adjoint Kramer's operator\>\""}]}]}],
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pfpc", "=", 
      RowBox[{"ContourPlot", "[", 
       RowBox[{"pfp", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", 
          RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
        RowBox[{"GridLines", "->", "Automatic"}], ",", 
        RowBox[{"Contours", "->", "15"}], ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"PlotLabel", "->", "label"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"p3", ",", "pc", ",", "pm", ",", "pfpc"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9484652274199553`*^9, 3.9484652282028313`*^9}, 
   3.948614038627116*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"70801402-dd40-4066-8871-939eea576b03"]
}, Closed]],

Cell[CellGroupData[{

Cell["Get eigenfunction from cn", "Subsubsection",
 CellChangeTimes->{{3.9489194120315866`*^9, 3.9489194199149313`*^9}, {
  3.951654871507781*^9, 
  3.951654871773752*^9}},ExpressionUUID->"055b5b06-41ce-42f3-9ea1-\
b07ca801af20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkpoint2Eig", "[", "checkpoint_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cn", ",", " ", "c", ",", "Coefficients", ",", "polyCoeff", ",", "PhiX", 
      ",", "theta", ",", "alpha", ",", "psi", ",", "Q", ",", "P", ",", 
      "\[IndentingNewLine]", "normalization", ",", " ", "velocityPart", ",", 
      "positionPart", ",", "summationPart"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cn", "=", 
      RowBox[{"checkpoint", "[", 
       RowBox[{"[", "\"\<cn\>\"", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"polyCoeff", "=", 
      RowBox[{"checkpoint", "[", 
       RowBox[{"[", "\"\<Coefficients\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"alpha", "=", 
      RowBox[{"checkpoint", "[", 
       RowBox[{"[", "\"\<alpha\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"theta", "=", 
      RowBox[{"checkpoint", "[", 
       RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", "n_", "]"}], " ", ":=", " ", 
      RowBox[{"cn", "[", 
       RowBox[{"[", 
        RowBox[{"n", " ", "+", " ", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"cn", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{
       RowBox[{"Length", "[", "cn", "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PhiX", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"i", ",", " ", 
          RowBox[{"alpha", "  ", "x"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "0", ",", " ", "Q"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"normalization", " ", "=", " ", 
      RowBox[{"N", "[", 
       RowBox[{"positionPrefactor", "[", 
        RowBox[{"theta", ",", " ", "polyCoeff"}], "]"}], "]"}]}], ";", 
     RowBox[{"velocityPart", " ", "=", " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"alpha", " ", "/", "theta"}], " ", ")"}], 
        RowBox[{"1", "/", "2"}]], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"v", "/", 
          SqrtBox["theta"]}]}], "]"}]}]}], ";", 
     RowBox[{"positionPart", " ", "=", " ", 
      RowBox[{
       SqrtBox["normalization"], " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Potential", "[", 
            RowBox[{"x", ",", " ", "polyCoeff"}], "]"}]}], "/", "2"}], "/", 
         "theta"}], "]"}]}]}], ";", 
     RowBox[{"summationPart", " ", "=", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "n", "]"}], " ", ".", " ", "PhiX"}], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"n", ",", " ", 
           RowBox[{"v", "/", 
            SqrtBox["theta"]}]}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "0", ",", " ", "P"}], "}"}]}], "]"}]}], ";", 
     "\n", "  ", 
     RowBox[{"psi", " ", "=", " ", 
      RowBox[{
      "positionPart", " ", "*", " ", "velocityPart", " ", "*", " ", 
       "summationPart"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.948919424269731*^9, 3.948919638948173*^9}, {
  3.948919691499483*^9, 3.94891971110326*^9}, {3.948919834800766*^9, 
  3.948919859891904*^9}, {3.948926213221202*^9, 3.9489262161627007`*^9}, {
  3.949068842573731*^9, 3.949068894066224*^9}, {3.9490689602551107`*^9, 
  3.949068964395159*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"f0216daa-c746-49fd-bb46-9f67f4bfcc44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkpoint2LeftEig", "[", 
   RowBox[{"checkpoint_", ",", 
    RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "EigenfunctionR", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EigenfunctionR", "=", 
      RowBox[{"checkpoint2Eig", "[", "checkpoint", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"leftEigenfunction", "[", 
      RowBox[{"EigenfunctionR", ",", " ", "johnsCoeff", ",", " ", 
       RowBox[{"checkpoint", "[", 
        RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9516548810742693`*^9, 3.951654951780521*^9}, {
  3.951655016329235*^9, 3.951655043177388*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"0088a4a6-b716-43c4-ad99-d5900b60b03f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimize Alpha", "Subsection",
 CellChangeTimes->{{3.948728267058735*^9, 3.948728271083993*^9}, {
  3.948729832631344*^9, 
  3.94872983329918*^9}},ExpressionUUID->"c18f6b7c-ccd7-4988-ba16-\
056a9c05ecd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"optimizeAlpha", "[", 
   RowBox[{"setup_", ",", 
    RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"alpha", ",", "alphas", ",", "det", ",", "fdet"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"fdet", "[", "alpha_", "]"}], " ", ":=", " ", 
      RowBox[{"determinant", "[", 
       RowBox[{"1", ",", " ", 
        RowBox[{"setup", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"setup", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
        RowBox[{"setup", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", "alpha", ",", " ", "johnsCoeff",
         ",", " ", 
        RowBox[{"setup", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"alphas", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0.4", ",", "6", ",", "0.15"}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "6.4", ",", "16", ",", "0.4"}], "}"}]}], "]"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"det", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"alpha", ",", " ", 
          RowBox[{"Log", "@", 
           RowBox[{"Abs", "@", 
            RowBox[{"fdet", "[", "alpha", "]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"{", 
         RowBox[{"alpha", ",", "alphas"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"alpha", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"det", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", 
           RowBox[{"Min", "[", 
            RowBox[{"det", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], "&"}]}], "]"}],
        "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.94872827409846*^9, 3.948728330325158*^9}, {
   3.948728363575491*^9, 3.948728722106009*^9}, {3.948729663214388*^9, 
   3.948729703592767*^9}, {3.948730100758259*^9, 3.9487301256543827`*^9}, {
   3.9487302376020527`*^9, 3.948730240149774*^9}, {3.948730282481385*^9, 
   3.9487303036300097`*^9}, {3.948894111460731*^9, 3.948894209111261*^9}, {
   3.94889434363207*^9, 3.948894344253717*^9}, {3.948895087722924*^9, 
   3.948895088679811*^9}, {3.948895187183976*^9, 3.94889518941508*^9}, 
   3.95148244078365*^9, 3.951501524802951*^9, 3.951520874473894*^9, 
   3.9515212753202143`*^9, {3.95235595951295*^9, 3.952355959831729*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"720a1c30-c974-417f-8acb-07716b32a410"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"optimizeAlpha", "[", 
    RowBox[{"setup_", ",", "johnsCoeff_", ",", 
     RowBox[{"workingPrecision_", ":", "30"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"alpha", ",", "alphas", ",", "det", ",", "fdet"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"setup", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
          "setup"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"johnsCoeff", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
          "johnsCoeff"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fdet", "[", "alpha_", "]"}], ":=", 
       RowBox[{"determinant", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SetPrecision", "[", 
          RowBox[{"1", ",", "workingPrecision"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"setup", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"setup", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"setup", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", "\[IndentingNewLine]", "alpha",
          ",", "\[IndentingNewLine]", "johnsCoeff", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"setup", "[", 
          RowBox[{"[", "5", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         "workingPrecision"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"alphas", "=", 
       RowBox[{"SetPrecision", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0.4", ",", "6", ",", "0.15"}], "}"}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "6.4", ",", "16", ",", "0.4"}], "}"}]}], 
            "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]",
          "workingPrecision"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"det", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"alpha", ",", 
           RowBox[{"Log", "@", 
            RowBox[{"Abs", "@", 
             RowBox[{"fdet", "[", "alpha", "]"}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"alpha", ",", "alphas"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"alpha", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"det", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "==", 
            RowBox[{"Min", "[", 
             RowBox[{"det", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.951482442486533*^9, 3.951482442490419*^9}, {
   3.951489684378934*^9, 3.95148976120271*^9}, {3.951501449763913*^9, 
   3.951501473743094*^9}, 3.951501528086508*^9, 3.9515208686479692`*^9, 
   3.951521278799905*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"df1f743c-67d1-48b2-9b73-d8f5e180957b"]
}, Closed]],

Cell[CellGroupData[{

Cell["K Matrix", "Subsection",
 CellChangeTimes->{{3.948464892050411*^9, 
  3.948464895845833*^9}},ExpressionUUID->"72da9c91-0a17-485c-994d-\
d9bb38e9fccb"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"matrixContinuedFraction", "[", 
     RowBox[{
     "s_", ",", " ", "gamma_", ",", " ", "Q_", ",", " ", "NN_", ",", " ", 
      "Dpq_", ",", " ", "Dbar_"}], "]"}], " ", ":=", "\n", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "K", "}"}], ",", "\n", "   ", 
      RowBox[{
       RowBox[{"K", " ", "=", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"Q", " ", "+", " ", "1"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"s", " ", "+", " ", 
            RowBox[{"gamma", "*", 
             RowBox[{"(", 
              RowBox[{"NN", " ", "+", " ", "1"}], ")"}]}]}], ")"}]}], "]"}]}],
        ";", "\n", "   ", 
       RowBox[{"For", "[", "\n", "    ", 
        RowBox[{
         RowBox[{"n", " ", "=", " ", "NN"}], ",", " ", 
         RowBox[{"n", " ", ">", " ", "0"}], ",", " ", 
         RowBox[{"n", "--"}], ",", "\n", "    ", 
         RowBox[{
          RowBox[{"K", " ", "=", " ", 
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"s", " ", "+", " ", 
                RowBox[{"gamma", "*", "n"}]}], ")"}], "*", 
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"Q", " ", "+", " ", "1"}], "]"}]}], " ", "-", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", " ", "+", " ", "1"}], ")"}], "*", 
              RowBox[{"Dpq", " ", ".", " ", "K", " ", ".", " ", "Dbar"}]}]}], 
            "]"}]}], ";"}]}], "\n", "    ", "]"}], ";", "\n", "   ", 
       RowBox[{"Dpq", " ", ".", " ", "K", " ", ".", " ", "Dbar"}]}]}], "\n", 
     "   ", "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"matrixContinuedFraction", "[", 
      RowBox[{
      "s_", ",", "gamma_", ",", "Q_", ",", "NN_", ",", "Dpq_", ",", "Dbar_"}],
       "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"K", ",", "n", ",", "workingPrecision"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"workingPrecision", "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Precision", "[", "s", "]"}], ",", 
           RowBox[{"Precision", "[", "gamma", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"K", "=", 
         RowBox[{"Inverse", "[", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"Q", "+", "1"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"s", "+", 
               RowBox[{"gamma", "*", 
                RowBox[{"(", 
                 RowBox[{"NN", "+", "1"}], ")"}]}]}], ")"}]}], ",", 
            "workingPrecision"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"n", "=", "NN"}], ",", 
          RowBox[{"n", ">", "0"}], ",", 
          RowBox[{"n", "--"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"K", "=", 
            RowBox[{"Inverse", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"SetPrecision", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"s", "+", 
                   RowBox[{"gamma", "*", "n"}]}], ")"}], "*", 
                 RowBox[{"IdentityMatrix", "[", 
                  RowBox[{"Q", "+", "1"}], "]"}]}], ",", "workingPrecision"}],
                "]"}], "-", 
              RowBox[{
               RowBox[{"SetPrecision", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "+", "1"}], ")"}], ",", "workingPrecision"}], 
                "]"}], "*", 
               RowBox[{"Dpq", ".", "K", ".", "Dbar"}]}]}], 
             "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Dpq", ".", "K", ".", "Dbar"}]}]}], "]"}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.951482027020854*^9, 3.951482032524067*^9}, {
  3.951500411142706*^9, 3.95150041998298*^9}, {3.9515008076140747`*^9, 
  3.951500810557044*^9}, {3.9515208557273197`*^9, 3.951520863667984*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"1acbc846-6247-409e-bf27-435cfc4065dd"]
}, Closed]],

Cell[CellGroupData[{

Cell["D Matrices", "Subsection",
 CellChangeTimes->{{3.9484649140476427`*^9, 
  3.948464917062848*^9}},ExpressionUUID->"a531008a-1fe4-4fff-adaf-\
bc5d705e3c83"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", " ", "Load"}]}]}]}]}]}]}]}]}]}], " ", "D"}], " ",
      "&"}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              OverscriptBox["D", "^"], " ", "--"}], "--"}], "--"}], "--"}], 
          "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "workingDirectory", 
     "=", "\"\</Users/gene/Desktop/CourseWork/Reasearch/notebooks/\>\""}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"workingDirectory", "=", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"workingDirectory", " ", "<>", " ", "\"\<Max200Ds\>\""}], "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "resizeDMatrices", "]"}], "=", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<alpha \>\"", " ", "->", " ", "\[Alpha]"}], ",", "\n", 
       "    ", 
       RowBox[{"\"\<d1 \>\"", " ", "->", " ", "d1"}], ",", "\n", "    ", 
       RowBox[{"\"\<d2 \>\"", " ", "->", " ", "d2"}], ",", "\n", "    ", 
       RowBox[{"\"\<d3 \>\"", " ", "->", " ", "d3"}], ",", "\n", "    ", 
       RowBox[{"\"\<d4 \>\"", " ", "->", " ", "d4"}], ",", "\n", "    ", 
       RowBox[{"\"\<theta \>\"", " ", "->", " ", "\[Theta]"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", " ", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}], "*)"}], "\n", "\n", " ", 
   RowBox[{
    RowBox[{"resizeDMatrices", "[", 
     RowBox[{"Q_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\n", "   ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"matrixD", ",", " ", "matrixDhat"}], "}"}], ",", "\n", "   ", 
      "\n", "   ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"!", " ", 
           RowBox[{"NumericQ", "[", "Q", "]"}]}], " ", "||", " ", 
          RowBox[{"!", " ", 
           RowBox[{"IntegerQ", "[", "Q", "]"}]}], " ", "||", " ", 
          RowBox[{"Q", " ", "<", " ", "0"}]}], ",", "\n", "    ", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InvalidArgument", "::", "NotPositiveInteger"}], ",", " ",
             "Q"}], "]"}], ";", "\n", "    ", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\n", "    ", "]"}], ";",
        "\n", "   ", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Q", " ", ">", " ", "maxDegree"}], ",", "\n", "    ", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InvalidArgument", "::", "ExceedMaxDegree"}], ",", " ", 
            "Q", ",", " ", "maxDegree"}], "]"}], ";", "\n", "    ", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\n", "    ", "]"}], ";",
        "\n", " ", "\n", "   ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Create", " ", "substitution", " ", "rules", "\n", "   ", "by", " ", 
         "Accessing", " ", "options", " ", "using", " ", "OptionValue"}], " ",
         "*)"}], "\n", "   ", 
       RowBox[{"substitutionRules", " ", "=", " ", 
        RowBox[{"{", "\n", "     ", 
         RowBox[{
          RowBox[{"\[Alpha]", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<alpha \>\"", "]"}]}], ",", "\n", 
          "     ", 
          RowBox[{"d1", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<d1 \>\"", "]"}]}], ",", "\n", 
          "     ", 
          RowBox[{"d2", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<d2 \>\"", "]"}]}], ",", "\n", 
          "     ", 
          RowBox[{"d3", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<d3 \>\"", "]"}]}], ",", "\n", 
          "     ", 
          RowBox[{"d4", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<d4 \>\"", "]"}]}], ",", "\n", 
          "     ", 
          RowBox[{"\[Theta]", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<theta \>\"", "]"}]}]}], "\n", 
         "     ", "}"}]}], ";", "\n", "   ", "\n", "   ", 
       RowBox[{"(*", 
        RowBox[{
        "Resize", " ", "and", " ", "substitute", " ", "values", " ", "in", " ",
          "matrices"}], "*)"}], "\n", "   ", 
       RowBox[{"matrixD", " ", "=", " ", 
        RowBox[{
         RowBox[{"maxDMatrix", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", " ", ";;", " ", 
             RowBox[{"Q", " ", "+", " ", "1"}]}], ",", " ", 
            RowBox[{"1", " ", ";;", " ", 
             RowBox[{"Q", " ", "+", " ", "1"}]}]}], "]"}], "]"}], " ", "/.", 
         " ", "substitutionRules"}]}], ";", "\n", "   ", 
       RowBox[{"matrixDhat", " ", "=", " ", 
        RowBox[{
         RowBox[{"maxDHatMatrix", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", " ", ";;", " ", 
             RowBox[{"Q", " ", "+", " ", "1"}]}], ",", " ", 
            RowBox[{"1", " ", ";;", " ", 
             RowBox[{"Q", " ", "+", " ", "1"}]}]}], "]"}], "]"}], " ", "/.", 
         " ", "substitutionRules"}]}], ";", "\n", "   ", "\n", "   ", 
       RowBox[{"(*", 
        RowBox[{"Return", " ", "both", " ", "matrices"}], "*)"}], "\n", "   ", 
       RowBox[{"{", 
        RowBox[{"matrixD", ",", " ", "matrixDhat"}], "}"}]}]}], "\n", "   ", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.948464939285862*^9, 3.948464967721498*^9}, {
   3.948469325626954*^9, 3.948469366662715*^9}, {3.948469461927013*^9, 
   3.948469514120126*^9}, 3.948554648468587*^9, {3.949258530835745*^9, 
   3.9492585484241133`*^9}, {3.951482090294355*^9, 3.9514821281589403`*^9}, {
   3.9514824098952217`*^9, 3.951482426863723*^9}, 3.951520851455957*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"082266ed-2d80-4a26-bf2b-4c6eda139d45"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"resizeDMatrices", "[", 
    RowBox[{"Q_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "matrixD", ",", "matrixDhat", ",", "substitutionRules", ",", "alpha", ",",
        "d1", ",", "d2", ",", "d3", ",", "d4", ",", "theta", ",", 
       "workingPrecision"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"NumericQ", "[", "Q", "]"}]}], "||", 
         RowBox[{"!", 
          RowBox[{"IntegerQ", "[", "Q", "]"}]}], "||", 
         RowBox[{"Q", "<", "0"}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"InvalidArgument", "::", "NotPositiveInteger"}], ",", 
           "Q"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Q", ">", "maxDegree"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"InvalidArgument", "::", "ExceedMaxDegree"}], ",", "Q", ",",
            "maxDegree"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Get", " ", "option", " ", "values"}], "*)"}], 
      RowBox[{"alpha", "=", 
       RowBox[{"OptionValue", "[", "\"\<alpha \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d1", "=", 
       RowBox[{"OptionValue", "[", "\"\<d1 \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d2", "=", 
       RowBox[{"OptionValue", "[", "\"\<d2 \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d3", "=", 
       RowBox[{"OptionValue", "[", "\"\<d3 \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d4", "=", 
       RowBox[{"OptionValue", "[", "\"\<d4 \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"OptionValue", "[", "\"\<theta \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Determine", " ", "working", " ", "precision", " ", "from", " ", "the",
         " ", "inputs"}], "*)"}], 
      RowBox[{"workingPrecision", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "alpha", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "alpha", "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "d1", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "d1", "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "d2", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "d2", "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "d3", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "d3", "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "d4", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "d4", "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "theta", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "theta", "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Create", " ", "substitution", " ", "rules"}], "*)"}], 
      RowBox[{"substitutionRules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Alpha]", "->", "alpha"}], ",", 
         RowBox[{"d1", "->", "d1"}], ",", 
         RowBox[{"d2", "->", "d2"}], ",", 
         RowBox[{"d3", "->", "d3"}], ",", 
         RowBox[{"d4", "->", "d4"}], ",", 
         RowBox[{"\[Theta]", "->", "theta"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Resize", " ", "and", " ", "substitute", " ", "values", " ", "in", " ",
         "matrices"}], "*)"}], 
      RowBox[{"matrixD", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"maxDMatrix", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", 
              RowBox[{"Q", "+", "1"}]}], ",", 
             RowBox[{"1", ";;", 
              RowBox[{"Q", "+", "1"}]}]}], "]"}], "]"}], "/.", " ", 
          "substitutionRules"}], ",", "workingPrecision"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"matrixDhat", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"maxDHatMatrix", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", 
              RowBox[{"Q", "+", "1"}]}], ",", 
             RowBox[{"1", ";;", 
              RowBox[{"Q", "+", "1"}]}]}], "]"}], "]"}], "/.", " ", 
          "substitutionRules"}], ",", "workingPrecision"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Return", " ", "both", " ", "matrices"}], "*)"}], 
      RowBox[{"{", 
       RowBox[{"matrixD", ",", "matrixDhat"}], "}"}]}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.951482420196885*^9, 3.951482420200247*^9}, 
   3.951520849530116*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"d1c20dd7-c6a5-4122-95bd-2617eb62e504"],

Cell[CellGroupData[{

Cell["Original Double Well Matrices", "Subsubsection",
 CellChangeTimes->{{3.9484651698505793`*^9, 
  3.948465177062578*^9}},ExpressionUUID->"9076a0aa-c5a3-4e57-8fff-\
d5f0cdce68a4"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"calcMatrixElements", "[", 
    RowBox[{
    "Q_", ",", " ", "alpha_", ",", " ", "d2_", ",", " ", "d4_", ",", " ", 
     RowBox[{"theta_", " ", ":", " ", "0.25"}]}], "]"}], " ", ":=", "\n", 
   "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Dpq", ",", " ", "Dbar", ",", " ", "sign", ",", " ", "qval", ",", " ", 
       "factor", ",", " ", "p", ",", " ", "q"}], "}"}], ",", "\n", "   ", 
     RowBox[{
      RowBox[{"Dpq", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Q", " ", "+", " ", "1"}], ",", " ", 
           RowBox[{"Q", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "   ", 
      RowBox[{"Dbar", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Q", " ", "+", " ", "1"}], ",", " ", 
           RowBox[{"Q", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "   ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"p", " ", "=", " ", "0"}], ",", " ", 
        RowBox[{"p", " ", "<=", " ", "Q"}], ",", " ", 
        RowBox[{"p", "++"}], ",", "\n", "    ", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"q", " ", "=", " ", "0"}], ",", " ", 
           RowBox[{"q", " ", "<=", " ", "Q"}], ",", " ", 
           RowBox[{"q", "++"}], ",", "\n", "      ", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"p", " ", "-", " ", "q"}], "]"}], " ", "==", " ", 
               "1"}], ",", "\n", "       ", 
              RowBox[{
               RowBox[{"sign", " ", "=", " ", 
                RowBox[{"Sign", "[", 
                 RowBox[{"q", " ", "-", " ", "p"}], "]"}]}], ";", "\n", 
               "       ", 
               RowBox[{"qval", " ", "=", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{"p", ",", " ", "q"}], "]"}]}], ";", "\n", "       ", 
               
               RowBox[{
                RowBox[{"Dpq", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"p", " ", "+", " ", "1"}], ",", " ", 
                   RowBox[{"q", " ", "+", " ", "1"}]}], "]"}], "]"}], "  ", "=",
                 " ", 
                RowBox[{
                 RowBox[{"Sqrt", "[", "qval", "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"sign", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "/", "2"}]}], " ", "-", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"3", "*", "d4", "*", "qval"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "^", "3"}]}], ")"}]}], " ", "-", " ", 
                   RowBox[{"d2", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", "alpha"}], ")"}]}]}], ")"}]}]}], ";",
                "\n", "       ", 
               RowBox[{
                RowBox[{"Dbar", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"p", " ", "+", " ", "1"}], ",", " ", 
                   RowBox[{"q", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "=",
                 " ", 
                RowBox[{
                 RowBox[{"Sqrt", "[", "qval", "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"sign", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "/", "2"}]}], " ", "+", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"3", "*", "d4", "*", "qval"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "^", "3"}]}], ")"}]}], " ", "+", " ", 
                   RowBox[{"d2", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", "alpha"}], ")"}]}]}], ")"}]}]}], 
               ";"}]}], "\n", "       ", "]"}], ";", "\n", "      ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"p", " ", "-", " ", "q"}], "]"}], " ", "==", " ", 
               "3"}], ",", "\n", "       ", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"p", " ", ">", " ", "q"}], ",", "\n", "        ", 
                 RowBox[{"factor", " ", "=", " ", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"p", "*", 
                    RowBox[{"(", 
                    RowBox[{"p", " ", "-", " ", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", " ", "-", " ", "2"}], ")"}]}], "]"}], "*", 
                   RowBox[{"d4", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "^", "3"}]}], ")"}]}]}]}], ",", "\n", 
                 "        ", 
                 RowBox[{"factor", " ", "=", " ", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"q", "*", 
                    RowBox[{"(", 
                    RowBox[{"q", " ", "-", " ", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"q", " ", "-", " ", "2"}], ")"}]}], "]"}], "*", 
                   RowBox[{"d4", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "^", "3"}]}], ")"}]}]}]}]}], "]"}], ";", 
               "\n", "       ", 
               RowBox[{
                RowBox[{"Dpq", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"p", " ", "+", " ", "1"}], ",", " ", 
                   RowBox[{"q", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "=",
                 " ", 
                RowBox[{"-", "factor"}]}], ";", "\n", "       ", 
               RowBox[{
                RowBox[{"Dbar", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"p", " ", "+", " ", "1"}], ",", " ", 
                   RowBox[{"q", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "=",
                 " ", "factor"}], ";"}]}], "]"}], ";"}]}], "]"}], ";"}]}], 
       "]"}], ";", "\n", "   ", 
      RowBox[{"{", 
       RowBox[{"Dpq", ",", " ", "Dbar"}], "}"}]}]}], "]"}]}]}]], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"599e526c-26cd-468a-9c16-4b3cb286875a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Determinant", "Subsection",
 CellChangeTimes->{{3.948464775120963*^9, 3.948464921200511*^9}, 
   3.948464970690818*^9, {3.9484650042323008`*^9, 
   3.948465043254431*^9}},ExpressionUUID->"60f16c4a-cdc8-45f7-bd3d-\
dce4652bcfa4"],

Cell[BoxData[
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"determinant", "[", 
    RowBox[{
    "lambda_", ",", " ", "gamma_", ",", " ", "Q_", ",", " ", "N_", ",", " ", 
     "alpha_", ",", "\n", "   ", "polyCoeff_", ",", " ", 
     RowBox[{"theta_", " ", ":", " ", "0.25"}]}], "]"}], " ", ":=", "\n", 
   "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Dpq", ",", " ", "Dbar", ",", " ", "K0", ",", " ", "s", ",", " ", "d1", 
       ",", " ", "d2", ",", " ", "d3", ",", " ", "d4"}], "}"}], ",", "\n", 
     "   ", 
     RowBox[{"(*", 
      RowBox[{"SetPrecision", "["}], "*)"}], "\n", "   ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d1", ",", " ", "d2", ",", " ", "d3", ",", " ", "d4"}], "}"}],
        " ", "=", " ", "polyCoeff"}], ";", "\n", "   ", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"-", "lambda"}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dpq", ",", " ", "Dbar"}], "}"}], " ", "=", "\n", "    ", 
       RowBox[{"resizeDMatrices", "[", 
        RowBox[{"Q", ",", "\n", "     ", 
         RowBox[{"\"\<alpha \>\"", " ", "->", " ", "alpha"}], ",", "\n", 
         "     ", 
         RowBox[{"\"\<d1 \>\"", " ", "->", " ", "d1"}], ",", "\n", "     ", 
         RowBox[{"\"\<d2 \>\"", " ", "->", " ", "d2"}], ",", "\n", "     ", 
         RowBox[{"\"\<d3 \>\"", " ", "->", " ", "d3"}], ",", "\n", "     ", 
         RowBox[{"\"\<d4 \>\"", " ", "->", " ", "d4"}], ",", "\n", "     ", 
         RowBox[{"\"\<theta \>\"", " ", "->", " ", "theta"}]}], "\n", "     ",
         "]"}]}], ";", "\n", "   ", 
      RowBox[{"K0", " ", "=", " ", 
       RowBox[{"matrixContinuedFraction", "[", 
        RowBox[{
        "s", ",", " ", "gamma", ",", " ", "Q", ",", " ", "N", ",", " ", "Dpq",
          ",", " ", "Dbar"}], "]"}]}], ";", "\n", "   ", 
      RowBox[{"Det", "[", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"lambda", "*", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Q", " ", "+", " ", "1"}], "]"}]}], " ", "+", " ", "K0"}],
          ",", " ", "30"}], "]"}], "]"}]}]}], "\n", "   ", "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.9484650703144073`*^9, 3.948465070748124*^9}, 
   3.9514813993457212`*^9, 3.951520832578903*^9, {3.952523236567267*^9, 
   3.952523237043167*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"c8379d4f-5c71-42bf-b5ad-48f7182ad0b4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"determinant", "[", 
    RowBox[{
    "lambda_", ",", "gamma_", ",", "Q_", ",", "N_", ",", "alpha_", ",", 
     "polyCoeff_", ",", "theta_", ",", 
     RowBox[{"workingPrecision_", ":", "30"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Dpq", ",", "Dbar", ",", "K0", ",", "s", ",", "d1", ",", "d2", ",", 
       "d3", ",", "d4"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d1", ",", "d2", ",", "d3", ",", "d4"}], "}"}], "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
         "polyCoeff"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"-", "lambda"}], ",", "workingPrecision"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dpq", ",", "Dbar"}], "}"}], "=", 
       RowBox[{"resizeDMatrices", "[", "\[IndentingNewLine]", 
        RowBox[{"Q", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<alpha \>\"", "->", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{"alpha", ",", "workingPrecision"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<d1 \>\"", "->", "d1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<d2 \>\"", "->", "d2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<d3 \>\"", "->", "d3"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<d4 \>\"", "->", "d4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<theta \>\"", "->", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{"theta", ",", "workingPrecision"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"K0", "=", 
         RowBox[{"matrixContinuedFraction", "[", 
          RowBox[{"s", ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{"gamma", ",", "workingPrecision"}], "]"}], ",", "Q", ",", 
           "N", ",", "Dpq", ",", "Dbar"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"K0", "=", 
       RowBox[{"matrixContinuedFraction", "[", 
        RowBox[{
        "s", ",", "gamma", ",", "Q", ",", "N", ",", "Dpq", ",", "Dbar"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Det", "[", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lambda", "*", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"Q", "+", "1"}], "]"}]}], "+", "K0"}], ",", 
          "workingPrecision"}], "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Det", "[", 
       RowBox[{
        RowBox[{"lambda", "*", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Q", "+", "1"}], "]"}]}], "+", "K0"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.951481396105362*^9, 3.951481402682572*^9}, {
   3.951490018333055*^9, 3.951490062733079*^9}, {3.951500834340151*^9, 
   3.951500839783347*^9}, {3.9515012603511257`*^9, 3.951501267771514*^9}, {
   3.951501577670847*^9, 3.9515015782645187`*^9}, 3.951520836397344*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"f17955f2-34e6-4968-a092-703f98899044"]
}, Closed]],

Cell[CellGroupData[{

Cell["Get Root", "Subsection",
 CellChangeTimes->{{3.948465325492427*^9, 
  3.948465328236207*^9}},ExpressionUUID->"23e736b2-e322-4f7b-8611-\
2594bea1c9e1"],

Cell[CellGroupData[{

Cell["Packaged version", "Subsubsection",
 CellChangeTimes->{{3.9484654997494287`*^9, 
  3.94846550382178*^9}},ExpressionUUID->"49a67774-febb-408a-96e2-\
fc9d9e68e36f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getRoot", "[", 
   RowBox[{"setup_", ",", 
    RowBox[{"polyCoeff_", ":", "johnsCoeff"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\n", "  ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "plot", ",", " ", "fdet", ",", " ", "roots", ",", " ", "dets", ",", " ", 
      "segmentRoots", ",", " ", "tempDisplay", ",", "\n", "   ", 
      "refinedRoot", ",", " ", "alpha", ",", " ", "Q", ",", " ", "P", ",", 
      " ", "NN", ",", " ", "theta", ",", " ", "gamma", ",", " ", "iterLs", ",",
       "threshold"}], "}"}], ",", "\n", "  ", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "alpha", ",", " ", "Q", ",", " ", "P", ",", " ", "NN", ",", " ", 
        "theta", ",", " ", "gamma"}], "}"}], " ", "=", " ", "setup"}], ";", 
     "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"iterLs", " ", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.02"}], ",", "0.6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.4", ",", "1.6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.3", ",", "5.1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4.9", ",", "8"}], "}"}]}], "}"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\n", 
     RowBox[{
      RowBox[{"fdet", "[", "lambda_", "]"}], " ", ":=", " ", 
      RowBox[{"determinant", "[", 
       RowBox[{
       "lambda", ",", " ", "gamma", ",", " ", "Q", ",", " ", "NN", ",", " ", 
        "alpha", ",", " ", "polyCoeff", ",", " ", "theta"}], "]"}]}], ";", 
     "\n", 
     RowBox[{"roots", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"dets", " ", "=", " ", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lambda", ",", " ", 
            RowBox[{"Log", "@", 
             RowBox[{"Abs", "@", 
              RowBox[{"fdet", "[", "lambda", "]"}]}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"{", 
           RowBox[{"lambda", ",", "0", ",", "4", ",", 
            RowBox[{"4", "/", "1000"}]}], "}"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dets", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lambda", "^", "2"}], ",", " ", 
          RowBox[{"Log", "@", 
           RowBox[{"Abs", "@", 
            RowBox[{"fdet", "[", 
             RowBox[{"lambda", "^", "2"}], "]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"lambda", ",", "0", ",", 
          SqrtBox["10"], ",", "0.005"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"threshold", "=", "1.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"segmentRoots", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"FindLocalMinima", "[", 
        RowBox[{"dets", ",", " ", "threshold"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"segmentRoots", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"segmentRoots", "=", 
        RowBox[{"segmentRoots", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"$Failed", ",", "$Failed"}], " ", "}"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"segmentRoots", ",", " ", "dets"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.950735328013377*^9, 3.950735364826256*^9}, {
   3.9507353975228367`*^9, 3.9507354090979443`*^9}, 3.950738279410178*^9, 
   3.9507385322284184`*^9, {3.950743249993648*^9, 3.9507432633521833`*^9}, {
   3.950743668014216*^9, 3.950743668909659*^9}, {3.950743813135787*^9, 
   3.950743851294572*^9}, 3.950776100994917*^9, 3.9514823317753267`*^9, 
   3.951482380688552*^9, {3.951502132081808*^9, 3.951502139696727*^9}, {
   3.951502253049902*^9, 3.9515022691719513`*^9}, {3.951502707788663*^9, 
   3.951502726577177*^9}, {3.951502826184486*^9, 3.9515028309110203`*^9}, 
   3.951503038680943*^9, {3.951503193521196*^9, 3.95150323651563*^9}, {
   3.9515050309513807`*^9, 3.951505115835867*^9}, {3.9515070535572033`*^9, 
   3.951507062096974*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"f31f9bba-9986-44f5-8b09-06f0b54bb7c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Increased", " ", "Precision"}], ",", " ", 
    RowBox[{
    "but", " ", "I", " ", "decide", " ", "not", " ", "to", " ", "use", " ", 
     "it", " ", "for", " ", "now"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"getRoot", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"polyCoeff_", ":", "johnsCoeff"}], ",", 
      RowBox[{"workingPrecision_", ":", "30"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "plot", ",", "fdet", ",", "roots", ",", "dets", ",", "segmentRoots", ",",
         "tempDisplay", ",", "refinedRoot", ",", "alpha", ",", "Q", ",", "P", 
        ",", "NN", ",", "theta", ",", "gamma", ",", "iterLs", ",", 
        "threshold"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "alpha", ",", "Q", ",", "P", ",", "NN", ",", "theta", ",", "gamma"}],
          "}"}], "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
          "setup"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"polyCoeff", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
          "polyCoeff"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"iterLs", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.02"}], ",", "0.6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.4", ",", "1.6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1.3", ",", "5.1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4.9", ",", "8"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fdet", "[", "lambda_", "]"}], ":=", 
        RowBox[{"determinant", "[", 
         RowBox[{
         "lambda", ",", "gamma", ",", "Q", ",", "NN", ",", "alpha", ",", 
          "polyCoeff", ",", "theta", ",", "workingPrecision"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"roots", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dets", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SetPrecision", "[", 
             RowBox[{"lambda", ",", "workingPrecision"}], "]"}], ",", 
            RowBox[{"Log", "@", 
             RowBox[{"Abs", "@", 
              RowBox[{"fdet", "[", 
               RowBox[{"SetPrecision", "[", 
                RowBox[{"lambda", ",", "workingPrecision"}], "]"}], 
               "]"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"lambda", ",", "0", ",", "4", ",", 
            RowBox[{"4", "/", "1000"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"threshold", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"1.01", ",", "workingPrecision"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"segmentRoots", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"FindLocalMinima", "[", 
           RowBox[{"dets", ",", "threshold"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"segmentRoots", ",", "dets"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.951482334810377*^9, 3.951482374742915*^9}, {
  3.951502283577044*^9, 3.951502293711239*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"ece2424c-45c0-4187-9654-42738487339f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"getRoot", "[", 
    RowBox[{"setup_", ",", 
     RowBox[{"polyCoeff_", ":", "johnsCoeff"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\n", "  ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "plot", ",", " ", "fdet", ",", " ", "roots", ",", " ", "dets", ",", " ",
        "segmentRoots", ",", " ", "tempDisplay", ",", "\n", "   ", 
       "refinedRoot", ",", " ", "alpha", ",", " ", "Q", ",", " ", "P", ",", 
       " ", "NN", ",", " ", "theta", ",", " ", "gamma", ",", " ", "iterLs", ",",
        "threshold"}], "}"}], ",", "\n", "  ", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "alpha", ",", " ", "Q", ",", " ", "P", ",", " ", "NN", ",", " ", 
         "theta", ",", " ", "gamma"}], "}"}], " ", "=", " ", "setup"}], ";", 
      "\n", 
      RowBox[{"iterLs", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.02"}], ",", "0.6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.4", ",", "1.6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.3", ",", "5.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4.9", ",", "8"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{
       RowBox[{"fdet", "[", "lambda_", "]"}], " ", ":=", " ", 
       RowBox[{"determinant", "[", 
        RowBox[{
        "lambda", ",", " ", "gamma", ",", " ", "Q", ",", " ", "NN", ",", " ", 
         "alpha", ",", " ", "polyCoeff", ",", " ", "theta"}], "]"}]}], ";", 
      "\n", 
      RowBox[{"roots", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"dets", " ", "=", " ", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lambda", ",", " ", 
              RowBox[{"Log", "@", 
               RowBox[{"Abs", "@", 
                RowBox[{"fdet", "[", "lambda", "]"}]}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", " ", 
            RowBox[{"{", 
             RowBox[{"lambda", ",", " ", 
              RowBox[{"iterL", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{"iterL", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"iterL", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", " ", 
                 RowBox[{"iterL", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "130"}]}], 
             "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"threshold", "=", "1.1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"segmentRoots", " ", "=", " ", 
            RowBox[{"FindLocalMinima", "[", 
             RowBox[{"dets", ",", " ", "threshold"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "segmentRoots"}], ">", "5"}], ",", 
             RowBox[{"threshold", "=", "2"}], ",", "\[IndentingNewLine]", 
             RowBox[{"segmentRoots", "===", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"threshold", "=", "1.1"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"segmentRoots", " ", "=", " ", 
          RowBox[{"FindLocalMinima", "[", 
           RowBox[{"dets", ",", " ", "threshold"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"segmentRoots", " ", "=!=", " ", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"segmentRoots", " ", "=", " ", 
             RowBox[{"segmentRoots", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"tempDisplay", " ", "=", " ", 
             RowBox[{"PrintTemporary", "[", 
              RowBox[{"\"\<Roots are: \>\"", ",", "segmentRoots"}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"roots", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"roots", " ", ",", " ", "segmentRoots"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"refinedRoot", " ", "=", " ", 
                RowBox[{"FindRootBisection", "[", 
                 RowBox[{"fdet", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"root", " ", "-", " ", "0.015"}], ",", " ", 
                    RowBox[{"root", " ", "+", " ", "0.015"}]}], "}"}], ",", 
                  " ", "1*^-17", ",", " ", "120"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"refinedRoot", " ", "=!=", " ", "$Failed"}], ",", 
                 " ", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"tempDisplay", " ", "=", " ", 
                   RowBox[{"PrintTemporary", "[", 
                    RowBox[{"\"\<Roots are: \>\"", ",", "segmentRoots"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"Break", "[", "]"}]}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"root", ",", " ", "segmentRoots"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
        "\n", "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"iterL", ",", " ", "iterLs"}], "}"}]}], "\n", "   ", "]"}], ";",
       "\[IndentingNewLine]", "\n", "  ", 
      RowBox[{"Delete", "[", "tempDisplay", "]"}], ";", "\n", "  ", 
      RowBox[{"{", 
       RowBox[{"refinedRoot", ",", " ", "roots", ",", " ", "dets"}], 
       "}"}]}]}], "\n", "  ", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9487094563343267`*^9, 3.948709533884626*^9}, {
   3.948709650999978*^9, 3.9487096827605886`*^9}, {3.948710088982215*^9, 
   3.948710151158958*^9}, {3.94871032658082*^9, 3.9487105191254683`*^9}, 
   3.948710613864643*^9, {3.948711248251153*^9, 3.948711248656522*^9}, {
   3.948711362167852*^9, 3.94871136609217*^9}, {3.9487114374189453`*^9, 
   3.948711439941732*^9}, {3.948893584087709*^9, 3.948893584744203*^9}, {
   3.9488955691776657`*^9, 3.948895574728745*^9}, {3.9489254663816423`*^9, 
   3.948925470456893*^9}, {3.948925513067197*^9, 3.948925532094693*^9}, {
   3.948925625540255*^9, 3.94892563923528*^9}, {3.948925956213678*^9, 
   3.948925963241806*^9}, {3.949752128074623*^9, 3.9497521282302513`*^9}, {
   3.949752436096258*^9, 3.94975261134797*^9}, {3.9497759621513033`*^9, 
   3.949775963438682*^9}, {3.949789523265766*^9, 3.949789524090733*^9}, {
   3.949888467683527*^9, 3.949888492094507*^9}, {3.949969116072735*^9, 
   3.949969116296842*^9}, 3.950003742653187*^9, {3.950705502615444*^9, 
   3.9507055272832108`*^9}, {3.950706074586578*^9, 3.950706103508712*^9}, 
   3.950706291194654*^9, 3.950735282842269*^9, 3.950735315495682*^9, 
   3.95150230289935*^9, {3.951502884110208*^9, 3.9515028909673033`*^9}, 
   3.9515070465927362`*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"c4101054-d238-41fc-b6a2-0eb2df58a8dd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Find Root Bisection", "Subsubsection",
 CellChangeTimes->{{3.948465067610483*^9, 3.9484650742459583`*^9}, {
  3.952523335305353*^9, 
  3.9525233392486362`*^9}},ExpressionUUID->"91853d80-cdcd-43e1-8a93-\
88ea54e28991"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"FindRootBisection", "[", 
    RowBox[{"f_", ",", " ", 
     RowBox[{"{", 
      RowBox[{"a_", ",", " ", "b_"}], "}"}], ",", " ", 
     RowBox[{"tolerance_", " ", ":", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "12"}]}]}], ",", " ", 
     RowBox[{"maxiter_", " ", ":", " ", "150"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"left", " ", "=", " ", "a"}], ",", " ", 
       RowBox[{"right", " ", "=", " ", "b"}], ",", " ", "mid", ",", " ", 
       "fleft", ",", " ", "fright", ",", " ", "fmid", ",", " ", 
       RowBox[{"iter", " ", "=", " ", "0"}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"fleft", " ", "=", " ", 
       RowBox[{"f", "[", "left", "]"}]}], ";", "\n", "   ", 
      RowBox[{"fright", " ", "=", " ", 
       RowBox[{"f", "[", "right", "]"}]}], ";", "\n", "   ", "\n", "   ", 
      RowBox[{"(*", 
       RowBox[{
       "Check", " ", "if", " ", "endpoints", " ", "have", " ", "opposite", " ",
         "signs"}], "*)"}], "\n", "   ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sign", "[", "fleft", "]"}], "*", 
          RowBox[{"Sign", "[", "fright", "]"}]}], " ", ">=", " ", "0"}], ",", 
        " ", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Warning: Endpoints don't bracket a root \>\"", 
          "]"}], ";", "\n", "    ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", "\n", "   ",
       "\n", "   ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"\"\<Iteration 0\>\"", ",", "\"\<: \>\"", 
          ",", "\"\<left=\>\"", ",", "left", ",", "\"\< (\>\"", ",", "fleft", 
          ",", "\"\<) right=\>\"", ",", "right", ",", "\"\< (\>\"", ",", 
          "fright", ",", "\"\<)\>\""}], "]"}], ";"}], "*)"}], "\n", "   ", 
      RowBox[{"Block", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$MinPrecision", "=", "30"}], "}"}], ",", "\n", "   ", 
        RowBox[{
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"right", " ", "-", " ", "left"}], "]"}], " ", ">", " ", 
             "tolerance"}], " ", "&&", " ", 
            RowBox[{"iter", " ", "<", " ", "maxiter"}]}], ",", " ", 
           RowBox[{
            RowBox[{"mid", " ", "=", " ", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"left", " ", "+", " ", "right"}], ")"}], "/", "2"}], 
               ",", " ", "20"}], "]"}]}], ";", "\n", "    ", 
            RowBox[{"fmid", " ", "=", " ", 
             RowBox[{"f", "[", "mid", "]"}]}], ";", "\n", "    ", "\n", 
            "    ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", "fmid", "]"}], " ", "<", " ", 
               "tolerance"}], ",", " ", 
              RowBox[{"Return", "[", "mid", "]"}]}], "]"}], ";", "\n", "    ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sign", "[", "fleft", "]"}], "*", 
                RowBox[{"Sign", "[", "fmid", "]"}]}], " ", "<=", " ", "0"}], ",",
               " ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"right", " ", "=", " ", "mid"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"fright", " ", "=", " ", "fmid"}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"left", " ", "=", " ", "mid"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"fleft", " ", "=", " ", "fmid"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"iter", "++"}], ";"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\n", "   ", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"\"\<Iteration \>\"", ",", "iter", ",", "\"\<: \>\"", 
        ",", "\"\<left=\>\"", ",", "left", ",", "\"\< (\>\"", ",", "fleft", 
        ",", "\"\<), \>\"", ",", "\"\<mid=\>\"", ",", "mid", ",", "\"\< (\>\"",
         ",", "fmid", ",", "\"\<), \>\"", ",", "\"\<right=\>\"", ",", "right",
         ",", "\"\< (\>\"", ",", "fright", ",", "\"\<)\>\""}], "]"}], ";", 
      "\n", "   ", "mid"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.9484650941097727`*^9, 3.949888444718405*^9, {3.950742678148926*^9, 
   3.9507427403095713`*^9}, {3.952431303999102*^9, 3.9524313162813053`*^9}, {
   3.9524318790091267`*^9, 3.952431898851881*^9}, {3.952432049977254*^9, 
   3.95243208213019*^9}, {3.952523355303544*^9, 
   3.9525234081255007`*^9}},ExpressionUUID->"aad5b884-bc07-4301-af69-\
794ed62a7bfb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FindLocalMinima", "Subsubsection",
 CellChangeTimes->{
  3.948464870968997*^9},ExpressionUUID->"05ea0d55-3657-4874-9f94-\
24d93636edcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindLocalMinima", "[", 
   RowBox[{"data_", ",", 
    RowBox[{"threshold_", ":", "3"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vals", ",", 
      RowBox[{"windowSize", "=", "5"}], ",", "minIndices", ",", "minima"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Work", " ", "with", " ", "log", " ", "values"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vals", "=", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Find", " ", "local", " ", "minima", " ", "indices"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"minIndices", "=", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"windowSize", "+", "1"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "vals", "]"}], "-", "windowSize"}]}], "]"}],
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Check", " ", "if", " ", "point", " ", "is", " ", "minimum", " ", 
          "in", " ", "its", " ", "window"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"vals", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"#", "-", "windowSize"}], ";;", 
               RowBox[{"#", "+", "windowSize"}]}], "]"}], "]"}], "]"}], "==", 
           
           RowBox[{"vals", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "&&", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Check", " ", "if", " ", "minimum", " ", "is", " ", "\"\<deep\>\"",
             " ", "enough", " ", "relative", " ", "to", " ", "neighbors"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"vals", "[", 
               RowBox[{"[", 
                RowBox[{"#", "-", "1"}], "]"}], "]"}], "-", 
              RowBox[{"vals", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"vals", "[", 
               RowBox[{"[", 
                RowBox[{"#", "+", "1"}], "]"}], "]"}], "-", 
              RowBox[{"vals", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}]}], "]"}], ">", 
           RowBox[{"Log", "[", "threshold", "]"}]}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Return", " ", 
       RowBox[{"{", 
        RowBox[{"lambda", ",", "value"}], "}"}], " ", "pairs"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"data", "[", 
      RowBox[{"[", "minIndices", "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.948709938839471*^9, 3.948710035621501*^9}, {
  3.950706007135643*^9, 3.950706012744081*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"4cd21e2e-94eb-4b23-bffb-7e845306d28a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["S Matrices", "Subsection",
 CellChangeTimes->{{3.9484650962038593`*^9, 
  3.948465099421315*^9}},ExpressionUUID->"ff92da06-d757-44dd-85b5-\
722525fc0933"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"Smatrices", "[", 
    RowBox[{
    "n_", ",", " ", "root_", ",", " ", "gamma_", ",", " ", "Q_", ",", " ", 
     "NN_", ",", " ", "Dpq_", ",", " ", "Dbar_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "S", "}"}], ",", "\n", "   ", 
     RowBox[{
      RowBox[{"S", " ", "=", " ", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Q", " ", "+", " ", "1"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "root"}], " ", "+", " ", 
          RowBox[{"gamma", " ", 
           RowBox[{"(", 
            RowBox[{"n", " ", "+", " ", "NN", " ", "+", " ", "1"}], ")"}]}]}],
          ")"}]}]}], ";", "\n", "   ", 
      RowBox[{"Do", "[", "\n", "    ", 
       RowBox[{
        RowBox[{"S", " ", "=", " ", 
         RowBox[{"Inverse", "[", "\n", "      ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "root"}], " ", "+", " ", 
              RowBox[{"gamma", "*", 
               RowBox[{"(", 
                RowBox[{"k", " ", "+", " ", "n"}], ")"}]}]}], ")"}], "*", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"Q", " ", "+", " ", "1"}], "]"}]}], " ", "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", " ", "+", " ", "k", " ", "+", " ", "1"}], ")"}], "*", 
            RowBox[{"Dpq", " ", ".", " ", "S", " ", ".", " ", "Dbar"}]}]}], 
          "\n", "      ", "]"}]}], ",", "\n", "    ", 
        RowBox[{"{", 
         RowBox[{"k", ",", " ", "NN", ",", " ", "1", ",", " ", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"n", " ", "+", " ", "1"}], "]"}]}], "*", 
       RowBox[{"S", " ", ".", " ", "Dbar"}]}]}]}], "\n", "   ", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.948465116417615*^9, 3.951482007791759*^9, {3.951520815488064*^9, 
   3.951520817849868*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"e07363cc-f2e9-4651-b139-2f53220d97fd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Smatrices", "[", 
    RowBox[{
    "n_", ",", "root_", ",", "gamma_", ",", "Q_", ",", "NN_", ",", "Dpq_", ",",
      "Dbar_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "workingPrecision"}], "}"}], ",", 
     RowBox[{
      RowBox[{"workingPrecision", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"Precision", "[", "root", "]"}], ",", 
         RowBox[{"Precision", "[", "gamma", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"Q", "+", "1"}], "]"}], ",", "workingPrecision"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "root"}], "+", 
          RowBox[{"gamma", " ", 
           RowBox[{"(", 
            RowBox[{"n", "+", "NN", "+", "1"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"S", "=", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "root"}], "+", 
                RowBox[{"gamma", "*", 
                 RowBox[{"(", 
                  RowBox[{"k", "+", "n"}], ")"}]}]}], ")"}], "*", 
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"Q", "+", "1"}], "]"}]}], ",", "workingPrecision"}], 
            "]"}], "-", 
           RowBox[{
            RowBox[{"SetPrecision", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "+", "k", "+", "1"}], ")"}], ",", 
              "workingPrecision"}], "]"}], "*", 
            RowBox[{"Dpq", ".", "S", ".", "Dbar"}]}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "NN", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", "workingPrecision"}], "]"}], "]"}]}],
        "*", 
       RowBox[{"S", ".", "Dbar"}]}]}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.951482008826034*^9, 3.95148200882965*^9}, 
   3.9515208232380877`*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"4290ef25-74d1-4dd5-b674-1c8a4293ca4f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculate Right Eigenfunction", "Subsection",
 CellChangeTimes->{{3.9484652338765306`*^9, 
  3.9484652600957127`*^9}},ExpressionUUID->"78001a50-6a96-418f-9744-\
5370b29a1b50"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"calculateEigenfunction", "[", 
    RowBox[{
    "root_", ",", " ", "gamma_", ",", " ", "Q_", ",", " ", "NN_", ",", " ", 
     "P_", ",", " ", "alpha_", ",", " ", "theta_", ",", " ", 
     RowBox[{"polyCoeff_", " ", ":", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "1"}], "}"}]}]}], "]"}], 
   " ", ":=", "\n", "  ", 
   RowBox[{"Module", "[", "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Dpq", ",", " ", "Dbar", ",", " ", "K0", ",", " ", "M", ",", " ", "U", ",",
        " ", "S", ",", " ", "V", ",", " ", "c0", ",", " ", "cn", ",", " ", 
       "psi", ",", " ", "PhiX", ",", " ", "normalization", ",", "c", ",", 
       "\n", "    ", "positionPart", ",", " ", "velocityPart", ",", " ", 
       "summationPart", ",", " ", "tempCn", ",", " ", "tempDisplay"}], "}"}], 
     ",", "\n", "   ", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"root", "===", "$Failed"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"$Failed", ",", "$Failed"}], "}"}], "]"}]}], "]"}], ";", 
      "\n", "   ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dpq", ",", " ", "Dbar"}], "}"}], " ", "=", " ", 
       RowBox[{"resizeDMatrices", "[", 
        RowBox[{"Q", ",", "\n", "     ", 
         RowBox[{"\"\<alpha \>\"", " ", "->", " ", "alpha"}], ",", "\n", 
         "     ", 
         RowBox[{"\"\<d1 \>\"", " ", "->", " ", 
          RowBox[{"polyCoeff", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "     ", 
         RowBox[{"\"\<d2 \>\"", " ", "->", " ", 
          RowBox[{"polyCoeff", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "     ", 
         RowBox[{"\"\<d3 \>\"", " ", "->", " ", 
          RowBox[{"polyCoeff", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "     ", 
         RowBox[{"\"\<d4 \>\"", " ", "->", " ", 
          RowBox[{"polyCoeff", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "     ", 
         RowBox[{"\"\<theta \>\"", " ", "->", " ", "theta"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"K0", " ", "=", " ", 
       RowBox[{"matrixContinuedFraction", "[", 
        RowBox[{
         RowBox[{"-", "root"}], ",", " ", "gamma", ",", " ", "Q", ",", " ", 
         "NN", ",", " ", "Dpq", ",", " ", "Dbar"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"M", " ", "=", " ", 
       RowBox[{
        RowBox[{"root", "*", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Q", " ", "+", " ", "1"}], "]"}]}], " ", "+", " ", "K0"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cn", " ", "=", " ", 
       RowBox[{"NullSpace", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tempDisplay", " ", "=", " ", 
         RowBox[{"PrintTemporary", "[", 
          RowBox[{"\"\<length of NullSpace[M]: \>\"", ",", " ", 
           RowBox[{"Length", "[", "cn", "]"}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "cn", "]"}], " ", "!=", " ", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "PrintTemporary", 
          "[", "\"\<Warning: Null Space wrong dimension, Check inputs \>\"", 
          "]"}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"$Failed", ",", "$Failed"}], "}"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Delete", "[", "tempDisplay", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tempDisplay", " ", "=", " ", 
         RowBox[{"PrintTemporary", "[", 
          RowBox[{"\"\<length of NullSpace[M]: \>\"", ",", " ", 
           RowBox[{"Length", "[", "cn", "]"}], ",", 
           "\[IndentingNewLine]", "\"\<; Norm of M . C0: \>\"", ",", " ", 
           RowBox[{"Norm", "[", " ", 
            RowBox[{"M", " ", ".", " ", 
             RowBox[{"cn", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tempDisplay", " ", "=", " ", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Norm of M . C0: \>\"", ",", " ", 
         RowBox[{"Norm", "[", " ", 
          RowBox[{"M", " ", ".", " ", 
           RowBox[{"cn", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", "\n", 
      "   ", "\n", "   ", "\n", "   ", 
      RowBox[{"Do", "[", "\n", "       ", 
       RowBox[{
        RowBox[{
         RowBox[{"tempCn", " ", "=", " ", 
          RowBox[{
           RowBox[{"Smatrices", "[", 
            RowBox[{
            "n", ",", " ", "root", ",", " ", "gamma", ",", " ", "Q", ",", " ",
              "NN", ",", " ", "Dpq", ",", " ", "Dbar"}], "]"}], " ", ".", " ", 
           RowBox[{"cn", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";", "\n", "       ", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"cn", ",", " ", "tempCn"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "0", ",", " ", 
          RowBox[{"P", " ", "-", " ", "1"}]}], "}"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "[", "n_", "]"}], " ", ":=", " ", 
       RowBox[{"cn", "[", 
        RowBox[{"[", 
         RowBox[{"n", " ", "+", " ", "1"}], "]"}], "]"}]}], ";", 
      RowBox[{"PhiX", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "[", 
          RowBox[{"i", ",", " ", 
           RowBox[{"alpha", "  ", "x"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "0", ",", " ", "Q"}], "}"}]}], "]"}]}], ";", 
      
      RowBox[{"normalization", " ", "=", " ", 
       RowBox[{"N", "[", 
        RowBox[{"positionPrefactor", "[", 
         RowBox[{"theta", ",", " ", "polyCoeff"}], "]"}], "]"}]}], ";", 
      RowBox[{"velocityPart", " ", "=", " ", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"alpha", " ", "/", "theta"}], " ", ")"}], 
         RowBox[{"1", "/", "2"}]], " ", 
        RowBox[{"\[Phi]", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"v", "/", 
           SqrtBox["theta"]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"positionPart", " ", "=", " ", 
       RowBox[{
        SqrtBox["normalization"], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Potential", "[", 
             RowBox[{"x", ",", " ", "polyCoeff"}], "]"}]}], "/", "2"}], "/", 
          "theta"}], "]"}]}]}], ";", 
      RowBox[{"summationPart", " ", "=", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "n", "]"}], " ", ".", " ", "PhiX"}], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"n", ",", " ", 
            RowBox[{"v", "/", 
             SqrtBox["theta"]}]}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"n", ",", " ", "0", ",", " ", "P"}], "}"}]}], "]"}]}], ";", 
      
      RowBox[{"psi", " ", "=", " ", 
       RowBox[{
       "positionPart", " ", "*", " ", "velocityPart", " ", "*", " ", 
        "summationPart"}]}], ";", 
      RowBox[{"Delete", "[", "tempDisplay", "]"}], ";", 
      RowBox[{"{", 
       RowBox[{"psi", ",", " ", "cn"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.948614219043635*^9, 3.948614248148921*^9}, {
   3.948614281762002*^9, 3.948614339289147*^9}, {3.948614369539445*^9, 
   3.94861440225175*^9}, {3.948722682126652*^9, 3.9487226848814983`*^9}, {
   3.948825827745764*^9, 3.9488258339835653`*^9}, {3.948825865825408*^9, 
   3.948825960173532*^9}, {3.948905903521625*^9, 3.948905908465239*^9}, {
   3.9489261020662737`*^9, 3.9489261512467327`*^9}, 3.951312601033538*^9, 
   3.951481423438601*^9, 3.951519992062063*^9, {3.952465574336423*^9, 
   3.952465598299027*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"a2655175-c00e-45ec-88e1-6394deba7692"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"calculateEigenfunction", "[", 
    RowBox[{
    "root_", ",", "gamma_", ",", "Q_", ",", "NN_", ",", "P_", ",", "alpha_", ",",
      "theta_", ",", 
     RowBox[{"polyCoeff_", ":", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], ",", 
     RowBox[{"workingPrecision_", ":", "30"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Dpq", ",", "Dbar", ",", "K0", ",", "M", ",", "U", ",", "S", ",", "V", ",",
        "c0", ",", "cn", ",", "psi", ",", "PhiX", ",", "normalization", ",", 
       "c", ",", "positionPart", ",", "velocityPart", ",", "summationPart", ",",
        "tempCn", ",", "tempDisplay"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dpq", ",", "Dbar"}], "}"}], "=", 
       RowBox[{"resizeDMatrices", "[", 
        RowBox[{"Q", ",", 
         RowBox[{"\"\<alpha \>\"", "->", "alpha"}], ",", 
         RowBox[{"\"\<d1 \>\"", "->", 
          RowBox[{"polyCoeff", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<d2 \>\"", "->", 
          RowBox[{"polyCoeff", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<d3 \>\"", "->", 
          RowBox[{"polyCoeff", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<d4 \>\"", "->", 
          RowBox[{"polyCoeff", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<theta \>\"", "->", "theta"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"K0", "=", 
       RowBox[{"matrixContinuedFraction", "[", 
        RowBox[{
         RowBox[{"-", "root"}], ",", "gamma", ",", "Q", ",", "NN", ",", "Dpq",
          ",", "Dbar"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{
        RowBox[{"root", "*", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Q", "+", "1"}], "]"}]}], "+", "K0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cn", "=", 
       RowBox[{"NullSpace", "[", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"M", ",", "workingPrecision"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "cn", "]"}], "!=", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "PrintTemporary", 
           "[", "\"\<Warning: Null Space wrong dimension, Check inputs \>\"", 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", 
          "[", "\"\<Warning: Null Space wrong dimension, Check inputs \>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"$Failed", ",", "$Failed"}], "}"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tempDisplay", "=", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Norm of M . C0: \>\"", ",", 
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"M", ",", "workingPrecision"}], "]"}], ".", 
           RowBox[{"cn", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tempCn", "=", 
          RowBox[{
           RowBox[{"Smatrices", "[", 
            RowBox[{
            "n", ",", "root", ",", "gamma", ",", "Q", ",", "NN", ",", "Dpq", ",",
              "Dbar"}], "]"}], ".", 
           RowBox[{"cn", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"cn", ",", "tempCn"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "0", ",", 
          RowBox[{"P", "-", "1"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "[", "n_", "]"}], ":=", 
       RowBox[{"cn", "[", 
        RowBox[{"[", 
         RowBox[{"n", "+", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"PhiX", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "[", 
          RowBox[{"i", ",", 
           RowBox[{"alpha", " ", "x"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "Q"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"normalization", "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"positionPrefactor", "[", 
          RowBox[{"theta", ",", "polyCoeff"}], "]"}], ",", 
         "workingPrecision"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"velocityPart", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"alpha", "/", "theta"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}], " ", 
        RowBox[{"\[Phi]", "[", 
         RowBox[{"0", ",", 
          RowBox[{"v", "/", 
           RowBox[{"Sqrt", "[", "theta", "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"positionPart", "=", 
       RowBox[{
        RowBox[{"Sqrt", "[", "normalization", "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Potential", "[", 
             RowBox[{"x", ",", "polyCoeff"}], "]"}]}], "/", "2"}], "/", 
          "theta"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"summationPart", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "n", "]"}], ".", "PhiX"}], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"n", ",", 
            RowBox[{"v", "/", 
             RowBox[{"Sqrt", "[", "theta", "]"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", "P"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"psi", "=", 
       RowBox[{"positionPart", "*", "velocityPart", "*", "summationPart"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Delete", "[", "tempDisplay", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"psi", ",", "cn"}], "}"}]}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9514814262865067`*^9, 3.951481426290173*^9}, {
   3.951506085970668*^9, 3.9515061197963037`*^9}, {3.951506944923697*^9, 
   3.9515069854739656`*^9}, 3.9515208054456367`*^9},
 CellLabel->"In[51]:=",ExpressionUUID->"c6f58fb5-d02e-4f43-86e6-297ec0eab6c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Left Eigenfunction", "Subsection",
 CellChangeTimes->{{3.948465265006545*^9, 
  3.948465267707761*^9}},ExpressionUUID->"aecafedc-4f67-4674-a8d3-\
0d6de3cfc227"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"leftEigenfunction", "[", 
    RowBox[{"eigenfunctionR_", ",", " ", "polyCoeff_", ",", " ", "theta_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eigenfunctionL", ",", " ", "inverseV"}], "}"}], ",", "\n", 
     "   ", 
     RowBox[{
      RowBox[{"inverseV", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"v", " ", "->", " ", 
         RowBox[{"-", "v"}]}], "}"}]}], ";", "\n", "   ", 
      RowBox[{"eigenfunctionL", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"eigenfunctionR", " ", "/.", " ", "inverseV"}], ")"}], "/", 
         "\n", "      ", 
         RowBox[{"wst", "[", 
          RowBox[{"theta", ",", " ", "polyCoeff"}], "]"}]}], "/", "\n", 
        "     ", 
        RowBox[{"N", "@", 
         RowBox[{"positionPrefactor", "[", 
          RowBox[{"theta", ",", " ", "polyCoeff"}], "]"}]}]}]}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.9484652735908422`*^9, {3.948926198303372*^9, 3.948926203217259*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"cbabe79b-e397-4585-bcd3-411aae382399"]
}, Closed]],

Cell[CellGroupData[{

Cell["Overlaps", "Subsection",
 CellChangeTimes->{{3.948465288670533*^9, 
  3.9484652898556347`*^9}},ExpressionUUID->"4132f726-6777-4da1-802b-\
95810ec0bc0c"],

Cell[CellGroupData[{

Cell["Calculate Overlaps", "Subsubsection",
 CellChangeTimes->{{3.948465377095552*^9, 
  3.948465382357379*^9}},ExpressionUUID->"ee859923-fcef-45a0-b970-\
2cf0a9ce8695"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"calculateOverlap", "[", 
    RowBox[{"leftEigenfunction_", ",", "polyCoeff_", ",", "bathTemp_", ",", 
     RowBox[{"divisions_", ":", "23"}], ",", 
     RowBox[{"workingPrecision_", ":", "30"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "minT", ",", "maxT", ",", "xs", ",", "boundy", ",", "boundx", ",", 
       "listTheta", ",", "overlaps", ",", "exponent", ",", "tempPlot"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"minT", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"0.1", "*", "bathTemp"}], ",", "workingPrecision"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"maxT", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"6", "*", "bathTemp"}], ",", "workingPrecision"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"boundx", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"Sqrt", "[", "bathTemp", "]"}]}], ",", "workingPrecision"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"boundy", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"6", " ", 
          RowBox[{"Sqrt", "[", "bathTemp", "]"}]}], ",", "workingPrecision"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exponent", "=", "5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"listTheta", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"increment", "^", "exponent"}], ",", "workingPrecision"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"increment", ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"minT", "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
             "workingPrecision"}], "]"}], ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"maxT", "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
             "workingPrecision"}], "]"}], ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"maxT", "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "exponent"}], ")"}]}], "-", 
                RowBox[{"minT", "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "exponent"}], ")"}]}]}], ")"}], "/", 
              "divisions"}], ",", "workingPrecision"}], "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"overlaps", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"wst", "[", 
                RowBox[{
                 RowBox[{"SetPrecision", "[", 
                  RowBox[{"theta", ",", "workingPrecision"}], "]"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",",
                    "polyCoeff"}], "]"}]}], "]"}], " ", "leftEigenfunction"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "boundx"}], ",", "boundx"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v", ",", 
                RowBox[{"-", "boundy"}], ",", "boundy"}], "}"}], ",", 
              RowBox[{"PrecisionGoal", "->", "10"}], ",", 
              RowBox[{"WorkingPrecision", "->", "workingPrecision"}], ",", 
              RowBox[{"MaxRecursion", "->", "40"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"theta", ",", "listTheta"}], "}"}]}], "]"}]}], ";"}], ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          
          RowBox[{"\"\<Inner Progress: \>\"", ",", "theta", ",", "\"\< / \>\"",
            ",", "maxT", ",", "\"\< \>\"", ",", 
           RowBox[{"ProgressIndicator", "[", 
            RowBox[{
             RowBox[{"theta", "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"minT", "^", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
               RowBox[{"maxT", "^", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "exponent"}], ")"}]}]}], "}"}]}], "]"}]}], 
          "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"listTheta", ",", "overlaps"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"bathTemp", ",", "0"}], "}"}], "}"}]}], "}"}]}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.951481264894268*^9, 3.951481274924234*^9}, {
  3.9515206283813553`*^9, 3.9515206288253613`*^9}, {3.951520788356833*^9, 
  3.951520792209735*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"46dd4934-dce9-4537-844d-cb2d77fa488c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"calculateOverlap", "[", 
   RowBox[{"leftEigenfunction_", ",", "polyCoeff_", ",", "bathTemp_", ",", 
    RowBox[{"divisions_", ":", "23"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "minT", ",", "maxT", ",", "xs", ",", "boundy", ",", "boundx", ",", 
      "listTheta", ",", "overlaps", ",", "exponent", ",", "tempPlot"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"minT", "=", 
      RowBox[{"0.1", "*", "bathTemp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"maxT", "=", 
      RowBox[{"6", "*", "bathTemp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"boundx", "=", 
      RowBox[{"1", "+", 
       RowBox[{"Sqrt", "[", "bathTemp", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"boundy", "=", 
      RowBox[{"5", 
       RowBox[{"Sqrt", "[", "bathTemp", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"exponent", "=", "5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"listTheta", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        SuperscriptBox["increment", "exponent"], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"increment", ",", 
          SuperscriptBox["minT", 
           RowBox[{"1", "/", "exponent"}]], ",", 
          SuperscriptBox["maxT", 
           RowBox[{"1", "/", "exponent"}]], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["maxT", 
              RowBox[{"1", "/", "exponent"}]], "-", 
             SuperscriptBox["minT", 
              RowBox[{"1", "/", "exponent"}]]}], ")"}], "/", "divisions"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"tempPlot", "=", 
        RowBox[{"ContourPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"wst", "[", 
            RowBox[{"bathTemp", ",", "polyCoeff"}], "]"}], " ", 
           "leftEigenfunction"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", 
            RowBox[{
             RowBox[{"-", "factor"}], "*", " ", "bound"}], ",", 
            RowBox[{"factor", "*", " ", "bound"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "tempPlot", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Monitor", "["}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"overlaps", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"wst", "[", 
            RowBox[{"theta", ",", "polyCoeff"}], "]"}], " ", 
           "leftEigenfunction"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "boundx"}], ",", "boundx"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", 
            RowBox[{"-", "boundy"}], ",", " ", "boundy"}], "}"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{",", " ", 
            RowBox[{"PrecisionGoal", "\[Rule]", "10"}], ","}], "*)"}], 
          "\[IndentingNewLine]", ",", " ", 
          RowBox[{"PrecisionGoal", "\[Rule]", "20"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MaxRecursion", "\[Rule]", "40"}]}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"Method", "->", 
            RowBox[{"{", "\"\<LevinRule\>\"", "}"}]}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"PrecisionGoal", "->", "8"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"Method", "->", "\"\<LocalAdaptive\>\""}]}], "*)"}], 
         "\[IndentingNewLine]", "]"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"wst", "[", 
            RowBox[{"theta", ",", "polyCoeff"}], "]"}], " ", 
           "leftEigenfunction"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "boundx"}], ",", "boundx"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", 
            RowBox[{"-", "boundy"}], ",", "boundy"}], "}"}], ",", 
          RowBox[{"PrecisionGoal", "->", "15"}], ",", 
          RowBox[{"WorkingPrecision", "->", "30"}], ",", 
          RowBox[{"MaxRecursion", "->", "50"}]}], "]"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"wst", "[", 
            RowBox[{"theta", ",", "polyCoeff"}], "]"}], " ", 
           "leftEigenfunction"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "boundx"}], ",", "boundx"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", 
            RowBox[{"-", "boundy"}], ",", "boundy"}], "}"}], ",", 
          RowBox[{"Method", "->", "\"\<MultidimensionalRule\>\""}], ",", 
          RowBox[{"WorkingPrecision", "->", "25"}], ",", 
          RowBox[{"PrecisionGoal", "->", "10"}]}], "]"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"theta", ",", "listTheta"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{",", "\[IndentingNewLine]", 
         RowBox[{"Row", "[", "\[IndentingNewLine]", 
          RowBox[{"{", 
           
           RowBox[{"\"\<Inner Progress: \>\"", ",", "theta", 
            ",", "\"\< / \>\"", ",", "maxT", ",", "\"\< \>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ProgressIndicator", "[", 
             RowBox[{
              RowBox[{"theta", "^", 
               RowBox[{"(", 
                RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{
                SuperscriptBox["minT", 
                 RowBox[{"1", "/", "exponent"}]], ",", 
                SuperscriptBox["maxT", 
                 RowBox[{"1", "/", "exponent"}]]}], "}"}]}], "]"}]}], "}"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"listTheta", ",", "overlaps"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"bathTemp", ",", "0"}], "}"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.948614479928423*^9, {3.948618995295372*^9, 3.9486189979992228`*^9}, {
   3.948733235054933*^9, 3.948733247823818*^9}, {3.948733315252163*^9, 
   3.9487333205052843`*^9}, {3.9487347201111727`*^9, 3.948734724792701*^9}, {
   3.948747877941992*^9, 3.948747879379551*^9}, {3.948749082906036*^9, 
   3.94874909449157*^9}, {3.9487494818341846`*^9, 3.948749483756081*^9}, {
   3.948749661483403*^9, 3.948749665850597*^9}, {3.9488722869812517`*^9, 
   3.94887231045643*^9}, {3.948895621370247*^9, 3.948895622043202*^9}, {
   3.9488981750476103`*^9, 3.948898190625811*^9}, {3.9488985650633802`*^9, 
   3.948898585395658*^9}, 3.948898733439003*^9, {3.9488989989271593`*^9, 
   3.948899051117056*^9}, 3.948917574258502*^9, 3.9489180247361298`*^9, {
   3.948918241440515*^9, 3.948918274676495*^9}, {3.948924496152424*^9, 
   3.948924501123345*^9}, {3.948924729702195*^9, 3.948924747692814*^9}, {
   3.948926425262393*^9, 3.948926448851076*^9}, {3.9489268461194057`*^9, 
   3.948926861094561*^9}, {3.948927082957106*^9, 3.9489271865603933`*^9}, {
   3.948927367977066*^9, 3.948927374002756*^9}, {3.948927614232545*^9, 
   3.9489276529399633`*^9}, {3.9489276977062197`*^9, 3.948927698269987*^9}, {
   3.948928342424011*^9, 3.94892834254709*^9}, 3.9489287471278067`*^9, {
   3.948929222764909*^9, 3.948929233546376*^9}, {3.948956271877733*^9, 
   3.948956335730747*^9}, {3.9489564825099087`*^9, 3.948956493159206*^9}, {
   3.948960003211514*^9, 3.9489600073094807`*^9}, {3.94896365287302*^9, 
   3.948963677434124*^9}, {3.9490742863526077`*^9, 3.9490743049831047`*^9}, {
   3.949256873023085*^9, 3.949256879920795*^9}, {3.949265318994759*^9, 
   3.9492653206598473`*^9}, {3.9492768536575737`*^9, 3.9492768761556177`*^9}, 
   3.9497533660352907`*^9, {3.94977607887269*^9, 3.949776078984749*^9}, 
   3.94996590192381*^9, {3.950704791957477*^9, 3.950704808525811*^9}, {
   3.95077564209023*^9, 3.950775644562255*^9}, {3.9514027419456167`*^9, 
   3.951402744053935*^9}, 3.95148128930046*^9, 3.9515207853807287`*^9, {
   3.951646136091153*^9, 3.951646137296159*^9}, {3.9516569871399183`*^9, 
   3.951656995853641*^9}, {3.951729490467092*^9, 3.95172950429631*^9}, {
   3.952465558177886*^9, 3.952465565283894*^9}, {3.9525027819146833`*^9, 
   3.952502784246978*^9}, {3.9525191488990707`*^9, 3.95251915591208*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"50903e4b-a676-4fa2-95ed-473b63f5fa6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot Overlaps", "Subsubsection",
 CellChangeTimes->{{3.9484652933662453`*^9, 
  3.9484652957807093`*^9}},ExpressionUUID->"5a240f81-334a-49c1-970f-\
6a045d917f42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotOverlaps", "[", 
   RowBox[{"checkpoint_", ",", " ", 
    RowBox[{"number_", " ", ":", " ", "2"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\n", "  ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "overlaps", ",", "fullPlot", ",", " ", "zoomedPlot", ",", " ", "labels", 
      ",", " ", "midIndex", ",", "x", ",", "y"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"labels", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<Second \>\"", ",", " ", "\"\<Third \>\"", ",", 
        " ", "\"\<Fourth \>\"", ",", " ", "\"\<Fifth \>\""}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"overlaps", "=", 
      RowBox[{"checkpoint", "[", 
       RowBox[{"[", "\"\<Overlaps\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fullPlot", " ", "=", " ", 
      RowBox[{"ListLinePlot", "[", "\n", "   ", 
       RowBox[{"overlaps", ",", "\n", "    ", 
        RowBox[{"PlotRange", " ", "->", " ", "All"}], ",", "\n", "    ", 
        RowBox[{"PlotLabel", " ", "->", " ", 
         RowBox[{"\"\<Overlap with \>\"", " ", "<>", " ", 
          RowBox[{"labels", "[", 
           RowBox[{"[", "number", "]"}], "]"}], " ", "<>", 
          " ", "\"\< Eigenfunction \>\""}]}], ",", "\n", "    ", 
        RowBox[{"AxesLabel", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<T \>\"", ",", " ", "\"\<a2 \>\""}], "}"}]}], ",", "\n",
         "    ", 
        RowBox[{"GridLines", " ", "->", " ", "Automatic"}]}], "]"}]}], ";", 
     "\n", "  ", "\[IndentingNewLine]", "\n", "  ", 
     RowBox[{"midIndex", " ", "=", " ", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"overlaps", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"2", "/", "3"}]}], ",", " ", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"overlaps", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "midIndex"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"y", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "midIndex"}], "]"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"zoomedPlot", " ", "=", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
          RowBox[{"overlaps", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "\n", 
        RowBox[{"(*", "    ", 
         RowBox[{
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "midIndex", "]"}], "]"}], "*", "1.2"}]}], "}"}],
              ",", " ", "Automatic"}], "}"}]}], ","}], "*)"}], "\n", "    ", 
        RowBox[{
        "PlotLabel", " ", "->", 
         " ", "\"\<Zoomed in at small Temperatures \>\""}], ",", "\n", "    ", 
        RowBox[{"AxesLabel", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<T \>\"", ",", " ", 
           RowBox[{"\"\<a \>\"", " ", "<>", " ", 
            RowBox[{"ToString", "[", "number", "]"}]}]}], "}"}]}], ",", "\n", 
        "    ", 
        RowBox[{"GridLines", " ", "->", " ", "Automatic"}]}], "]"}]}], ";", 
     "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"fullPlot", ",", " ", "zoomedPlot"}], "}"}]}]}], "\n", "  ", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9510833118096237`*^9, 3.951083316647937*^9}, {
  3.951083362279417*^9, 3.951083384756569*^9}, {3.951083419933729*^9, 
  3.9510834560736113`*^9}, {3.951083508251157*^9, 3.951083661136285*^9}, {
  3.951083696720593*^9, 3.9510837012178917`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"b32afe82-2ae9-48a3-842c-3993f0a100ac"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parallel Version", "Subsubsection",
 CellChangeTimes->{{3.9492558132774277`*^9, 
  3.949255819557642*^9}},ExpressionUUID->"0ab5b63b-57a3-43b1-ad26-\
943353080a59"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"calculateOverlapParallel", "[", 
    RowBox[{"leftEigenfunction_", ",", "polyCoeff_", ",", "bathTemp_", ",", 
     RowBox[{"divisions_", ":", "23"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "minT", ",", "maxT", ",", "xs", ",", "boundy", ",", "boundx", ",", 
       "listTheta", ",", "overlaps", ",", "exponent", ",", "tempPlot"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$MinPrecision", "=", "30"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"minT", "=", 
          RowBox[{"0.1", "*", "bathTemp"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"maxT", "=", 
          RowBox[{"8", "*", "bathTemp"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"boundx", "=", 
          RowBox[{"3", "+", 
           RowBox[{
            RowBox[{"Sqrt", "[", "bathTemp", "]"}], "/", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"boundy", "=", 
          RowBox[{"3", "+", 
           RowBox[{
            RowBox[{"Sqrt", "[", "bathTemp", "]"}], "/", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"exponent", "=", "5"}], ";", "\[IndentingNewLine]", 
         RowBox[{"listTheta", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"increment", "^", "exponent"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"increment", ",", 
              RowBox[{"minT", "^", 
               RowBox[{"(", 
                RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"maxT", "^", 
               RowBox[{"(", 
                RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"maxT", "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "exponent"}], ")"}]}], "-", 
                 RowBox[{"minT", "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "exponent"}], ")"}]}]}], ")"}], "/", 
               "divisions"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Initialize", " ", "parallel", " ", "kernels", " ", "if", " ", 
           "not", " ", "already", " ", "done"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"ParallelKernels", "[", "]"}], "]"}], "==", "0"}], ",", 
           RowBox[{
            RowBox[{"LaunchKernels", "[", "]"}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Distribute", " ", "necessary", " ", "definitions", " ", "to", " ", 
           "parallel", " ", "kernels"}], "*)"}], 
         RowBox[{"DistributeDefinitions", "[", 
          RowBox[{"wst", ",", "leftEigenfunction", ",", "polyCoeff"}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Create", " ", "a", " ", "progress", " ", "monitor", " ", 
           "variable"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"progressCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Parallel", " ", "computation", " ", "with", " ", "progress", " ", 
           "monitoring"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"overlaps", "=", "\[IndentingNewLine]", 
          RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Block", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"progressCounter", "++"}], ";", "\[IndentingNewLine]", 
               
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"result", "=", "\[IndentingNewLine]", 
                  RowBox[{"Quiet", "@", 
                   RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"wst", "[", 
                    RowBox[{"theta", ",", "polyCoeff"}], "]"}], " ", 
                    "leftEigenfunction"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"-", "boundx"}], ",", "boundx"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"v", ",", 
                    RowBox[{"-", "boundy"}], ",", "boundy"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PrecisionGoal", "->", "10"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MaxRecursion", "->", "40"}]}], 
                    "\[IndentingNewLine]", "]"}]}]}], ";"}], "*)"}], 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"result", "=", 
                RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"wst", "[", 
                    RowBox[{"theta", ",", "polyCoeff"}], "]"}], " ", 
                   "leftEigenfunction"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", 
                    RowBox[{"-", "boundx"}], ",", "boundx"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"v", ",", 
                    RowBox[{"-", "boundy"}], ",", "boundy"}], "}"}], ",", 
                  RowBox[{"Method", "->", "\"\<MultidimensionalRule\>\""}], ",", 
                  RowBox[{"WorkingPrecision", "->", "25"}], ",", 
                  RowBox[{"PrecisionGoal", "->", "10"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", "result"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"theta", ",", "listTheta"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"listTheta", ",", "overlaps"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"bathTemp", ",", "0"}], "}"}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Optional", ":", 
    RowBox[{
    "Function", " ", "to", " ", "clean", " ", "up", " ", "parallel", " ", 
     "kernels", " ", "when", " ", "done"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"cleanupParallelKernels", "[", "]"}], ":=", 
  RowBox[{"CloseKernels", "[", "]"}]}]}], "Input",
 CellChangeTimes->{{3.9492558218974457`*^9, 3.9492558889021063`*^9}, {
  3.949255928954125*^9, 3.9492559372750683`*^9}, {3.949256825573102*^9, 
  3.949256867743657*^9}, {3.949257046254754*^9, 3.949257142284462*^9}, {
  3.949260673472973*^9, 3.949260694486878*^9}, {3.952519329844719*^9, 
  3.952519339133185*^9}, {3.952519379049431*^9, 3.9525193987421227`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"2c7bc348-fe5d-40be-8185-f7c33c01f973"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
-----------------------
 Wrapping 
 -----------------------\
\>", "Subsection",
 CellChangeTimes->{{3.94846531191602*^9, 3.948465313691968*^9}, {
  3.948465402920411*^9, 3.948465405748117*^9}, {3.9484691475657*^9, 
  3.948469150251185*^9}, {3.948893131932681*^9, 3.94889314137112*^9}, {
  3.9509642647480297`*^9, 
  3.950964266422268*^9}},ExpressionUUID->"537b6d9e-81e8-4046-a9b2-\
e9e00ca6f130"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Wrapped", "[", 
   RowBox[{"initSetup_", ",", " ", 
    RowBox[{"polyCoeff_", ":", "johnsCoeff"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eigenfunctionR", ",", "eigenfunctionL", ",", "cn", ",", "inverseV", ",",
       "FPeigenfunctionL", ",", "\[IndentingNewLine]", "overlaps", ",", 
      "dets", ",", "listTheta", ",", "divisions", ",", "checkpoint", ",", 
      "roots", ",", "root", ",", "\[IndentingNewLine]", "alpha", ",", "Q", ",",
       "P", ",", "NN", ",", "bathT", ",", "gamma", ",", "number", ",", 
      "setup", ",", "refinedRoot"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "alpha", ",", "Q", ",", "P", ",", "NN", ",", "bathT", ",", "gamma"}], 
       "}"}], "=", "initSetup"}], ";", "\[IndentingNewLine]", 
     RowBox[{"alpha", " ", "=", 
      RowBox[{"optimizeAlpha", "[", 
       RowBox[{"initSetup", ",", "polyCoeff"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"setup", "=", 
      RowBox[{"{", 
       RowBox[{
       "alpha", ",", "Q", ",", "P", ",", "NN", ",", "bathT", ",", "gamma"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"\"\<alpha updates to: \>\"", ",", "alpha"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"root", ",", "roots", ",", "dets"}], "}"}], "=", 
        RowBox[{"getRoot", "[", 
         RowBox[{"polyCoeff", ",", "setup"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eigenfunctionR", ",", "cn"}], "}"}], "=", 
        RowBox[{"calculateEigenfunction", "[", 
         RowBox[{
         "root", ",", "gamma", ",", "Q", ",", "NN", ",", "P", ",", "alpha", ",",
           "bathT", ",", "polyCoeff"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"eigenfunctionR", "===", "$Failed"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           
           RowBox[{"\"\<        !Failed for BathT: \>\"", ",", "bathT", 
            ",", "\"\<, gamma: \>\"", ",", "gamma"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"roots", ",", "dets"}], "}"}], "=", 
      RowBox[{"getRoot", "[", 
       RowBox[{"setup", ",", "polyCoeff"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"roots", "==", "$Failed"}], ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fdet", "[", "lambda_", "]"}], " ", ":=", " ", 
      RowBox[{"determinant", "[", 
       RowBox[{
       "lambda", ",", " ", "gamma", ",", " ", "Q", ",", " ", "NN", ",", " ", 
        "alpha", ",", " ", "polyCoeff", ",", " ", "bathT"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"refinedRoot", " ", "=", " ", 
         RowBox[{"FindRootBisection", "[", 
          RowBox[{"fdet", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"root", " ", "-", " ", "0.05"}], ",", " ", 
             RowBox[{"root", " ", "+", " ", "0.05"}]}], "}"}], ",", " ", 
           "1*^-17", ",", " ", "120"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"$MinPrecision", "=", "30"}], "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"eigenfunctionR", ",", "cn"}], "}"}], "=", 
            RowBox[{"calculateEigenfunction", "[", 
             RowBox[{
             "refinedRoot", ",", "gamma", ",", "Q", ",", "NN", ",", "P", ",", 
              "alpha", ",", "bathT", ",", "polyCoeff"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"eigenfunctionR", "=!=", "$Failed"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{"\"\<Selected \>\"", "refinedRoot", "\"\< out of\>\""}], 
             ",", 
             RowBox[{"N", "@", "roots"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"root", ",", "roots"}], "}"}]}], "\[IndentingNewLine]", "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"eigenfunctionR", "===", 
        RowBox[{
         RowBox[{"$Failed", " ", "Or", " ", "roots"}], "==", 
         RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eigenfunctionL", "=", 
      RowBox[{"leftEigenfunction", "[", 
       RowBox[{"eigenfunctionR", ",", "polyCoeff", ",", "bathT"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"divisions", "=", "24"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"divisions", "=", "3"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Start calculating Overlap\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$MinPrecision", "=", "30"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"overlaps", "=", 
          RowBox[{"calculateOverlap", "[", 
           RowBox[{
           "eigenfunctionL", ",", "polyCoeff", ",", "bathT", ",", 
            "divisions"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"listTheta", ",", "overlaps"}], "}"}], "=", 
         RowBox[{"calculateOverlapParallel", "[", 
          RowBox[{
          "eigenfunctionL", ",", "polyCoeff", ",", "bathT", ",", 
           "divisions"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"checkpoint", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<BathT\>\"", "->", "bathT"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"\"\<alpha\>\"", "->", "alpha"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"\"\<Damp\>\"", "->", "gamma"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Coefficients\>\"", "->", "polyCoeff"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Determinants\>\"", "->", "dets"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<cn\>\"", "->", "cn"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<setup\>\"", "->", "setup"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"\"\<Roots\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"refinedRoot", ",", "roots"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Overlaps\>\"", "->", "overlaps"}]}], 
       "\[IndentingNewLine]", "|>"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9484647057061663`*^9, 3.9484647265764*^9}, {
   3.948464977522608*^9, 3.9484649904295073`*^9}, {3.948465026890727*^9, 
   3.948465150734321*^9}, {3.948465191372362*^9, 3.948465298627886*^9}, {
   3.948465370679484*^9, 3.948465398174244*^9}, {3.9484690689391727`*^9, 
   3.948469070341529*^9}, 3.948615043132144*^9, {3.9486180198097553`*^9, 
   3.948618027671383*^9}, {3.948618099222567*^9, 3.948618134581859*^9}, {
   3.948618182149969*^9, 3.9486182014845867`*^9}, {3.948619273289452*^9, 
   3.948619290169381*^9}, {3.948728169543456*^9, 3.9487281850121193`*^9}, {
   3.9487282439099283`*^9, 3.948728260452959*^9}, 3.948731153669807*^9, 
   3.948749639553624*^9, {3.948825414761018*^9, 3.9488255180938377`*^9}, {
   3.948825788979466*^9, 3.948825795838188*^9}, {3.948894875456683*^9, 
   3.9488948974052467`*^9}, {3.948894998343903*^9, 3.948895005464828*^9}, {
   3.9488950947639847`*^9, 3.9488950987180367`*^9}, {3.948895279342903*^9, 
   3.94889528229347*^9}, {3.948895359791535*^9, 3.948895368841511*^9}, {
   3.948895408030815*^9, 3.948895430508668*^9}, 3.9488954990122557`*^9, 
   3.94889554731454*^9, {3.9488989164330807`*^9, 3.948898940067704*^9}, {
   3.948899409108027*^9, 3.948899417947838*^9}, {3.948919676849802*^9, 
   3.94891968207445*^9}, {3.948928710731451*^9, 3.948928721245751*^9}, {
   3.948929084504201*^9, 3.948929116434887*^9}, {3.949068762692774*^9, 
   3.949068788773045*^9}, {3.949258439041092*^9, 3.949258450509851*^9}, 
   3.949261742295473*^9, {3.949261880391404*^9, 3.949261898929528*^9}, {
   3.949276894258306*^9, 3.949276899308907*^9}, {3.949310259015582*^9, 
   3.949310265060409*^9}, {3.9493108246404123`*^9, 3.949310825463901*^9}, {
   3.949495803366798*^9, 3.949495814104891*^9}, {3.94996659537717*^9, 
   3.949966600544034*^9}, {3.950735417263919*^9, 3.950735490691476*^9}, {
   3.950735895936899*^9, 3.950735927417185*^9}, {3.950741840319581*^9, 
   3.9507418556082563`*^9}, {3.9507447589231567`*^9, 3.950744759598978*^9}, {
   3.950744835810504*^9, 3.950744838003607*^9}, {3.950744872498884*^9, 
   3.9507448863587*^9}, 3.950775132088237*^9, 3.9507756676802692`*^9, {
   3.950775765093336*^9, 3.950775816076679*^9}, 3.950775937332591*^9, {
   3.950777281205104*^9, 3.95077733343546*^9}, {3.951222760908938*^9, 
   3.951222806575927*^9}, {3.9512228744502897`*^9, 3.9512228903344927`*^9}, {
   3.951222980205069*^9, 3.95122299653738*^9}, {3.9514040098954277`*^9, 
   3.95140403355262*^9}, {3.9514219553252163`*^9, 3.951421960908581*^9}, {
   3.9514219996467037`*^9, 3.951422007634001*^9}, {3.951482621343625*^9, 
   3.951482636725898*^9}, {3.9515023146949587`*^9, 3.9515023289709797`*^9}, {
   3.951505123059986*^9, 3.951505157719737*^9}, {3.9523693033245697`*^9, 
   3.952369306721126*^9}, {3.9523829072820673`*^9, 3.952382912338234*^9}, {
   3.952382977504681*^9, 3.952382979559617*^9}, {3.9524317932253857`*^9, 
   3.952431796059373*^9}, {3.952506417184917*^9, 3.9525064537871113`*^9}, {
   3.952519253977418*^9, 3.952519271899332*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"a4823945-820a-41e9-9a34-eabbd26aa124"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking for the effect", "Subsection",
 CellChangeTimes->{{3.948616488129167*^9, 
  3.9486165002174253`*^9}},ExpressionUUID->"f4736f96-c3d3-4c6d-826d-\
6adf8308796e"],

Cell[CellGroupData[{

Cell["Strong", "Subsubsection",
 CellChangeTimes->{
  3.94951710815476*^9},ExpressionUUID->"773d1c6f-c7da-4295-9b0d-4b958b0a5631"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StrongMpembaQ", "[", "checkpoint_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "DMEstate", ",", "IMEstate", ",", "theta", ",", "overlaps", ",", "type", 
      ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "checkpoint", "]"}], "=!=", "Association"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Corrupted Checkpoint\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"theta", ",", "overlaps"}], "}"}], " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"checkpoint", "[", 
         RowBox[{"[", "\"\<Overlaps\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"DMEstate", ",", "IMEstate"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ind", "=", "1"}], ",", 
       RowBox[{"ind", "<", 
        RowBox[{"Length", "[", "overlaps", "]"}]}], ",", 
       RowBox[{"ind", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sign", "[", 
             RowBox[{"overlaps", "[", 
              RowBox[{"[", "ind", "]"}], "]"}], "]"}], "=!=", 
            RowBox[{"Sign", "[", 
             RowBox[{"overlaps", "[", 
              RowBox[{"[", 
               RowBox[{"ind", "+", "1"}], "]"}], "]"}], "]"}]}], "&&", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"theta", "[", 
               RowBox[{"[", "ind", "]"}], "]"}], ">", 
              RowBox[{"checkpoint", "[", 
               RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}], "||", " ", 
             RowBox[{
              RowBox[{"checkpoint", "[", 
               RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}], ">", 
              RowBox[{"theta", "[", 
               RowBox[{"[", 
                RowBox[{"ind", "+", "1"}], "]"}], "]"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DMEstate", "===", "False"}], "&&", 
              RowBox[{
               RowBox[{"theta", "[", 
                RowBox[{"[", "ind", "]"}], "]"}], ">", 
               RowBox[{"checkpoint", "[", 
                RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"DMEstate", "=", "True"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"IMEstate", "===", "False"}], "&&", 
              RowBox[{
               RowBox[{"theta", "[", 
                RowBox[{"[", "ind", "]"}], "]"}], "<", 
               RowBox[{"checkpoint", "[", 
                RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IMEstate", " ", "=", " ", "True"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", " ", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IMEstate", "   ", "&&", "    ", "DMEstate"}], ",", "2", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"IMEstate", "   ", "&&", " ", 
         RowBox[{"!", "DMEstate"}]}], ",", 
        RowBox[{"-", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"!", "IMEstate"}], "&&", "    ", "DMEstate"}], ",", "1", ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"!", "DMEstate"}], "&&", " ", 
         RowBox[{"!", "IMEstate"}]}], ",", "0"}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9486165081248703`*^9, 3.948616617341029*^9}, {
   3.948616648633191*^9, 3.9486167511502657`*^9}, {3.948619130835945*^9, 
   3.9486192075445833`*^9}, {3.948619362022678*^9, 3.9486195332774277`*^9}, {
   3.94861962432008*^9, 3.948619660531488*^9}, {3.948619698861425*^9, 
   3.948619822092078*^9}, 3.948731321389688*^9, {3.9487317996394033`*^9, 
   3.948731863843717*^9}, 3.948731895058469*^9, {3.9487320047004766`*^9, 
   3.948732054443671*^9}, 3.9487321416829243`*^9, {3.9487322494289494`*^9, 
   3.9487323340829363`*^9}, {3.948732373354253*^9, 3.948732395117753*^9}, 
   3.9488953031300297`*^9, {3.948922155428713*^9, 3.9489221701751013`*^9}, {
   3.948922215030998*^9, 3.9489223047627497`*^9}, {3.948922461652895*^9, 
   3.948922472072445*^9}, {3.948928599800762*^9, 3.9489286191143217`*^9}, 
   3.948954787950817*^9, {3.948954977661559*^9, 3.948954981703179*^9}, {
   3.948955219262743*^9, 3.948955266784865*^9}, {3.9489570922574244`*^9, 
   3.948957116901936*^9}, {3.948957464042658*^9, 3.948957507720756*^9}, {
   3.948957884579102*^9, 3.9489579287852087`*^9}, {3.948958180015614*^9, 
   3.948958182654131*^9}, {3.94906584981721*^9, 3.94906585170166*^9}, {
   3.949067017816308*^9, 3.949067034139781*^9}, {3.949068287180599*^9, 
   3.949068289466165*^9}, {3.949485460031389*^9, 3.949485490049787*^9}, {
   3.949485567861217*^9, 3.9494856115185328`*^9}, {3.94948608949727*^9, 
   3.949486115527054*^9}, {3.949486326104444*^9, 3.9494864193009033`*^9}, 
   3.949486483942346*^9, {3.949486514473254*^9, 3.9494865374548903`*^9}, {
   3.949486582305709*^9, 3.94948667783438*^9}, {3.949486770011243*^9, 
   3.9494867712174187`*^9}, {3.949487008903326*^9, 3.94948702905371*^9}, {
   3.94948723144631*^9, 3.9494872361662817`*^9}, {3.949490546891946*^9, 
   3.9494905488611317`*^9}, {3.949490693796867*^9, 3.949490736040015*^9}, {
   3.949494326087199*^9, 3.949494404290782*^9}, {3.949494521537462*^9, 
   3.949494546589486*^9}, {3.9494946699343*^9, 3.949494670738326*^9}, 
   3.949522770611812*^9, 3.949966615959221*^9, {3.95005528188476*^9, 
   3.950055305746108*^9}, {3.950055390759945*^9, 3.950055411776462*^9}, 
   3.950055575110962*^9, 3.950056076858979*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"25ca6ac1-f371-49da-925b-daea596129cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Weak", "Subsubsection",
 CellChangeTimes->{{3.94951711527857*^9, 
  3.9495171162083607`*^9}},ExpressionUUID->"c1e10939-d642-4c6d-a6f2-\
524c35c3b9b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WeakMpembaQ", "[", "checkpoint_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "DMEstate", ",", "IMEstate", ",", "theta", ",", "overlaps", ",", "type",
        ",", "result", ",", "cross"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "checkpoint", "]"}], "=!=", "Association"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Corrupted Checkpoint\>\"", "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"theta", ",", "overlaps"}], "}"}], " ", "=", " ", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"checkpoint", "[", 
          RowBox[{"[", "\"\<Overlaps\>\"", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DMEstate", ",", "IMEstate"}], "}"}], " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"False", ",", "False"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cross", "[", "ind_", "]"}], ":=", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Sign", "[", 
         RowBox[{
          RowBox[{"overlaps", "[", 
           RowBox[{"[", "ind", "]"}], "]"}], "-", 
          RowBox[{"overlaps", "[", 
           RowBox[{"[", 
            RowBox[{"ind", "+", "1"}], "]"}], "]"}]}], "]"}], "=!=", 
        RowBox[{"Sign", "[", 
         RowBox[{
          RowBox[{"overlaps", "[", 
           RowBox[{"[", 
            RowBox[{"ind", "+", "1"}], "]"}], "]"}], "-", 
          RowBox[{"overlaps", "[", 
           RowBox[{"[", 
            RowBox[{"ind", "+", "2"}], "]"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ind", "=", "1"}], ",", 
        RowBox[{"ind", "<", 
         RowBox[{
          RowBox[{"Length", "[", "overlaps", "]"}], "-", "2"}]}], ",", 
        RowBox[{"ind", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"cross", "[", "ind", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DMEstate", "===", "False"}], "&&", 
               RowBox[{
                RowBox[{"theta", "[", 
                 RowBox[{"[", "ind", "]"}], "]"}], ">", 
                RowBox[{"checkpoint", "[", 
                 RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"DMEstate", "=", "True"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IMEstate", "===", "False"}], "&&", 
               RowBox[{
                RowBox[{"theta", "[", 
                 RowBox[{"[", "ind", "]"}], "]"}], "<", 
                RowBox[{"checkpoint", "[", 
                 RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"IMEstate", " ", "=", " ", "True"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", " ", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IMEstate", "   ", "&&", "    ", "DMEstate"}], ",", "2", ",",
          "\[IndentingNewLine]", 
         RowBox[{"IMEstate", "   ", "&&", " ", 
          RowBox[{"!", "DMEstate"}]}], ",", 
         RowBox[{"-", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"!", "IMEstate"}], "&&", "    ", "DMEstate"}], ",", "1", ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"!", "DMEstate"}], "&&", " ", 
          RowBox[{"!", "IMEstate"}]}], ",", "0"}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "result"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StrongMpembaQ", "[", "checkpoint_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "DMEstate", ",", "IMEstate", ",", "theta", ",", "overlaps", ",", "type", 
      ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"checkpoint", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Corrupted Checkpoint\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"theta", ",", "overlaps"}], "}"}], " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"checkpoint", "[", 
         RowBox[{"[", "\"\<Overlaps\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"DMEstate", ",", "IMEstate"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ind", "=", "1"}], ",", 
       RowBox[{"ind", "<", 
        RowBox[{"Length", "[", "overlaps", "]"}]}], ",", 
       RowBox[{"ind", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sign", "[", 
             RowBox[{"overlaps", "[", 
              RowBox[{"[", "ind", "]"}], "]"}], "]"}], "=!=", 
            RowBox[{"Sign", "[", 
             RowBox[{"overlaps", "[", 
              RowBox[{"[", 
               RowBox[{"ind", "+", "1"}], "]"}], "]"}], "]"}]}], "&&", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"theta", "[", 
               RowBox[{"[", "ind", "]"}], "]"}], ">", 
              RowBox[{"checkpoint", "[", 
               RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}], "||", " ", 
             RowBox[{
              RowBox[{"checkpoint", "[", 
               RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}], ">", 
              RowBox[{"theta", "[", 
               RowBox[{"[", 
                RowBox[{"ind", "+", "1"}], "]"}], "]"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DMEstate", "===", "False"}], "&&", 
              RowBox[{
               RowBox[{"theta", "[", 
                RowBox[{"[", "ind", "]"}], "]"}], ">", 
               RowBox[{"checkpoint", "[", 
                RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"DMEstate", "=", "True"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"IMEstate", "===", "False"}], "&&", 
              RowBox[{
               RowBox[{"theta", "[", 
                RowBox[{"[", "ind", "]"}], "]"}], "<", 
               RowBox[{"checkpoint", "[", 
                RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IMEstate", " ", "=", " ", "True"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", " ", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IMEstate", "   ", "&&", "    ", "DMEstate"}], ",", "2", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"IMEstate", "   ", "&&", " ", 
         RowBox[{"!", "DMEstate"}]}], ",", 
        RowBox[{"-", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"!", "IMEstate"}], "&&", "    ", "DMEstate"}], ",", "1", ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"!", "DMEstate"}], "&&", " ", 
         RowBox[{"!", "IMEstate"}]}], ",", "0"}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.948616624407888*^9, 3.948616645747787*^9}, {
   3.948616762280587*^9, 3.948616766915872*^9}, {3.9495171250529213`*^9, 
   3.9495171257609577`*^9}, {3.949517184463935*^9, 3.9495172421938334`*^9}, {
   3.9495173277543287`*^9, 3.9495173279110813`*^9}, {3.949517508805974*^9, 
   3.949517556933577*^9}, {3.949522082568499*^9, 3.949522117357502*^9}, {
   3.949522159280283*^9, 3.949522203071588*^9}, {3.949522691610812*^9, 
   3.94952269198039*^9}, {3.9495227626252613`*^9, 3.9495227644118757`*^9}, {
   3.949523134503137*^9, 3.949523135526801*^9}, 3.949966624209188*^9, {
   3.9500546977222967`*^9, 3.9500547004564867`*^9}, 3.950054732376556*^9, {
   3.950055133219626*^9, 3.9500551337496243`*^9}, 3.9500552724820347`*^9, 
   3.950055418135824*^9, {3.950055552023535*^9, 3.950055560065735*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"04b62cc5-4d35-47d0-a4d6-21b91abcf4f1"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Phase space visualize", "Subsection",
 CellChangeTimes->{{3.948615700882386*^9, 
  3.948615714449568*^9}},ExpressionUUID->"7324fb25-37d6-44c2-9b9d-\
e640549b13d9"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.948797629191649*^9, 3.948797719580393*^9}, {
  3.9487979470736732`*^9, 3.948797947293523*^9}, {3.9487981675953074`*^9, 
  3.948798182388719*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"ed49c4a6-8735-4857-8438-e34f0a933545"]
}, Open  ]]
},
WindowSize->{1440, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"eb7a872b-40d9-4abe-86f6-89337babe0b8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 203, 4, 79, "Subsection",ExpressionUUID->"5343f9c6-9da5-429e-9fb4-f2612009e761"],
Cell[CellGroupData[{
Cell[804, 30, 164, 3, 65, "Subsubsection",ExpressionUUID->"845d9d88-4bdb-4de3-b4be-d5c723641334"],
Cell[971, 35, 1333, 39, 166, "Input",ExpressionUUID->"8a44a3e0-ce0e-478b-a929-7a2e7cfc0eed"]
}, Closed]],
Cell[CellGroupData[{
Cell[2341, 79, 168, 3, 51, "Subsubsection",ExpressionUUID->"cd6019d3-1057-4669-a05f-335ecf1bc5bc"],
Cell[2512, 84, 21292, 624, 2892, "Input",ExpressionUUID->"6440dace-4702-4a83-b079-b623e148ae42"],
Cell[23807, 710, 325, 8, 44, "Input",ExpressionUUID->"b4c7a629-b164-4514-8c43-2ddbcc7b1398"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24169, 723, 167, 3, 65, "Subsubsection",ExpressionUUID->"b08187f5-860e-4448-af56-8d856893b286"],
Cell[24339, 728, 4358, 103, 871, "Input",ExpressionUUID->"a4480444-a9e3-4d7e-89d0-14b1e8d35e8c"],
Cell[28700, 833, 1371, 34, 350, "Input",ExpressionUUID->"1934686c-c9c1-4b7d-beb3-abb47521777a"],
Cell[30074, 869, 4854, 119, 649, "Input",ExpressionUUID->"c13e62f2-66b5-4831-85cf-78b22c183fee"],
Cell[34931, 990, 4839, 116, 626, "Input",ExpressionUUID->"bbfd5e5c-4b1a-49ca-a78d-6f68930f8aab"],
Cell[39773, 1108, 6834, 162, 840, "Input",ExpressionUUID->"0d88eeca-9a79-477d-85be-837b81ac15b4"]
}, Closed]],
Cell[CellGroupData[{
Cell[46644, 1275, 224, 4, 51, "Subsubsection",ExpressionUUID->"6858b706-db17-4b23-b969-86666657f48e"],
Cell[46871, 1281, 4452, 105, 687, "Input",ExpressionUUID->"70801402-dd40-4066-8871-939eea576b03"]
}, Closed]],
Cell[CellGroupData[{
Cell[51360, 1391, 229, 4, 51, "Subsubsection",ExpressionUUID->"055b5b06-41ce-42f3-9ea1-b07ca801af20"],
Cell[51592, 1397, 3847, 99, 547, "Input",ExpressionUUID->"f0216daa-c746-49fd-bb46-9f67f4bfcc44"],
Cell[55442, 1498, 883, 19, 166, "Input",ExpressionUUID->"0088a4a6-b716-43c4-ad99-d5900b60b03f"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56374, 1523, 210, 4, 79, "Subsection",ExpressionUUID->"c18f6b7c-ccd7-4988-ba16-056a9c05ecd6"],
Cell[56587, 1529, 3218, 76, 496, "Input",ExpressionUUID->"720a1c30-c974-417f-8acb-07716b32a410"],
Cell[59808, 1607, 3872, 97, 687, "Input",ExpressionUUID->"df1f743c-67d1-48b2-9b73-d8f5e180957b"]
}, Closed]],
Cell[CellGroupData[{
Cell[63717, 1709, 156, 3, 53, "Subsection",ExpressionUUID->"72da9c91-0a17-485c-994d-d9bb38e9fccb"],
Cell[63876, 1714, 4421, 109, 626, "Input",ExpressionUUID->"1acbc846-6247-409e-bf27-435cfc4065dd"]
}, Closed]],
Cell[CellGroupData[{
Cell[68334, 1828, 160, 3, 53, "Subsection",ExpressionUUID->"a531008a-1fe4-4fff-adaf-bc5d705e3c83"],
Cell[68497, 1833, 7101, 182, 1392, "Input",ExpressionUUID->"082266ed-2d80-4a26-bf2b-4c6eda139d45"],
Cell[75601, 2017, 6005, 152, 748, "Input",ExpressionUUID->"d1c20dd7-c6a5-4122-95bd-2617eb62e504"],
Cell[CellGroupData[{
Cell[81631, 2173, 182, 3, 65, "Subsubsection",ExpressionUUID->"9076a0aa-c5a3-4e57-8fff-d5f0cdce68a4"],
Cell[81816, 2178, 7033, 166, 796, "Input",ExpressionUUID->"599e526c-26cd-468a-9c16-4b3cb286875a"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[88898, 2350, 234, 4, 53, "Subsection",ExpressionUUID->"60f16c4a-cdc8-45f7-bd3d-dce4652bcfa4"],
Cell[89135, 2356, 2433, 55, 588, "Input",ExpressionUUID->"c8379d4f-5c71-42bf-b5ad-48f7182ad0b4"],
Cell[91571, 2413, 3493, 80, 595, "Input",ExpressionUUID->"f17955f2-34e6-4968-a092-703f98899044"]
}, Closed]],
Cell[CellGroupData[{
Cell[95101, 2498, 156, 3, 53, "Subsection",ExpressionUUID->"23e736b2-e322-4f7b-8611-2594bea1c9e1"],
Cell[CellGroupData[{
Cell[95282, 2505, 168, 3, 65, "Subsubsection",ExpressionUUID->"49a67774-febb-408a-96e2-fc9d9e68e36f"],
Cell[95453, 2510, 4665, 107, 922, "Input",ExpressionUUID->"f31f9bba-9986-44f5-8b09-06f0b54bb7c0"],
Cell[100121, 2619, 4013, 101, 442, "Input",ExpressionUUID->"ece2424c-45c0-4187-9654-42738487339f"],
Cell[104137, 2722, 7809, 163, 1422, "Input",ExpressionUUID->"c4101054-d238-41fc-b6a2-0eb2df58a8dd"]
}, Closed]],
Cell[CellGroupData[{
Cell[111983, 2890, 223, 4, 51, "Subsubsection",ExpressionUUID->"91853d80-cdcd-43e1-8a93-88ea54e28991"],
Cell[112209, 2896, 4861, 110, 779, "Input",ExpressionUUID->"aad5b884-bc07-4301-af69-794ed62a7bfb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117107, 3011, 142, 3, 65, "Subsubsection",ExpressionUUID->"05ea0d55-3657-4874-9f94-24d93636edcc"],
Cell[117252, 3016, 3242, 80, 564, "Input",ExpressionUUID->"4cd21e2e-94eb-4b23-bffb-7e845306d28a"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[120543, 3102, 160, 3, 53, "Subsection",ExpressionUUID->"ff92da06-d757-44dd-85b5-722525fc0933"],
Cell[120706, 3107, 2114, 53, 289, "Input",ExpressionUUID->"e07363cc-f2e9-4651-b139-2f53220d97fd"],
Cell[122823, 3162, 2518, 68, 227, "Input",ExpressionUUID->"4290ef25-74d1-4dd5-b674-1c8a4293ca4f"]
}, Closed]],
Cell[CellGroupData[{
Cell[125378, 3235, 181, 3, 53, "Subsection",ExpressionUUID->"78001a50-6a96-418f-9744-5370b29a1b50"],
Cell[125562, 3240, 8372, 196, 1406, "Input",ExpressionUUID->"a2655175-c00e-45ec-88e1-6394deba7692"],
Cell[133937, 3438, 6748, 171, 840, "Input",ExpressionUUID->"c6f58fb5-d02e-4f43-86e6-297ec0eab6c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140722, 3614, 176, 3, 53, "Subsection",ExpressionUUID->"aecafedc-4f67-4674-a8d3-0d6de3cfc227"],
Cell[140901, 3619, 1183, 31, 197, "Input",ExpressionUUID->"cbabe79b-e397-4585-bcd3-411aae382399"]
}, Closed]],
Cell[CellGroupData[{
Cell[142121, 3655, 158, 3, 53, "Subsection",ExpressionUUID->"4132f726-6777-4da1-802b-95810ec0bc0c"],
Cell[CellGroupData[{
Cell[142304, 3662, 169, 3, 65, "Subsubsection",ExpressionUUID->"ee859923-fcef-45a0-b970-2cf0a9ce8695"],
Cell[142476, 3667, 5398, 134, 626, "Input",ExpressionUUID->"46dd4934-dce9-4537-844d-cb2d77fa488c"],
Cell[147877, 3803, 9381, 203, 1417, "Input",ExpressionUUID->"50903e4b-a676-4fa2-95ed-473b63f5fa6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157295, 4011, 168, 3, 65, "Subsubsection",ExpressionUUID->"5a240f81-334a-49c1-970f-6a045d917f42"],
Cell[157466, 4016, 4130, 99, 741, "Input",ExpressionUUID->"b32afe82-2ae9-48a3-842c-3993f0a100ac"]
}, Closed]],
Cell[CellGroupData[{
Cell[161633, 4120, 169, 3, 51, "Subsubsection",ExpressionUUID->"0ab5b63b-57a3-43b1-ad26-943353080a59"],
Cell[161805, 4125, 7636, 169, 1606, "Input",ExpressionUUID->"2c7bc348-fe5d-40be-8185-f7c33c01f973"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[169490, 4300, 406, 10, 158, "Subsection",ExpressionUUID->"537b6d9e-81e8-4046-a9b2-e9e00ca6f130"],
Cell[169899, 4312, 10864, 224, 1943, "Input",ExpressionUUID->"a4823945-820a-41e9-9a34-eabbd26aa124"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180800, 4541, 173, 3, 79, "Subsection",ExpressionUUID->"f4736f96-c3d3-4c6d-826d-6adf8308796e"],
Cell[CellGroupData[{
Cell[180998, 4548, 130, 2, 65, "Subsubsection",ExpressionUUID->"773d1c6f-c7da-4295-9b0d-4b958b0a5631"],
Cell[181131, 4552, 6774, 141, 963, "Input",ExpressionUUID->"25ca6ac1-f371-49da-925b-daea596129cf"]
}, Closed]],
Cell[CellGroupData[{
Cell[187942, 4698, 156, 3, 51, "Subsubsection",ExpressionUUID->"c1e10939-d642-4c6d-a6f2-524c35c3b9b5"],
Cell[188101, 4703, 9946, 232, 2059, "Input",ExpressionUUID->"04b62cc5-4d35-47d0-a4d6-21b91abcf4f1"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[198096, 4941, 169, 3, 53, "Subsection",ExpressionUUID->"7324fb25-37d6-44c2-9b9d-e640549b13d9"],
Cell[198268, 4946, 292, 4, 74, "Input",ExpressionUUID->"ed49c4a6-8735-4857-8438-e34f0a933545"]
}, Open  ]]
}
]
*)

