(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    232728,       5771]
NotebookOptionsPosition[    222608,       5599]
NotebookOutlinePosition[    223001,       5615]
CellTagsIndexPosition[    222958,       5612]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Functions for MCF", "Title",
 CellChangeTimes->{{3.9525951714175453`*^9, 
  3.952595176633037*^9}},ExpressionUUID->"09f445ad-8fd2-4ccf-b0ef-\
7cea5dd83cd9"],

Cell["Apr 2nd polished again", "Subtitle",
 CellChangeTimes->{{3.9525951892930193`*^9, 
  3.952595211978141*^9}},ExpressionUUID->"85351fd8-07d9-459e-a28d-\
3f90274c1bdd"],

Cell[CellGroupData[{

Cell["Misc", "Subsection",
 CellChangeTimes->{{3.948464730543132*^9, 3.9484647406995296`*^9}, {
  3.948614136762987*^9, 
  3.948614139549883*^9}},ExpressionUUID->"5343f9c6-9da5-429e-9fb4-\
f2612009e761"],

Cell[CellGroupData[{

Cell["Phase Space", "Subsubsection",
 CellChangeTimes->{{3.949850126259013*^9, 
  3.9498501300276327`*^9}},ExpressionUUID->"845d9d88-4bdb-4de3-b4be-\
d5c723641334"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bathTemps", "=", 
   RowBox[{"N", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"E", "^", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "2.5"}], ",", "4.5", ",", "0.2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gammas", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0.2", ",", "10.25", ",", "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"(", 
  RowBox[{
   RowBox[{"alpha", "=", "3.5"}], ";", " ", 
   RowBox[{"Q", "=", "99"}], ";", " ", 
   RowBox[{"P", "=", "130"}], ";", " ", 
   RowBox[{"NN", "=", "200"}], ";"}], ")"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prec", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setups", "=", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "alpha", ",", "Q", ",", "P", ",", "NN", ",", "theta", ",", "gamma"}], 
        "}"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"theta", ",", "bathTemps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"gamma", ",", "gammas"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConfigNumber", "=", 
   RowBox[{"Length", "[", "setups", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.952526900966317*^9, 3.952526903209392*^9}, {
  3.952527277789983*^9, 3.952527299462722*^9}, {3.9525952335411463`*^9, 
  3.952595264645767*^9}, {3.954431987413618*^9, 3.954431994837943*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"8a44a3e0-ce0e-478b-a929-7a2e7cfc0eed"]
}, Closed]],

Cell[CellGroupData[{

Cell["Helper Function", "Subsubsection",
 CellChangeTimes->{{3.948614141224743*^9, 
  3.9486141425937862`*^9}},ExpressionUUID->"cd6019d3-1057-4669-a05f-\
335ecf1bc5bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lowMinima", "=", 
   RowBox[{"x", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"force", "[", 
         RowBox[{"x", ",", "johnsCoeff"}], "]"}], "==", "0"}], ",", "x"}], 
      "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"highMinima", "=", 
   RowBox[{"x", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"force", "[", 
         RowBox[{"x", ",", "johnsCoeff"}], "]"}], "==", "0"}], ",", "x"}], 
      "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellLabel->
  "In[126]:=",ExpressionUUID->"22409a06-d305-448b-b3ca-dbf9cb9d53fa"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", " ", "Get"}]}]}]}]}]}]}]}], " ", "position", " ", 
     "on", " ", "phase", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"plot", " ", "--"}], "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", "-"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ind2Coord", "[", 
     RowBox[{"ind_", ",", 
      RowBox[{"rowLength_", ":", "36"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"row", ",", "column"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"row", "=", 
        RowBox[{"Quotient", "[", 
         RowBox[{"ind", ",", "rowLength"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"column", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{"ind", ",", "rowLength"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"row", ",", "column"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Coord2Ind", "[", 
     RowBox[{"row_", ",", "column_", ",", 
      RowBox[{"rowLength_", ":", "36"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "ind", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ind", "=", 
       RowBox[{
        RowBox[{"row", "*", "rowLength"}], "+", "column"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Kramer"}]}]}]}]}]}]}]}]}], " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Operators", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}], "--"}], "--"}]}], "*)"}], "\n", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"adjointFokkerPlanck", "[", 
      RowBox[{"f_", ",", " ", 
       RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], " ", ":=", "\n", 
     "     ", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"f", ",", " ", "x"}], "]"}], " ", "v"}], " ", "-", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gamma", " ", "v"}], " ", "+", " ", 
           RowBox[{"force", "[", 
            RowBox[{"x", ",", " ", "johnsCoeff"}], "]"}]}], ")"}], " ", "f"}],
         ",", " ", "v"}], "]"}], " ", "+", " ", 
      RowBox[{"gamma", " ", "theta", " ", 
       RowBox[{"D", "[", 
        RowBox[{"f", ",", " ", 
         RowBox[{"{", 
          RowBox[{"v", ",", " ", "2"}], "}"}]}], "]"}]}]}]}], ";"}], "\n", 
   " ", "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", " ", "Adjoint"}]}]}]}]}]}]}], " ", "Kramer", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Operators", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
      "--"}]}], "*)"}], "\n", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"fokkerPlanck", "[", 
      RowBox[{"f_", ",", " ", 
       RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], " ", ":=", "\n", 
     "   ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"D", "[", 
         RowBox[{"f", ",", " ", "x"}], "]"}]}], " ", "v"}], " ", "+", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gamma", " ", "v"}], " ", "+", " ", 
           RowBox[{"force", "[", 
            RowBox[{"x", ",", " ", "johnsCoeff"}], "]"}]}], ")"}], " ", "f"}],
         ",", " ", "v"}], "]"}], " ", "+", " ", 
      RowBox[{"gamma", " ", "theta", " ", 
       RowBox[{"D", "[", 
        RowBox[{"f", ",", " ", 
         RowBox[{"{", 
          RowBox[{"v", ",", " ", "2"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testValue", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "->", "0"}], ",", 
       RowBox[{"v", "->", "0"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.952595059264554*^9, {3.952595135126594*^9, 3.952595141292214*^9}, {
   3.953056600168789*^9, 3.953056603509664*^9}, {3.953114590214177*^9, 
   3.953114688929047*^9}, 3.95311472052283*^9},
 CellLabel->
  "In[128]:=",ExpressionUUID->"ac1628b7-5631-4b90-bbba-27a097c10511"]
}, Closed]],

Cell[CellGroupData[{

Cell["Basis", "Subsubsection",
 CellChangeTimes->{
  3.952594954927217*^9},ExpressionUUID->"be8553f3-73ea-4005-9bef-\
72756efc5527"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"basis", " ", "--"}], "--"}], "--"}], "--"}], 
                   "--"}], "--"}], "--"}], "--"}], "--"}]}]}]}]}]}]}]}]}]}]}], 
    RowBox[{"--", 
     RowBox[{"--", "-"}]}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"n_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "normalization", ",", " ", "gaussianPart", ",", " ", "hermitePart"}], 
        "}"}], ",", "\n", "    ", 
       RowBox[{
        RowBox[{"normalization", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "^", "n"}], " ", 
            RowBox[{"n", "!"}], " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"2", " ", "\[Pi]"}], "]"}]}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}]}], ")"}]}]}], ";", "\n", "    ", 
        RowBox[{"gaussianPart", " ", "=", " ", 
         RowBox[{"E", "^", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "^", "2"}], "/", "4"}], ")"}]}], ")"}]}]}], ";", 
        "\n", "    ", 
        RowBox[{"hermitePart", " ", "=", " ", 
         RowBox[{"HermiteH", "[", 
          RowBox[{"n", ",", " ", 
           RowBox[{"x", "/", 
            RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}]}], ";", "\n", "    ", 
        RowBox[{
        "normalization", "*", "gaussianPart", "*", "hermitePart"}]}]}], "\n", 
      "    ", "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "normalization", ",", "gaussianPart", ",", "hermitePart", ",", "p"}],
          "}"}], ",", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"Precision", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"normalization", "=", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "^", "n"}], " ", 
               RowBox[{"n", "!"}], " ", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"2", " ", "\[Pi]"}], "]"}]}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}]}], ")"}]}], ",", "p"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"gaussianPart", "=", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "^", "2"}], "/", "4"}], ")"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"hermitePart", "=", 
          RowBox[{"HermiteH", "[", 
           RowBox[{"n", ",", 
            RowBox[{"x", "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"SetPrecision", "[", 
               RowBox[{"2", ",", "p"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "normalization", "*", "gaussianPart", "*", "hermitePart"}]}]}], 
       "]"}]}], ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.952595323907888*^9, 3.952595351052692*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"1ab9cb8d-fc86-4811-aa32-71453ebee0e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Potential", "Subsubsection",
 CellChangeTimes->{{3.952595046245915*^9, 
  3.952595048762096*^9}},ExpressionUUID->"2b337ebe-4c1d-45b7-be66-\
b21119cf15d6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"johnPotential", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"barrierE", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["x", "xm"], ")"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["x", "xm"], ")"}], "4"]}], ")"}]}], "-", 
      RowBox[{
       FractionBox["deltaE", "2"], 
       RowBox[{"(", 
        FractionBox["x", "xm"], ")"}]}]}], "//", "Expand"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CoefficientList", "[", 
     RowBox[{"johnPotential", ",", "x"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{"johnPotential", ",", "x"}], "]"}], " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}], "\[IndentingNewLine]", 
    RowBox[{"Delete", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"CoefficientList", "[", 
        RowBox[{"johnPotential", ",", "x"}], "]"}], " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
      "\[IndentingNewLine]", ",", "1"}], "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.952595936466753*^9, 3.9525959369501877`*^9}, {
  3.952595981696724*^9, 3.952595994891428*^9}, {3.9526208982824793`*^9, 
  3.952620974121129*^9}, {3.9527299288976603`*^9, 3.95272993488455*^9}, {
  3.952729982235602*^9, 3.952729993483342*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"7e5332de-bf2e-4279-99be-02318fcd2cf7"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", 
              RowBox[{"John", "'"}]}]}]}]}]}]}]}]}]}]}], "s", " ", 
    RowBox[{
     RowBox[{"setup", " ", "--"}], "--"}], 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"barrierE", "=", "2"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"deltaE", " ", "=", " ", "1.3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xm", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"johnPotential", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"barrierE", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["x", "xm"], ")"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["x", "xm"], ")"}], "4"]}], ")"}]}], "-", 
       RowBox[{
        FractionBox["deltaE", "2"], 
        RowBox[{"(", 
         FractionBox["x", "xm"], ")"}]}]}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"johnsCoeff", "=", 
     RowBox[{"Delete", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{"johnPotential", ",", "x"}], "]"}], "*", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ",", 
       "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "johnPotential", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", "Force"}]}]}]}]}]}]}], " ", "from", " ", "the", " ", 
      
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"potential", "--"}], "--"}], "--"}], "--"}], "--"}], 
       "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"force", "[", 
     RowBox[{"x_", ",", " ", "johnsCoeff_"}], "]"}], " ", ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"johnsCoeff", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "+", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"johnsCoeff", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", 
      RowBox[{"x", "^", "1"}]}], " ", "+", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"johnsCoeff", "[", 
       RowBox[{"[", "3", "]"}], "]"}], " ", 
      RowBox[{"x", "^", "2"}]}], " ", "+", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"johnsCoeff", "[", 
       RowBox[{"[", "4", "]"}], "]"}], " ", 
      RowBox[{"x", "^", "3"}]}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"force", "[", 
       RowBox[{"x_", ",", "johnsCoeff_"}], "]"}], ":=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "p", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Precision", "[", "x", "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"Precision", "/@", "johnsCoeff"}], "]"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SetPrecision", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"johnsCoeff", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "p"}], "]"}], "+", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"johnsCoeff", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "p"}], "]"}], "*", 
           RowBox[{"x", "^", "1"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"johnsCoeff", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", "p"}], "]"}], "*", 
           RowBox[{"x", "^", "2"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"johnsCoeff", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", "p"}], "]"}], "*", 
           RowBox[{"x", "^", "3"}]}]}]}]}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", " ", "\[IndentingNewLine]", " ", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Potential", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], 
                "--"}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Potential", "[", 
      RowBox[{"x_", ",", " ", 
       RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], " ", ":=", "\n", 
     "   ", 
     RowBox[{
      RowBox[{
       RowBox[{"johnsCoeff", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"x", "^", "1"}], "/", "1"}]}], " ", "+", "\n", "    ", 
      RowBox[{
       RowBox[{"johnsCoeff", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"x", "^", "2"}], "/", "2"}]}], " ", "+", "\n", "    ", 
      RowBox[{
       RowBox[{"johnsCoeff", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"x", "^", "3"}], "/", "3"}]}], " ", "+", "\n", "    ", 
      RowBox[{
       RowBox[{"johnsCoeff", "[", 
        RowBox[{"[", "4", "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"x", "^", "4"}], "/", "4"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Potential", "[", 
       RowBox[{"x_", ",", 
        RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], ":=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "p", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Precision", "[", "x", "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"Precision", "/@", "johnsCoeff"}], "]"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"johnsCoeff", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "p"}], "]"}], "*", 
           RowBox[{
            RowBox[{"x", "^", "1"}], "/", "1"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"johnsCoeff", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "p"}], "]"}], "*", 
           RowBox[{
            RowBox[{"x", "^", "2"}], "/", "2"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"johnsCoeff", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", "p"}], "]"}], "*", 
           RowBox[{
            RowBox[{"x", "^", "3"}], "/", "3"}]}], "+", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"johnsCoeff", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", "p"}], "]"}], "*", 
           RowBox[{
            RowBox[{"x", "^", "4"}], "/", "4"}]}]}]}]}], "]"}]}], ";"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.952595081971527*^9, 3.952595082572397*^9}, 
   3.952595331583001*^9, {3.952595361629732*^9, 3.952595382512344*^9}, {
   3.952595567331373*^9, 3.9525956087234507`*^9}, {3.952595639848782*^9, 
   3.952595681137542*^9}, {3.952596091660679*^9, 3.9525961028696547`*^9}, {
   3.9525981643275213`*^9, 3.952598215866025*^9}, 3.952598289480556*^9, {
   3.952620820853331*^9, 3.952620840126074*^9}, {3.952620934031754*^9, 
   3.95262093450438*^9}, {3.952729953356545*^9, 3.9527299866901484`*^9}, {
   3.9531583934219*^9, 3.953158394878975*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"dc067ecb-e4cd-45b1-88d7-7eeb7232c110"]
}, Closed]],

Cell[CellGroupData[{

Cell["Stationary State", "Subsubsection",
 CellChangeTimes->{{3.952595089115456*^9, 
  3.952595094906863*^9}},ExpressionUUID->"cea11edd-e0e9-4dcf-9815-\
c826d70b07f6"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normalization", " ", "--"}], "--"}], "--"}], 
                   "--"}], "--"}], "--"}], "--"}], "--"}]}]}]}]}]}]}]}]}]}]}],
     "-"}], "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "positionPrefactor", "]"}], ";", 
    RowBox[{
     RowBox[{"positionPrefactor", "[", " ", 
      RowBox[{"theta_", " ", ",", 
       RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], " ", ":=", "\n", 
     "   ", 
     RowBox[{"1", "/", 
      RowBox[{"NIntegrate", "[", "\n", "     ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Potential", "[", 
            RowBox[{"x", ",", " ", "johnsCoeff"}], "]"}]}], "/", "theta"}], 
         "]"}], ",", "\n", "     ", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", 
          RowBox[{"-", "Infinity"}], ",", " ", "Infinity"}], "}"}]}], "\n", 
       "     ", "]"}]}]}], ";"}], " ", "\n", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"positionPrefactor", "[", 
      RowBox[{"theta_", ",", "johnsCoeff_"}], "]"}], ":=", 
     RowBox[{"1", "/", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Potential", "[", 
            RowBox[{"x", ",", "johnsCoeff"}], "]"}]}], "/", "theta"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "->", 
         RowBox[{"Precision", "[", "theta", "]"}]}], ",", 
        RowBox[{"PrecisionGoal", "->", 
         RowBox[{"Min", "[", 
          RowBox[{"10", ",", 
           RowBox[{
            RowBox[{"Precision", "[", "theta", "]"}], "-", "5"}]}], "]"}]}]}],
        "]"}]}]}], "*)"}], "\n", "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", " ", "Stationary"}]}]}]}]}]}]}]}]}], " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"state", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}], "--"}], "--"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "wst", "]"}], ";"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"wst", "[", 
     RowBox[{"theta_", " ", ",", " ", 
      RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], " ", ":=", " ", 
    "\n", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{"positionPrefactor", "[", 
         RowBox[{"theta", ",", "johnsCoeff"}], "]"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Potential", "[", 
           RowBox[{"x", ",", " ", "johnsCoeff"}], "]"}]}], " ", "/", 
         "theta"}], "]"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", " ", 
        SqrtBox[
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]", " ", "theta"}], ")"}]]}], " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", " ", 
           SuperscriptBox["v", "2"]}], "/", "2"}], "/", "theta"}], "]"}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"wst", "[", 
      RowBox[{"theta_", ",", 
       RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], ":=", 
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"positionPrefactor", "[", 
          RowBox[{"theta", ",", "johnsCoeff"}], "]"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"2", "/", "Pi"}], "/", "theta"}], "]"}]}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Potential", "[", 
              RowBox[{"x", ",", "johnsCoeff"}], "]"}], "+", 
             RowBox[{
              RowBox[{"v", "^", "2"}], "/", "2"}]}], ")"}]}], "/", "theta"}], 
         "]"}]}], ",", 
       RowBox[{"Precision", "[", "theta", "]"}]}], "]"}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.952595129157784*^9, {3.952598310335473*^9, 3.952598328820381*^9}, {
   3.95262099086867*^9, 3.9526209945523653`*^9}, {3.9530509208331738`*^9, 
   3.953050924480669*^9}, {3.954239390939815*^9, 3.9542394167382383`*^9}, {
   3.954239448812999*^9, 3.954239449595613*^9}, {3.954239644803426*^9, 
   3.954239655309662*^9}, 3.954239811763839*^9, {3.9542398543923388`*^9, 
   3.954240007506892*^9}, {3.954240131305092*^9, 3.954240135218595*^9}, {
   3.9542401692345448`*^9, 3.9542401977840433`*^9}, {3.954240268250143*^9, 
   3.954240300177535*^9}, {3.9542403406976757`*^9, 3.9542403432893963`*^9}, {
   3.954240506050605*^9, 3.954240528308057*^9}, {3.954241153530135*^9, 
   3.9542411610904303`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"5fed0403-3447-42bf-a31e-614a2f87427c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Heat Map", "Subsubsection",
 CellChangeTimes->{{3.952598353896249*^9, 
  3.9525983585561934`*^9}},ExpressionUUID->"94f8b1c0-51cb-48ee-a7ed-\
df4c126c3c99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"SME", " ", "Heat", " ", "map"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<WK_ti_tb.gif\>\"", ",", "listplots", ",", 
     RowBox[{"\"\<AnimationRepetitions\>\"", "->", "Infinity"}], ",", 
     RowBox[{"\"\<DisplayDurations\>\"", "->", "1"}]}], "]"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"listplots", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"GfileNames", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"fileNames", ",", 
          RowBox[{
           RowBox[{"StringMatchQ", "[", 
            RowBox[{"#", ",", 
             RowBox[{
             "___", "~~", "\"\</checkpoint_\>\"", "~~", "DigitCharacter", "~~",
               "DigitCharacter", "~~", "DigitCharacter", "~~", 
              "DigitCharacter", "~~", 
              RowBox[{"\"\<_\>\"", "<>", 
               RowBox[{"ToString", "[", "gamma", "]"}], "<>", "\"\<_\>\""}], "~~",
               "___"}]}], "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"Heatmap", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ckpt", "=", 
           RowBox[{"Import", "[", "filename", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "@", "ckpt"}], "=!=", "Association"}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ovlaps", "=", 
           RowBox[{
            RowBox[{"ckpt", "[", 
             RowBox[{"[", "\"\<Overlaps\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"reverse", "=", 
           RowBox[{"Sign", "[", 
            RowBox[{"ovlaps", "[", 
             RowBox[{"[", 
              RowBox[{"12", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ovlaps", "=", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Transpose", "[", "ovlaps", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"reverse", " ", 
               RowBox[{
                RowBox[{"Transpose", "[", "ovlaps", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"PrependTo", "[", 
             RowBox[{
              RowBox[{"ovlaps", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"ckpt", "[", 
               RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "@", "ovlaps"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"Heatmap", ",", "ovlaps"}], "]"}]}], "\[IndentingNewLine]",
          ",", 
         RowBox[{"{", 
          RowBox[{"filename", ",", "GfileNames"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"listplots", ",", 
         RowBox[{"ListContourPlot", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Heatmap", ",", "1"}], "]"}], ",", 
           RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
           RowBox[{"Contours", "->", "Automatic"}]}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"gamma", ",", "gammas"}], "}"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.950288502614373*^9, 3.950288523933127*^9}, {
  3.950289912009893*^9, 3.950289915776723*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"a4480444-a9e3-4d7e-89d0-14b1e8d35e8c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Quick Plots", "Subsubsection",
 CellChangeTimes->{{3.952598377505123*^9, 3.952598386297779*^9}, {
  3.954318630049275*^9, 
  3.954318631467268*^9}},ExpressionUUID->"be6dee1c-5dc2-41be-b9d5-\
df19c79476e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotintegrand", "[", 
   RowBox[{"cp_", ",", "factor_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "leig", ",", "theta", ",", "lowMinima", ",", "highMinima", ",", "boundy",
       ",", "boundx"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"leig", "=", 
      RowBox[{"checkpoint2LeftEig", "[", "cp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"theta", "=", 
      RowBox[{"cp", "[", 
       RowBox[{"[", "\"\<theta\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lowMinima", "=", 
      RowBox[{"x", "/.", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"force", "[", 
            RowBox[{"x", ",", "johnsCoeff"}], "]"}], "==", "0"}], ",", "x"}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"highMinima", "=", 
      RowBox[{"x", "/.", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"force", "[", 
            RowBox[{"x", ",", "johnsCoeff"}], "]"}], "==", "0"}], ",", "x"}], 
         "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"boundy", "[", "T_", "]"}], ":=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"2", 
         SqrtBox[
          RowBox[{"2", "T"}]]}], ",", 
        RowBox[{"2", 
         SqrtBox[
          RowBox[{"2", " ", "8", " ", "bathTemp"}]]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"boundx", "=", 
      RowBox[{"1.6", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"johnsCoeff", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "/", "4"}], "bathTemp"}], ")"}], 
        RowBox[{"1", "/", "4"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plot3D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"wst", "[", 
         RowBox[{"theta", ",", "johnsCoeff"}], "]"}], " ", "leig"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"lowMinima", "-", "boundx"}], ",", 
         RowBox[{"highMinima", "+", "boundx"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", 
         RowBox[{"-", 
          RowBox[{"boundy", "[", "theta", "]"}]}], ",", 
         RowBox[{"boundy", "[", "theta", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.954399823867556*^9, 3.954399868010755*^9}, {
  3.954399903099255*^9, 3.954399996725947*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"f85de152-6baf-4a20-995b-1a52777e7f66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plot3", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"bound_", ":", "3"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Plot3D", "[", 
    RowBox[{"f", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", 
       RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
     RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotC", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"bound_", ":", "3"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ContourPlot", "[", 
   RowBox[{"f", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"v", ",", 
      RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "->", "Automatic"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "->", "All"}], ",", "\[IndentingNewLine]", 
    RowBox[{"GridLines", "->", "Automatic"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.948614118770156*^9, 3.9486141189967613`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"1934686c-c9c1-4b7d-beb3-abb47521777a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Phase space plotting", "Subsubsection",
 CellChangeTimes->{{3.952598396875071*^9, 
  3.9525984037109203`*^9}},ExpressionUUID->"64a03f8f-149f-479f-b225-\
8d102722ef81"],

Cell[BoxData[
 RowBox[{
  RowBox[{"smPlots", "[", "SMstates_", "]"}], ":=", 
  RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{"SMstates", ",", "34"}], " ", 
     RowBox[{"(*", 
      RowBox[{"Length", "@", "gammas"}], "*)"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FrameTicks", "->", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"gammas", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "gammas", "]"}], ",", "5"}], "}"}]}], 
          "]"}], ",", "None"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"ScientificForm", "[", 
              RowBox[{
               RowBox[{"bathTemps", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}]}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "bathTemps", "]"}], ",", "5"}], "}"}]}], 
          "]"}], ",", "None"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ColorRules", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.5019607843137255, 0.8549019607843137, 0.9215686274509803]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"0", "->", 
        TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"1", "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.9921568627450981, 0.48627450980392156`, 0.43137254901960786`]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"0.5", "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"2", "->", 
        TemplateBox[<|
         "color" -> RGBColor[0.45098039215686275`, 0.4, 0.7411764705882353]|>,
         
         "RGBColorSwatchTemplate"]}]}], 
      RowBox[{"(*", 
       TemplateBox[<|
        "color" -> RGBColor[
          0.6352941176470588, 0.6352941176470588, 0.8156862745098039]|>,
        "RGBColorSwatchTemplate"], "*)"}], "}"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "->", "\[IndentingNewLine]", 
     RowBox[{"SwatchLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TemplateBox[<|
          "color" -> RGBColor[
            0.9921568627450981, 0.48627450980392156`, 0.43137254901960786`]|>,
          
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[
            0.5019607843137255, 0.8549019607843137, 0.9215686274509803]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[0.45098039215686275`, 0.4, 0.7411764705882353]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[
            0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
          "RGBColorSwatchTemplate"]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\"\<Direct sME\>\"", ",", "\"\<Inverse sME\>\"", 
         ",", "\"\<No sME\>\"", ",", "\"\<DsME & IsME\>\"", 
         ",", "\"\<Error\>\""}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"LegendMarkerSize", "->", "15"}], ",", "\[IndentingNewLine]", 
       RowBox[{"LegendLayout", "->", "\"\<Column\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<\[Gamma]\>\"", 
       ",", "\"\<\!\(\*SubscriptBox[\(k\), \(B\)]\)T/m\>\""}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLabel", "->", "\"\<Strong ME Phase Space\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9500466700708303`*^9, 3.950046771600979*^9}, {
  3.950606210277678*^9, 3.9506062547472687`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"c13e62f2-66b5-4831-85cf-78b22c183fee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wmPlots", "[", "WMstates_", "]"}], ":=", 
  RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{"WMstates", ",", "34"}], " ", "]"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"FrameTicks", "->", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{
               RowBox[{"gammas", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "gammas", "]"}], ",", "5"}], "}"}]}], 
          "]"}], ",", "None"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"ScientificForm", "[", 
              RowBox[{
               RowBox[{"bathTemps", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}]}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "bathTemps", "]"}], ",", "5"}], "}"}]}], 
          "]"}], ",", "None"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ColorRules", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.6745098039215687, 0.8980392156862745, 0.9333333333333333]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"0", "->", 
        TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"1", "->", 
        TemplateBox[<|
         "color" -> RGBColor[1., 0.6274509803921569, 0.5372549019607843]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"0.5", "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
         "RGBColorSwatchTemplate"]}], ",", 
       RowBox[{"2", "->", 
        TemplateBox[<|
         "color" -> RGBColor[
           0.615686274509804, 0.5058823529411764, 0.7294117647058823]|>,
         "RGBColorSwatchTemplate"]}]}], 
      RowBox[{"(*", 
       TemplateBox[<|
        "color" -> RGBColor[
          0.6352941176470588, 0.6352941176470588, 0.8156862745098039]|>,
        "RGBColorSwatchTemplate"], "*)"}], "}"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "->", "\[IndentingNewLine]", 
     RowBox[{"SwatchLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TemplateBox[<|
          "color" -> RGBColor[1., 0.6274509803921569, 0.5372549019607843]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[
            0.6745098039215687, 0.8980392156862745, 0.9333333333333333]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[
            0.615686274509804, 0.5058823529411764, 0.7294117647058823]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|
          "color" -> RGBColor[
            0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
          "RGBColorSwatchTemplate"]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\"\<Direct ME\>\"", ",", "\"\<Inverse ME\>\"", 
         ",", "\"\<No ME\>\"", ",", "\"\<DME & IME\>\"", 
         ",", "\"\<Error\>\""}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"LegendMarkerSize", "->", "15"}], ",", "\[IndentingNewLine]", 
       RowBox[{"LegendLayout", "->", "\"\<Column\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<\[Gamma]\>\"", 
       ",", "\"\<\!\(\*SubscriptBox[\(k\), \(B\)]\)T/m\>\""}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLabel", "->", "\"\<Weak ME Phase Space\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9500467750046377`*^9, 3.950046787802302*^9}, {
  3.9500468182909937`*^9, 3.9500468362132187`*^9}, {3.950054389393147*^9, 
  3.950054389927209*^9}, {3.9506062421809883`*^9, 3.950606250133869*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"bbfd5e5c-4b1a-49ca-a78d-6f68930f8aab"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"MEplots", "[", 
    RowBox[{"MEstates_", ",", 
     RowBox[{"type_", ":", "\"\<Strong\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"colors", ",", "plot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"type", " ", "===", "\"\<Strong\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"colors", "=", 
         RowBox[{"{", 
          RowBox[{
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.9921568627450981, 0.48627450980392156`, 0.43137254901960786`]|>,
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.5019607843137255, 0.8549019607843137, 0.9215686274509803]|>,
            "RGBColorSwatchTemplate"], ",", 
           TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.45098039215686275`, 0.4, 0.7411764705882353]|>,
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
            "RGBColorSwatchTemplate"]}], "}"}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"colors", "=", 
         RowBox[{"{", 
          RowBox[{
           
           TemplateBox[<|
            "color" -> RGBColor[1., 0.6274509803921569, 0.5372549019607843]|>,
            
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.6745098039215687, 0.8980392156862745, 0.9333333333333333]|>,
            "RGBColorSwatchTemplate"], ",", 
           TemplateBox[<|"color" -> RGBColor[1., 1., 1.]|>,
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.615686274509804, 0.5058823529411764, 0.7294117647058823]|>,
            "RGBColorSwatchTemplate"], ",", 
           
           TemplateBox[<|
            "color" -> RGBColor[
              0.9254901960784314, 0.9176470588235294, 0.7450980392156863]|>,
            "RGBColorSwatchTemplate"]}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"MEstates", ",", "34"}], " ", 
          RowBox[{"(*", 
           RowBox[{"Length", "@", "gammas"}], "*)"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "->", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"gammas", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "gammas", "]"}], ",", "5"}], "}"}]}],
                "]"}], ",", "None"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"ScientificForm", "[", 
                   RowBox[{
                    RowBox[{"bathTemps", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"Length", "[", "bathTemps", "]"}], ",", "5"}], 
                 "}"}]}], "]"}], ",", "None"}], "}"}]}], 
           "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorRules", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "->", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "->", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"0", "->", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", ",", 
            RowBox[{"0.5", "->", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], ",", 
            RowBox[{"2", "->", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"PlotLegends", "->", "\[IndentingNewLine]", 
          RowBox[{"SwatchLegend", "[", 
           RowBox[{"colors", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             
             RowBox[{"\"\<Direct ME\>\"", ",", "\"\<Inverse ME\>\"", 
              ",", "\"\<No ME\>\"", ",", "\"\<DME & IME\>\"", 
              ",", "\"\<Not Checked it yet\>\""}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LegendMarkerSize", "->", "15"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LegendLayout", "->", "\"\<Column\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           
           RowBox[{"\"\<\[Gamma]\>\"", 
            ",", "\"\<\!\(\*SubscriptBox[\(k\), \(B\)]\)T/m\>\""}], "}"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "->", 
          RowBox[{"type", "<>", "\"\< ME Phase Space\>\""}]}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.950043263161426*^9, 3.950043325981654*^9}, {
   3.950043486951786*^9, 3.950043502730764*^9}, {3.950043609570236*^9, 
   3.950043710572798*^9}, {3.9500437530500193`*^9, 3.950043809019865*^9}, {
   3.950044019647345*^9, 3.9500440712163877`*^9}, {3.9500460545310507`*^9, 
   3.950046093254278*^9}, {3.950046168071248*^9, 3.9500461858565493`*^9}, {
   3.95004625638343*^9, 3.950046283529361*^9}, 3.9500463996433*^9, {
   3.950046503278286*^9, 3.950046511355567*^9}, 3.9500472111382017`*^9},
 CellLabel->
  "In[153]:=",ExpressionUUID->"0d88eeca-9a79-477d-85be-837b81ac15b4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Graphics Grid", "Subsubsection",
 CellChangeTimes->{{3.948465117285396*^9, 3.9484651218067827`*^9}, {
  3.948465215307488*^9, 
  3.948465221959799*^9}},ExpressionUUID->"6858b706-db17-4b23-b969-\
86666657f48e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generatePlotsGrid", "[", 
   RowBox[{"cp_", ",", 
    RowBox[{"type_", ":", "\"\<FP\>\""}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"type", "===", "\"\<FP\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"generatePlotsGrid", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"checkpoint2Eig", "[", "cp", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"cp", "[", 
         RowBox[{"[", "\"\<cn\>\"", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        "johnsCoeff", ",", "\"\<Second\>\"", ",", "4", ",", "\"\<FP\>\"", ",", 
        RowBox[{"cp", "[", 
         RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"generatePlotsGrid", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"checkpoint2LeftEig", "[", "cp", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"cp", "[", 
         RowBox[{"[", "\"\<cn\>\"", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        "johnsCoeff", ",", "\"\<Second\>\"", ",", "4", ",", "\"\<AFP\>\"", ",", 
        RowBox[{"cp", "[", 
         RowBox[{"[", "\"\<BathT\>\"", "]"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.953116129405547*^9, 3.953116158471613*^9}, {
  3.9531162622143593`*^9, 3.953116363481208*^9}, {3.953116482464768*^9, 
  3.953116506499426*^9}, {3.953116654529171*^9, 3.953116748778458*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"b18cf67a-9ca1-490c-90b3-c5971f07769a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generatePlotsGrid", "[", 
   RowBox[{"psi_", ",", "cn_", ",", "johnsCoeff_", ",", 
    RowBox[{"name_", ":", "\"\<Second\>\""}], ",", 
    RowBox[{"bound_", ":", "3"}], ",", 
    RowBox[{"type_", ":", "\"\<FP\>\""}], ",", "theta_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "p3", ",", "pc", ",", "pm", ",", "pfpc", ",", "pfp", ",", "label"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p3", "=", 
      RowBox[{"Plot3D", "[", 
       RowBox[{"psi", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", 
          RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
        RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pc", "=", 
      RowBox[{"ContourPlot", "[", 
       RowBox[{"psi", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", 
          RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
        RowBox[{"GridLines", "->", "Automatic"}], ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
        RowBox[{"Contours", "->", "15"}], ",", 
        RowBox[{"PlotLabel", "->", 
         RowBox[{"name", "<>", "\"\< Eigenfunction\>\""}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"type", "==", "\"\<FP\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pfp", "=", 
         RowBox[{"fokkerPlanck", "[", 
          RowBox[{"psi", ",", "johnsCoeff"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"label", "=", "\"\<Apply Kramer's operator\>\""}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pm", "=", 
         RowBox[{"MatrixPlot", "[", 
          RowBox[{"cn", ",", 
           RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
           RowBox[{
           "PlotLabel", "->", "\"\<Right Eigenfunction Coefficients\>\""}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pm", "=", 
         RowBox[{"ContourPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"wst", "[", 
             RowBox[{"theta", ",", "johnsCoeff"}], "]"}], " ", "psi"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v", ",", 
             RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
           RowBox[{"GridLines", "->", "Automatic"}], ",", 
           RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", " ", 
           RowBox[{"Contours", "->", "20"}], ",", 
           RowBox[{"PlotLabel", "->", "\"\<Integrand of a2\>\""}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"pfp", "=", 
         RowBox[{"adjointFokkerPlanck", "[", 
          RowBox[{"psi", ",", "johnsCoeff"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"label", "=", "\"\<Apply Adjoint Kramer's operator\>\""}]}]}],
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pfpc", "=", 
      RowBox[{"ContourPlot", "[", 
       RowBox[{"pfp", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", 
          RowBox[{"-", "bound"}], ",", "bound"}], "}"}], ",", 
        RowBox[{"GridLines", "->", "Automatic"}], ",", 
        RowBox[{"Contours", "->", "15"}], ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"PlotLabel", "->", "label"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"p3", ",", "pc", ",", "pm", ",", "pfpc"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9484652274199553`*^9, 3.9484652282028313`*^9}, 
   3.948614038627116*^9, 3.9531165306662283`*^9},
 CellLabel->
  "In[155]:=",ExpressionUUID->"70801402-dd40-4066-8871-939eea576b03"]
}, Closed]],

Cell[CellGroupData[{

Cell["Get eigenfunction from cn", "Subsubsection",
 CellChangeTimes->{{3.9489194120315866`*^9, 3.9489194199149313`*^9}, {
  3.951654871507781*^9, 
  3.951654871773752*^9}},ExpressionUUID->"055b5b06-41ce-42f3-9ea1-\
b07ca801af20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkpoint2Eig", "[", "checkpoint_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cn", ",", " ", "c", ",", "Coefficients", ",", "johnsCoeff", ",", "PhiX",
       ",", "theta", ",", "alpha", ",", "psi", ",", "Q", ",", "P", ",", 
      "\[IndentingNewLine]", "normalization", ",", " ", "velocityPart", ",", 
      "positionPart", ",", "summationPart"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cn", "=", 
      RowBox[{"checkpoint", "[", 
       RowBox[{"[", "\"\<cn\>\"", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"johnsCoeff", "=", 
      RowBox[{"checkpoint", "[", 
       RowBox[{"[", "\"\<coeff\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"alpha", "=", 
      RowBox[{"checkpoint", "[", 
       RowBox[{"[", "\"\<alpha\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"theta", "=", 
      RowBox[{"checkpoint", "[", 
       RowBox[{"[", "\"\<theta\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", "n_", "]"}], " ", ":=", " ", 
      RowBox[{"cn", "[", 
       RowBox[{"[", 
        RowBox[{"n", " ", "+", " ", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"cn", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"P", "=", 
      RowBox[{
       RowBox[{"Length", "[", "cn", "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PhiX", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"i", ",", " ", 
          RowBox[{"alpha", "  ", "x"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "0", ",", " ", "Q"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"normalization", " ", "=", " ", 
      RowBox[{"N", "[", 
       RowBox[{"positionPrefactor", "[", 
        RowBox[{"theta", ",", " ", "johnsCoeff"}], "]"}], "]"}]}], ";", 
     RowBox[{"velocityPart", " ", "=", " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"alpha", " ", "/", "theta"}], " ", ")"}], 
        RowBox[{"1", "/", "2"}]], " ", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"v", "/", 
          SqrtBox["theta"]}]}], "]"}]}]}], ";", 
     RowBox[{"positionPart", " ", "=", " ", 
      RowBox[{
       SqrtBox["normalization"], " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Potential", "[", 
            RowBox[{"x", ",", " ", "johnsCoeff"}], "]"}]}], "/", "2"}], "/", 
         "theta"}], "]"}]}]}], ";", 
     RowBox[{"summationPart", " ", "=", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "n", "]"}], " ", ".", " ", "PhiX"}], " ", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"n", ",", " ", 
           RowBox[{"v", "/", 
            SqrtBox["theta"]}]}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "0", ",", " ", "P"}], "}"}]}], "]"}]}], ";", 
     "\n", "  ", 
     RowBox[{"psi", " ", "=", " ", 
      RowBox[{
      "positionPart", " ", "*", " ", "velocityPart", " ", "*", " ", 
       "summationPart"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.948919424269731*^9, 3.948919638948173*^9}, {
  3.948919691499483*^9, 3.94891971110326*^9}, {3.948919834800766*^9, 
  3.948919859891904*^9}, {3.948926213221202*^9, 3.9489262161627007`*^9}, {
  3.949068842573731*^9, 3.949068894066224*^9}, {3.9490689602551107`*^9, 
  3.949068964395159*^9}, {3.9544001432514973`*^9, 3.9544001687773542`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"f0216daa-c746-49fd-bb46-9f67f4bfcc44"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.954400201375228*^9},
 CellLabel->
  "In[157]:=",ExpressionUUID->"886a97c8-46de-489a-b081-3a4dff20acf4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkpoint2LeftEig", "[", 
   RowBox[{"checkpoint_", ",", 
    RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "EigenfunctionR", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EigenfunctionR", "=", 
      RowBox[{"checkpoint2Eig", "[", "checkpoint", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"leftEigenfunction", "[", 
      RowBox[{"EigenfunctionR", ",", " ", "johnsCoeff", ",", " ", 
       RowBox[{"checkpoint", "[", 
        RowBox[{"[", "\"\<theta\>\"", "]"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9516548810742693`*^9, 3.951654951780521*^9}, {
  3.951655016329235*^9, 3.951655043177388*^9}, {3.954400399439876*^9, 
  3.954400400022381*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"0088a4a6-b716-43c4-ad99-d5900b60b03f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot Overlaps", "Subsubsection",
 CellChangeTimes->{{3.9484652933662453`*^9, 
  3.9484652957807093`*^9}},ExpressionUUID->"b56b3974-6db4-4562-a31e-\
b6df241879fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotOverlaps", "[", 
   RowBox[{"checkpoint_", ",", " ", 
    RowBox[{"number_", " ", ":", " ", "1"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\n", "  ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "overlaps", ",", "fullPlot", ",", " ", "zoomedPlot", ",", "zoomedPlot2", 
      ",", " ", "labels", ",", " ", "midIndex", ",", "x", ",", "y"}], "}"}], ",",
     "\n", "  ", 
    RowBox[{
     RowBox[{"labels", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<Second \>\"", ",", " ", "\"\<Third \>\"", ",", 
        " ", "\"\<Fourth \>\"", ",", " ", "\"\<Fifth \>\""}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"overlaps", "=", 
      RowBox[{"checkpoint", "[", 
       RowBox[{"[", "\"\<overlaps\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fullPlot", " ", "=", " ", 
      RowBox[{"ListLinePlot", "[", "\n", "   ", 
       RowBox[{"overlaps", ",", "\n", "    ", 
        RowBox[{"PlotRange", "->", "All"}], ",", "\n", "    ", 
        RowBox[{"PlotLabel", " ", "->", " ", 
         RowBox[{"\"\<Overlap with \>\"", " ", "<>", " ", 
          RowBox[{"labels", "[", 
           RowBox[{"[", "number", "]"}], "]"}], " ", "<>", 
          " ", "\"\< Eigenfunction \>\""}]}], ",", "\n", "    ", 
        RowBox[{"AxesLabel", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<T \>\"", ",", " ", "\"\<a2 \>\""}], "}"}]}], ",", "\n",
         "    ", 
        RowBox[{"GridLines", " ", "->", " ", "Automatic"}]}], "]"}]}], ";", 
     "\n", "  ", "\[IndentingNewLine]", "\n", "  ", 
     RowBox[{"midIndex", " ", "=", " ", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"overlaps", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], 
         RowBox[{"2", "/", "3"}]}], ",", " ", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"overlaps", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "midIndex"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"y", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "midIndex"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\n", "  ", 
     RowBox[{"zoomedPlot", " ", "=", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
          RowBox[{"overlaps", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "\n", 
        RowBox[{"(*", "    ", 
         RowBox[{
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "midIndex", "]"}], "]"}], "*", "1.2"}]}], "}"}],
              ",", " ", "Automatic"}], "}"}]}], ","}], "*)"}], "\n", "    ", 
        RowBox[{
        "PlotLabel", " ", "->", 
         " ", "\"\<Zoomed in at small Temperatures \>\""}], ",", "\n", "    ", 
        RowBox[{"AxesLabel", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<T \>\"", ",", " ", 
           RowBox[{"\"\<a \>\"", " ", "<>", " ", 
            RowBox[{"ToString", "[", "number", "]"}]}]}], "}"}]}], ",", "\n", 
        "    ", 
        RowBox[{"GridLines", " ", "->", " ", "Automatic"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"overlaps", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"y", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\n", "  ", 
     RowBox[{"zoomedPlot2", "=", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
          RowBox[{"overlaps", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "\n", 
        RowBox[{"(*", "    ", 
         RowBox[{
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "midIndex", "]"}], "]"}], "*", "1.2"}]}], "}"}],
              ",", " ", "Automatic"}], "}"}]}], ","}], "*)"}], "\n", "    ", 
        RowBox[{
        "PlotLabel", " ", "->", 
         " ", "\"\<Zoomed in at small Temperatures \>\""}], ",", "\n", "    ", 
        RowBox[{"AxesLabel", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<T \>\"", ",", " ", 
           RowBox[{"\"\<a \>\"", " ", "<>", " ", 
            RowBox[{"ToString", "[", "number", "]"}]}]}], "}"}]}], ",", "\n", 
        "    ", 
        RowBox[{"GridLines", " ", "->", " ", "Automatic"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"fullPlot", ",", " ", "zoomedPlot", ",", "zoomedPlot2"}], 
      "}"}]}]}], "\n", "  ", "]"}]}]], "Input",
 CellChangeTimes->{{3.9510833118096237`*^9, 3.951083316647937*^9}, {
   3.951083362279417*^9, 3.951083384756569*^9}, {3.951083419933729*^9, 
   3.9510834560736113`*^9}, {3.951083508251157*^9, 3.951083661136285*^9}, {
   3.951083696720593*^9, 3.9510837012178917`*^9}, 3.953155903621839*^9, {
   3.953155949088789*^9, 3.953155994722951*^9}, {3.953156369881706*^9, 
   3.953156375352071*^9}, 3.953156614836299*^9, {3.9531959726930847`*^9, 
   3.953195975348051*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"e18050f7-4b3c-40c3-a133-96d25aa5644e"]
}, Closed]],

Cell[CellGroupData[{

Cell["plot Leig", "Subsubsection",
 CellChangeTimes->{{3.95315761622073*^9, 
  3.9531576199790773`*^9}},ExpressionUUID->"5b6e98e7-56ab-4d04-8588-\
71ff3611f58d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotleig", "[", "cp_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"leig", ",", "xbound", ",", "vbound", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"leig", "=", 
      RowBox[{"checkpoint2LeftEig", "[", "cp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"cp", "[", 
       RowBox[{"[", 
        RowBox[{"\"\<theta\>\"", \
"\"\<]];\[IndentingNewLine]xbound=1+Sqrt[temp];\[IndentingNewLine]vbound=\
7Sqrt[temp];\[IndentingNewLine]ContourPlot[leig,\[IndentingNewLine]{x,-xbound,\
xbound},\[IndentingNewLine]{v,-vbound,vbound},\[IndentingNewLine]Contours->20,\
\[IndentingNewLine]PlotLegends->Automatic]\[IndentingNewLine]]\>"}]}]}]}]}]}]}\
]}]], "Input",
 CellChangeTimes->{{3.953157621635706*^9, 3.953157837245796*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"a64aabc7-d176-4ec2-8dea-bc02c6d2a8ab"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimize Alpha", "Subsection",
 CellChangeTimes->{{3.948728267058735*^9, 3.948728271083993*^9}, {
  3.948729832631344*^9, 
  3.94872983329918*^9}},ExpressionUUID->"c18f6b7c-ccd7-4988-ba16-\
056a9c05ecd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"optimizeAlpha", "[", 
   RowBox[{"setup_", ",", 
    RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"alpha", ",", "alphas", ",", "det", ",", "fdet"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"fdet", "[", "alpha_", "]"}], " ", ":=", " ", 
      RowBox[{"determinant", "[", 
       RowBox[{"1", ",", " ", 
        RowBox[{"setup", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"setup", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
        RowBox[{"setup", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", "alpha", ",", " ", "johnsCoeff",
         ",", " ", 
        RowBox[{"setup", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"alphas", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0.4", ",", "6", ",", "0.15"}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "6.4", ",", "16", ",", "0.4"}], "}"}]}], "]"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"det", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"alpha", ",", " ", 
          RowBox[{"Log", "@", 
           RowBox[{"Abs", "@", 
            RowBox[{"fdet", "[", "alpha", "]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"{", 
         RowBox[{"alpha", ",", "alphas"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"alpha", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"det", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "==", 
              RowBox[{"Min", "[", 
               RowBox[{"det", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "prec"}], "]"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"alpha", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"det", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", 
           RowBox[{"Min", "[", 
            RowBox[{"det", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], "&"}]}], "]"}],
        "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.94872827409846*^9, 3.948728330325158*^9}, {
   3.948728363575491*^9, 3.948728722106009*^9}, {3.948729663214388*^9, 
   3.948729703592767*^9}, {3.948730100758259*^9, 3.9487301256543827`*^9}, {
   3.9487302376020527`*^9, 3.948730240149774*^9}, {3.948730282481385*^9, 
   3.9487303036300097`*^9}, {3.948894111460731*^9, 3.948894209111261*^9}, {
   3.94889434363207*^9, 3.948894344253717*^9}, {3.948895087722924*^9, 
   3.948895088679811*^9}, {3.948895187183976*^9, 3.94889518941508*^9}, 
   3.95148244078365*^9, 3.951501524802951*^9, 3.951520874473894*^9, 
   3.9515212753202143`*^9, {3.95235595951295*^9, 3.952355959831729*^9}, {
   3.952527377923379*^9, 3.952527384877729*^9}, {3.952598524521982*^9, 
   3.952598535428606*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"720a1c30-c974-417f-8acb-07716b32a410"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"optimizeAlpha", "[", 
    RowBox[{"setup_", ",", "johnsCoeff_", ",", 
     RowBox[{"workingPrecision_", ":", "30"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"alpha", ",", "alphas", ",", "det", ",", "fdet"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"setup", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
          "setup"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"johnsCoeff", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
          "johnsCoeff"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fdet", "[", "alpha_", "]"}], ":=", 
       RowBox[{"determinant", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SetPrecision", "[", 
          RowBox[{"1", ",", "workingPrecision"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"setup", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"setup", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"setup", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", "\[IndentingNewLine]", "alpha",
          ",", "\[IndentingNewLine]", "johnsCoeff", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"setup", "[", 
          RowBox[{"[", "5", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         "workingPrecision"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"alphas", "=", 
       RowBox[{"SetPrecision", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0.4", ",", "6", ",", "0.15"}], "}"}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "6.4", ",", "16", ",", "0.4"}], "}"}]}], 
            "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]",
          "workingPrecision"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"det", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"alpha", ",", 
           RowBox[{"Log", "@", 
            RowBox[{"Abs", "@", 
             RowBox[{"fdet", "[", "alpha", "]"}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"alpha", ",", "alphas"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"alpha", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"det", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "==", 
            RowBox[{"Min", "[", 
             RowBox[{"det", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.951482442486533*^9, 3.951482442490419*^9}, {
   3.951489684378934*^9, 3.95148976120271*^9}, {3.951501449763913*^9, 
   3.951501473743094*^9}, 3.951501528086508*^9, 3.9515208686479692`*^9, 
   3.951521278799905*^9},
 CellLabel->
  "In[161]:=",ExpressionUUID->"df1f743c-67d1-48b2-9b73-d8f5e180957b"]
}, Closed]],

Cell[CellGroupData[{

Cell["K Matrix", "Subsection",
 CellChangeTimes->{{3.948464892050411*^9, 3.948464895845833*^9}, {
  3.952598843110299*^9, 3.952598845430605*^9}, {3.953902630940425*^9, 
  3.953902631359208*^9}},ExpressionUUID->"72da9c91-0a17-485c-994d-\
d9bb38e9fccb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kMatrix", "[", 
   RowBox[{
   "s_", ",", " ", "gamma_", ",", " ", "Q_", ",", " ", "NN_", ",", " ", 
    "Dpq_", ",", " ", "Dbar_"}], "]"}], " ", ":=", "\n", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "K", "}"}], ",", "\[IndentingNewLine]", "\n", "   ", 
    RowBox[{
     RowBox[{"K", " ", "=", " ", 
      RowBox[{"Inverse", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Q", " ", "+", " ", "1"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"s", " ", "+", " ", 
          RowBox[{"gamma", "*", 
           RowBox[{"(", 
            RowBox[{"NN", " ", "+", " ", "1"}], ")"}]}]}], ")"}]}], "]"}]}], ";",
      "\n", " ", 
     RowBox[{"Quiet", "[", "  ", 
      RowBox[{"For", "[", "\n", "    ", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", "NN"}], ",", " ", 
        RowBox[{"n", " ", ">", " ", "0"}], ",", " ", 
        RowBox[{"n", "--"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"K", " ", "=", 
          RowBox[{"Inverse", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"s", " ", "+", " ", 
               RowBox[{"gamma", "*", "n"}]}], ")"}], "*", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"Q", " ", "+", " ", "1"}], "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", " ", "+", " ", "1"}], ")"}], "*", 
             RowBox[{"Dpq", " ", ".", " ", "K", " ", ".", " ", "Dbar"}]}]}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", "    ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<precision of K:  \>\"", ",", 
           RowBox[{"Precision", "[", "K", "]"}]}], "]"}], ";"}], "*)"}], "\n",
        "]"}], "]"}], ";", "\n", "   ", 
     RowBox[{"Dpq", " ", ".", " ", "K", " ", ".", " ", "Dbar"}]}]}], "\n", 
   "   ", "]"}]}]], "Input",
 CellChangeTimes->{{3.951482027020854*^9, 3.951482032524067*^9}, {
   3.951500411142706*^9, 3.95150041998298*^9}, {3.9515008076140747`*^9, 
   3.951500810557044*^9}, {3.9515208557273197`*^9, 3.951520863667984*^9}, {
   3.952526374858502*^9, 3.952526383390082*^9}, {3.952526815929715*^9, 
   3.952526820159827*^9}, {3.952528421277335*^9, 3.95252844544038*^9}, {
   3.952528503232273*^9, 3.9525285041289797`*^9}, {3.952529785697116*^9, 
   3.952529806614378*^9}, {3.9525985933985577`*^9, 3.952598601926795*^9}, {
   3.952598655420877*^9, 3.9525986572817097`*^9}, {3.9527303580192747`*^9, 
   3.952730376911578*^9}, {3.953898306058816*^9, 3.95389832155721*^9}, 
   3.9538983644098263`*^9, {3.9538986456554213`*^9, 3.953898653777892*^9}, {
   3.953899190244581*^9, 3.953899192428893*^9}, {3.953900715069077*^9, 
   3.953900718887663*^9}, {3.953902674833926*^9, 3.95390268907075*^9}, {
   3.953902726062921*^9, 3.953902727487706*^9}, {3.9543711369464493`*^9, 
   3.954371140813224*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"1acbc846-6247-409e-bf27-435cfc4065dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"matrixContinuedFraction", "[", 
   RowBox[{
   "s_", ",", "gamma_", ",", "Q_", ",", "NN_", ",", "Dpq_", ",", "Dbar_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"K", ",", "n", ",", "workingPrecision"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"workingPrecision", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"Precision", "[", "s", "]"}], ",", 
         RowBox[{"Precision", "[", "gamma", "]"}]}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"workingPrecision", "=", "20"}], ";", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"Inverse", "[", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"Q", "+", "1"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"s", "+", 
            RowBox[{"gamma", "*", 
             RowBox[{"(", 
              RowBox[{"NN", "+", "1"}], ")"}]}]}], ")"}]}], ",", 
         "workingPrecision"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"n", "=", "NN"}], ",", 
       RowBox[{"n", ">", "0"}], ",", 
       RowBox[{"n", "--"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K", "=", 
         RowBox[{"Inverse", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"s", "+", 
                RowBox[{"gamma", "*", "n"}]}], ")"}], "*", 
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"Q", "+", "1"}], "]"}]}], ",", "workingPrecision"}], 
            "]"}], "-", 
           RowBox[{
            RowBox[{"SetPrecision", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "+", "1"}], ")"}], ",", "workingPrecision"}], 
             "]"}], "*", 
            RowBox[{"Dpq", ".", "K", ".", "Dbar"}]}]}], "\[IndentingNewLine]",
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Dpq", ".", "K", ".", "Dbar"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.9547923961992817`*^9, {3.954792526752903*^9, 3.954792529924567*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"8067a5dc-3696-4baa-b2dc-5c8e69df295c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["D Matrices", "Subsection",
 CellChangeTimes->{{3.9484649140476427`*^9, 
  3.948464917062848*^9}},ExpressionUUID->"a531008a-1fe4-4fff-adaf-\
bc5d705e3c83"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "\[Alpha]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"maxDMatrix", ",", "maxDHatMatrix"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"workingDirectory", " ", "<>", " ", "\"\<Max200Ds\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxDHatMatrix", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "2"}], ",", 
     RowBox[{";;", "2"}]}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.955023073010988*^9, 3.9550231022797832`*^9}, 
   3.955023134436956*^9, {3.9550242006335087`*^9, 3.955024233548378*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"9de187fe-5489-41f6-915b-8f543abc3306"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["d1", 
        RowBox[{"2", " ", 
         SqrtBox["\[Theta]"]}]], "+", 
       FractionBox["d3", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Alpha]", "2"], " ", 
         SqrtBox["\[Theta]"]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"3", " ", "d4"}], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Alpha]", "3"], " ", 
         SqrtBox["\[Theta]"]}]], "+", 
       FractionBox["d2", 
        RowBox[{"2", " ", "\[Alpha]", " ", 
         SqrtBox["\[Theta]"]}]], "+", 
       FractionBox[
        RowBox[{"\[Alpha]", " ", 
         SqrtBox["\[Theta]"]}], "2"]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"3", " ", "d4"}], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Alpha]", "3"], " ", 
         SqrtBox["\[Theta]"]}]], "+", 
       FractionBox["d2", 
        RowBox[{"2", " ", "\[Alpha]", " ", 
         SqrtBox["\[Theta]"]}]], "-", 
       FractionBox[
        RowBox[{"\[Alpha]", " ", 
         SqrtBox["\[Theta]"]}], "2"]}], 
      RowBox[{
       FractionBox["d1", 
        RowBox[{"2", " ", 
         SqrtBox["\[Theta]"]}]], "+", 
       FractionBox[
        RowBox[{"3", " ", "d3"}], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Alpha]", "2"], " ", 
         SqrtBox["\[Theta]"]}]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.955024220194654*^9, 3.955024234260559*^9}},
 CellLabel->
  "Out[278]//MatrixForm=",ExpressionUUID->"892a9f89-b579-4805-b8e2-\
ab18d74ae583"]
}, Open  ]],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", " ", "Load"}]}]}]}]}]}]}]}]}]}], " ", "D"}], " ",
      "&"}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              OverscriptBox["D", "^"], " ", "--"}], "--"}], "--"}], "--"}], 
          "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "workingDirectory", 
     "=", "\"\</Users/gene/Desktop/CourseWork/Reasearch/notebooks/\>\""}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"workingDirectory", "=", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"maxDMatrix", ",", "maxDHatMatrix", ",", "\[Alpha]"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"workingDirectory", " ", "<>", " ", "\"\<Max200Ds\>\""}], "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "resizeDMatrices", "]"}], "=", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<alpha \>\"", " ", "->", " ", "\[Alpha]"}], ",", "\n", 
       "    ", 
       RowBox[{"\"\<d1 \>\"", " ", "->", " ", "d1"}], ",", "\n", "    ", 
       RowBox[{"\"\<d2 \>\"", " ", "->", " ", "d2"}], ",", "\n", "    ", 
       RowBox[{"\"\<d3 \>\"", " ", "->", " ", "d3"}], ",", "\n", "    ", 
       RowBox[{"\"\<d4 \>\"", " ", "->", " ", "d4"}], ",", "\n", "    ", 
       RowBox[{"\"\<theta \>\"", " ", "->", " ", "\[Theta]"}]}], "}"}]}], 
    ";"}], "\n", " ", "\n", " ", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"resizeDMatrices", "[", 
     RowBox[{"Q_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\n", "   ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"matrixD", ",", " ", "matrixDhat"}], "}"}], ",", "\n", "   ", 
      "\n", "   ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"!", " ", 
           RowBox[{"NumericQ", "[", "Q", "]"}]}], " ", "||", " ", 
          RowBox[{"!", " ", 
           RowBox[{"IntegerQ", "[", "Q", "]"}]}], " ", "||", " ", 
          RowBox[{"Q", " ", "<", " ", "0"}]}], ",", "\n", "    ", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InvalidArgument", "::", "NotPositiveInteger"}], ",", " ",
             "Q"}], "]"}], ";", "\n", "    ", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\n", "    ", "]"}], ";",
        "\n", "   ", "\n", "   ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Q", " ", ">", " ", "maxDegree"}], ",", "\n", "    ", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"InvalidArgument", "::", "ExceedMaxDegree"}], ",", " ", 
            "Q", ",", " ", "maxDegree"}], "]"}], ";", "\n", "    ", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\n", "    ", "]"}], ";",
        "\n", " ", "\n", "   ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Create", " ", "substitution", " ", "rules", "\n", "   ", "by", " ", 
         "Accessing", " ", "options", " ", "using", " ", "OptionValue"}], " ",
         "*)"}], "\n", "   ", 
       RowBox[{"substitutionRules", " ", "=", " ", 
        RowBox[{"{", "\n", "     ", 
         RowBox[{
          RowBox[{"\[Alpha]", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<alpha \>\"", "]"}]}], ",", "\n", 
          "     ", 
          RowBox[{"d1", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<d1 \>\"", "]"}]}], ",", "\n", 
          "     ", 
          RowBox[{"d2", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<d2 \>\"", "]"}]}], ",", "\n", 
          "     ", 
          RowBox[{"d3", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<d3 \>\"", "]"}]}], ",", "\n", 
          "     ", 
          RowBox[{"d4", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<d4 \>\"", "]"}]}], ",", "\n", 
          "     ", 
          RowBox[{"\[Theta]", " ", "->", " ", 
           RowBox[{"OptionValue", "[", "\"\<theta \>\"", "]"}]}]}], "\n", 
         "     ", "}"}]}], ";", "\n", "   ", "\n", "   ", 
       RowBox[{"(*", 
        RowBox[{
        "Resize", " ", "and", " ", "substitute", " ", "values", " ", "in", " ",
          "matrices"}], "*)"}], "\n", "   ", 
       RowBox[{"matrixD", " ", "=", " ", 
        RowBox[{
         RowBox[{"maxDMatrix", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", " ", ";;", " ", 
             RowBox[{"Q", " ", "+", " ", "1"}]}], ",", " ", 
            RowBox[{"1", " ", ";;", " ", 
             RowBox[{"Q", " ", "+", " ", "1"}]}]}], "]"}], "]"}], " ", "/.", 
         " ", "substitutionRules"}]}], ";", "\n", "   ", 
       RowBox[{"matrixDhat", " ", "=", " ", 
        RowBox[{
         RowBox[{"maxDHatMatrix", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", " ", ";;", " ", 
             RowBox[{"Q", " ", "+", " ", "1"}]}], ",", " ", 
            RowBox[{"1", " ", ";;", " ", 
             RowBox[{"Q", " ", "+", " ", "1"}]}]}], "]"}], "]"}], " ", "/.", 
         " ", "substitutionRules"}]}], ";", "\n", "   ", "\n", "   ", 
       RowBox[{"(*", 
        RowBox[{"Return", " ", "both", " ", "matrices"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"matrixD", ",", "matrixDhat"}], "}"}]}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "   ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SetPrecision", "[", 
         RowBox[{"matrixD", ",", "prec"}], "]"}], ",", " ", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"matrixDhat", ",", "prec"}], "]"}]}], "}"}], "*)"}], "\n", 
     "   ", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.948464939285862*^9, 3.948464967721498*^9}, {
   3.948469325626954*^9, 3.948469366662715*^9}, {3.948469461927013*^9, 
   3.948469514120126*^9}, 3.948554648468587*^9, {3.949258530835745*^9, 
   3.9492585484241133`*^9}, {3.951482090294355*^9, 3.9514821281589403`*^9}, {
   3.9514824098952217`*^9, 3.951482426863723*^9}, 3.951520851455957*^9, {
   3.9525268764437723`*^9, 3.952526893245474*^9}, {3.9525988580938253`*^9, 
   3.952598877539682*^9}, {3.9550229773440847`*^9, 3.955023001650486*^9}, {
   3.9550242475601177`*^9, 
   3.955024249313274*^9}},ExpressionUUID->"082266ed-2d80-4a26-bf2b-\
4c6eda139d45"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"resizeDMatrices", "[", 
    RowBox[{"Q_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "matrixD", ",", "matrixDhat", ",", "substitutionRules", ",", "alpha", ",",
        "d1", ",", "d2", ",", "d3", ",", "d4", ",", "theta", ",", 
       "workingPrecision"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"NumericQ", "[", "Q", "]"}]}], "||", 
         RowBox[{"!", 
          RowBox[{"IntegerQ", "[", "Q", "]"}]}], "||", 
         RowBox[{"Q", "<", "0"}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"InvalidArgument", "::", "NotPositiveInteger"}], ",", 
           "Q"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Q", ">", "maxDegree"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"InvalidArgument", "::", "ExceedMaxDegree"}], ",", "Q", ",",
            "maxDegree"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Get", " ", "option", " ", "values"}], "*)"}], 
      RowBox[{"alpha", "=", 
       RowBox[{"OptionValue", "[", "\"\<alpha \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d1", "=", 
       RowBox[{"OptionValue", "[", "\"\<d1 \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d2", "=", 
       RowBox[{"OptionValue", "[", "\"\<d2 \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d3", "=", 
       RowBox[{"OptionValue", "[", "\"\<d3 \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d4", "=", 
       RowBox[{"OptionValue", "[", "\"\<d4 \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"OptionValue", "[", "\"\<theta \>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Determine", " ", "working", " ", "precision", " ", "from", " ", "the",
         " ", "inputs"}], "*)"}], 
      RowBox[{"workingPrecision", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "alpha", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "alpha", "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "d1", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "d1", "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "d2", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "d2", "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "d3", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "d3", "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "d4", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "d4", "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Precision", "[", "theta", "]"}], "===", 
            "MachinePrecision"}], ",", "$MachinePrecision", ",", 
           RowBox[{"Precision", "[", "theta", "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Create", " ", "substitution", " ", "rules"}], "*)"}], 
      RowBox[{"substitutionRules", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Alpha]", "->", "alpha"}], ",", 
         RowBox[{"d1", "->", "d1"}], ",", 
         RowBox[{"d2", "->", "d2"}], ",", 
         RowBox[{"d3", "->", "d3"}], ",", 
         RowBox[{"d4", "->", "d4"}], ",", 
         RowBox[{"\[Theta]", "->", "theta"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Resize", " ", "and", " ", "substitute", " ", "values", " ", "in", " ",
         "matrices"}], "*)"}], 
      RowBox[{"matrixD", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"maxDMatrix", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", 
              RowBox[{"Q", "+", "1"}]}], ",", 
             RowBox[{"1", ";;", 
              RowBox[{"Q", "+", "1"}]}]}], "]"}], "]"}], "/.", " ", 
          "substitutionRules"}], ",", "workingPrecision"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"matrixDhat", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"maxDHatMatrix", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", 
              RowBox[{"Q", "+", "1"}]}], ",", 
             RowBox[{"1", ";;", 
              RowBox[{"Q", "+", "1"}]}]}], "]"}], "]"}], "/.", " ", 
          "substitutionRules"}], ",", "workingPrecision"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Return", " ", "both", " ", "matrices"}], "*)"}], 
      RowBox[{"{", 
       RowBox[{"matrixD", ",", "matrixDhat"}], "}"}]}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.951482420196885*^9, 3.951482420200247*^9}, 
   3.951520849530116*^9},
 CellLabel->
  "In[168]:=",ExpressionUUID->"d1c20dd7-c6a5-4122-95bd-2617eb62e504"],

Cell[CellGroupData[{

Cell["Original Double Well Matrices", "Subsubsection",
 CellChangeTimes->{{3.9484651698505793`*^9, 
  3.948465177062578*^9}},ExpressionUUID->"9076a0aa-c5a3-4e57-8fff-\
d5f0cdce68a4"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"calcMatrixElements", "[", 
    RowBox[{
    "Q_", ",", " ", "alpha_", ",", " ", "d2_", ",", " ", "d4_", ",", " ", 
     RowBox[{"theta_", " ", ":", " ", "0.25"}]}], "]"}], " ", ":=", "\n", 
   "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Dpq", ",", " ", "Dbar", ",", " ", "sign", ",", " ", "qval", ",", " ", 
       "factor", ",", " ", "p", ",", " ", "q"}], "}"}], ",", "\n", "   ", 
     RowBox[{
      RowBox[{"Dpq", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Q", " ", "+", " ", "1"}], ",", " ", 
           RowBox[{"Q", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "   ", 
      RowBox[{"Dbar", " ", "=", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Q", " ", "+", " ", "1"}], ",", " ", 
           RowBox[{"Q", " ", "+", " ", "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "   ", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"p", " ", "=", " ", "0"}], ",", " ", 
        RowBox[{"p", " ", "<=", " ", "Q"}], ",", " ", 
        RowBox[{"p", "++"}], ",", "\n", "    ", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"q", " ", "=", " ", "0"}], ",", " ", 
           RowBox[{"q", " ", "<=", " ", "Q"}], ",", " ", 
           RowBox[{"q", "++"}], ",", "\n", "      ", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"p", " ", "-", " ", "q"}], "]"}], " ", "==", " ", 
               "1"}], ",", "\n", "       ", 
              RowBox[{
               RowBox[{"sign", " ", "=", " ", 
                RowBox[{"Sign", "[", 
                 RowBox[{"q", " ", "-", " ", "p"}], "]"}]}], ";", "\n", 
               "       ", 
               RowBox[{"qval", " ", "=", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{"p", ",", " ", "q"}], "]"}]}], ";", "\n", "       ", 
               
               RowBox[{
                RowBox[{"Dpq", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"p", " ", "+", " ", "1"}], ",", " ", 
                   RowBox[{"q", " ", "+", " ", "1"}]}], "]"}], "]"}], "  ", "=",
                 " ", 
                RowBox[{
                 RowBox[{"Sqrt", "[", "qval", "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"sign", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "/", "2"}]}], " ", "-", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"3", "*", "d4", "*", "qval"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "^", "3"}]}], ")"}]}], " ", "-", " ", 
                   RowBox[{"d2", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", "alpha"}], ")"}]}]}], ")"}]}]}], ";",
                "\n", "       ", 
               RowBox[{
                RowBox[{"Dbar", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"p", " ", "+", " ", "1"}], ",", " ", 
                   RowBox[{"q", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "=",
                 " ", 
                RowBox[{
                 RowBox[{"Sqrt", "[", "qval", "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"sign", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "/", "2"}]}], " ", "+", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"3", "*", "d4", "*", "qval"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "^", "3"}]}], ")"}]}], " ", "+", " ", 
                   RowBox[{"d2", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", "alpha"}], ")"}]}]}], ")"}]}]}], 
               ";"}]}], "\n", "       ", "]"}], ";", "\n", "      ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"p", " ", "-", " ", "q"}], "]"}], " ", "==", " ", 
               "3"}], ",", "\n", "       ", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"p", " ", ">", " ", "q"}], ",", "\n", "        ", 
                 RowBox[{"factor", " ", "=", " ", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"p", "*", 
                    RowBox[{"(", 
                    RowBox[{"p", " ", "-", " ", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"p", " ", "-", " ", "2"}], ")"}]}], "]"}], "*", 
                   RowBox[{"d4", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "^", "3"}]}], ")"}]}]}]}], ",", "\n", 
                 "        ", 
                 RowBox[{"factor", " ", "=", " ", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", 
                    RowBox[{"q", "*", 
                    RowBox[{"(", 
                    RowBox[{"q", " ", "-", " ", "1"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"q", " ", "-", " ", "2"}], ")"}]}], "]"}], "*", 
                   RowBox[{"d4", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", 
                    SqrtBox["theta"], "*", 
                    RowBox[{"alpha", "^", "3"}]}], ")"}]}]}]}]}], "]"}], ";", 
               "\n", "       ", 
               RowBox[{
                RowBox[{"Dpq", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"p", " ", "+", " ", "1"}], ",", " ", 
                   RowBox[{"q", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "=",
                 " ", 
                RowBox[{"-", "factor"}]}], ";", "\n", "       ", 
               RowBox[{
                RowBox[{"Dbar", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"p", " ", "+", " ", "1"}], ",", " ", 
                   RowBox[{"q", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "=",
                 " ", "factor"}], ";"}]}], "]"}], ";"}]}], "]"}], ";"}]}], 
       "]"}], ";", "\n", "   ", 
      RowBox[{"{", 
       RowBox[{"Dpq", ",", " ", "Dbar"}], "}"}]}]}], "]"}]}]}]], "Input",
 CellLabel->
  "In[169]:=",ExpressionUUID->"599e526c-26cd-468a-9c16-4b3cb286875a"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Determinant", "Subsection",
 CellChangeTimes->{{3.948464775120963*^9, 3.948464921200511*^9}, 
   3.948464970690818*^9, {3.9484650042323008`*^9, 
   3.948465043254431*^9}},ExpressionUUID->"60f16c4a-cdc8-45f7-bd3d-\
dce4652bcfa4"],

Cell[BoxData[
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"determinant", "[", 
    RowBox[{
    "lambda_", ",", " ", "gamma_", ",", " ", "Q_", ",", " ", "N_", ",", " ", 
     "alpha_", ",", "\n", "   ", "johnsCoeff_", ",", " ", 
     RowBox[{"theta_", " ", ":", " ", "0.25"}]}], "]"}], " ", ":=", "\n", 
   "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Dpq", ",", " ", "Dbar", ",", " ", "K0", ",", " ", "s", ",", " ", "d1", 
       ",", " ", "d2", ",", " ", "d3", ",", " ", "d4"}], "}"}], ",", "\n", 
     "   ", 
     RowBox[{"(*", 
      RowBox[{"SetPrecision", "["}], "*)"}], "\n", "   ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d1", ",", " ", "d2", ",", " ", "d3", ",", " ", "d4"}], "}"}],
        " ", "=", " ", "johnsCoeff"}], ";", "\n", "   ", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"-", "lambda"}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dpq", ",", " ", "Dbar"}], "}"}], " ", "=", "\n", "    ", 
       RowBox[{"resizeDMatrices", "[", 
        RowBox[{"Q", ",", "\n", "     ", 
         RowBox[{"\"\<alpha \>\"", " ", "->", " ", "alpha"}], ",", "\n", 
         "     ", 
         RowBox[{"\"\<d1 \>\"", " ", "->", " ", "d1"}], ",", "\n", "     ", 
         RowBox[{"\"\<d2 \>\"", " ", "->", " ", "d2"}], ",", "\n", "     ", 
         RowBox[{"\"\<d3 \>\"", " ", "->", " ", "d3"}], ",", "\n", "     ", 
         RowBox[{"\"\<d4 \>\"", " ", "->", " ", "d4"}], ",", "\n", "     ", 
         RowBox[{"\"\<theta \>\"", " ", "->", " ", "theta"}]}], "\n", "     ",
         "]"}]}], ";", "\n", "   ", 
      RowBox[{"K0", " ", "=", " ", 
       RowBox[{"kMatrix", "[", 
        RowBox[{
        "s", ",", " ", "gamma", ",", " ", "Q", ",", " ", "N", ",", " ", "Dpq",
          ",", " ", "Dbar"}], "]"}]}], ";", "\n", 
      RowBox[{"(*", "   ", 
       RowBox[{"Det", "[", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lambda", "*", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"Q", " ", "+", " ", "1"}], "]"}]}], " ", "+", " ", 
           "K0"}], ",", " ", "30"}], "]"}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Det", "[", 
       RowBox[{
        RowBox[{"lambda", "*", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Q", " ", "+", " ", "1"}], "]"}]}], " ", "+", " ", "K0"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9484650703144073`*^9, 3.948465070748124*^9}, 
   3.9514813993457212`*^9, 3.951520832578903*^9, {3.952523236567267*^9, 
   3.952523237043167*^9}, {3.952598895278989*^9, 3.9525989393906097`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"c8379d4f-5c71-42bf-b5ad-48f7182ad0b4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"determinant", "[", 
    RowBox[{
    "lambda_", ",", "gamma_", ",", "Q_", ",", "N_", ",", "alpha_", ",", 
     "johnsCoeff_", ",", "theta_", ",", 
     RowBox[{"workingPrecision_", ":", "30"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Dpq", ",", "Dbar", ",", "K0", ",", "s", ",", "d1", ",", "d2", ",", 
       "d3", ",", "d4"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d1", ",", "d2", ",", "d3", ",", "d4"}], "}"}], "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SetPrecision", "[", 
           RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
         "johnsCoeff"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"-", "lambda"}], ",", "workingPrecision"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dpq", ",", "Dbar"}], "}"}], "=", 
       RowBox[{"resizeDMatrices", "[", "\[IndentingNewLine]", 
        RowBox[{"Q", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<alpha \>\"", "->", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{"alpha", ",", "workingPrecision"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<d1 \>\"", "->", "d1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<d2 \>\"", "->", "d2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<d3 \>\"", "->", "d3"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<d4 \>\"", "->", "d4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<theta \>\"", "->", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{"theta", ",", "workingPrecision"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"K0", "=", 
         RowBox[{"kMatrix", "[", 
          RowBox[{"s", ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{"gamma", ",", "workingPrecision"}], "]"}], ",", "Q", ",", 
           "N", ",", "Dpq", ",", "Dbar"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"K0", "=", 
       RowBox[{"kMatrix", "[", 
        RowBox[{
        "s", ",", "gamma", ",", "Q", ",", "N", ",", "Dpq", ",", "Dbar"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Det", "[", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lambda", "*", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"Q", "+", "1"}], "]"}]}], "+", "K0"}], ",", 
          "workingPrecision"}], "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Det", "[", 
       RowBox[{
        RowBox[{"lambda", "*", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Q", "+", "1"}], "]"}]}], "+", "K0"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.951481396105362*^9, 3.951481402682572*^9}, {
   3.951490018333055*^9, 3.951490062733079*^9}, {3.951500834340151*^9, 
   3.951500839783347*^9}, {3.9515012603511257`*^9, 3.951501267771514*^9}, {
   3.951501577670847*^9, 3.9515015782645187`*^9}, 3.951520836397344*^9},
 CellLabel->
  "In[171]:=",ExpressionUUID->"f17955f2-34e6-4968-a092-703f98899044"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get Root", "Subsection",
 CellChangeTimes->{{3.948465325492427*^9, 
  3.948465328236207*^9}},ExpressionUUID->"23e736b2-e322-4f7b-8611-\
2594bea1c9e1"],

Cell[CellGroupData[{

Cell["Packaged version", "Subsubsection",
 CellChangeTimes->{{3.9484654997494287`*^9, 
  3.94846550382178*^9}},ExpressionUUID->"49a67774-febb-408a-96e2-\
fc9d9e68e36f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Testing", " ", "optimal", " ", "Delta"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"i", "=", "30"}], ";", "\[IndentingNewLine]", 
    RowBox[{"deltaDets", "=", 
     RowBox[{
      RowBox[{"dets", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "-", 
      RowBox[{"dets", "[", 
       RowBox[{"[", 
        RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"delta", "=", 
     RowBox[{"0.006", " ", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"dets", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/", "12"}], "*", "0.065"}]}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"deltaDets", ",", "delta", ",", 
      RowBox[{"delta", "/", "deltaDets"}]}], "}"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.9525990294562883`*^9, 3.952599050122079*^9}, {
  3.9525991283919277`*^9, 3.9525991483165197`*^9}, {3.9525998582465267`*^9, 
  3.952599885204379*^9}, {3.9525999487149677`*^9, 3.9525999591157017`*^9}, {
  3.952600000155558*^9, 3.9526001099716988`*^9}, {3.952600277661695*^9, 
  3.952600416033629*^9}, {3.952600572080639*^9, 3.952600604602008*^9}, {
  3.9526007196366367`*^9, 3.952600730876445*^9}, {3.952600786956502*^9, 
  3.952600873235671*^9}, {3.9526009082663927`*^9, 3.9526013012932167`*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"d3decc74-24b2-4429-b815-0e4b2ee88564"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getRoot", "[", 
   RowBox[{"setup_", ",", 
    RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\n", "  ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "plot", ",", " ", "fdet", ",", " ", "roots", ",", " ", "dets", ",", " ", 
      "segmentRoots", ",", " ", "tempDisplay", ",", "\n", "   ", 
      "refinedRoot", ",", " ", "alpha", ",", " ", "Q", ",", " ", "P", ",", 
      " ", "NN", ",", " ", "theta", ",", " ", "gamma", ",", " ", "iterLs", ",",
       "threshold"}], "}"}], ",", "\n", "  ", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "alpha", ",", " ", "Q", ",", " ", "P", ",", " ", "NN", ",", " ", 
        "theta", ",", " ", "gamma"}], "}"}], " ", "=", " ", "setup"}], ";", 
     "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"iterLs", " ", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.02"}], ",", "0.6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.4", ",", "1.6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.3", ",", "5.1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4.9", ",", "8"}], "}"}]}], "}"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\n", 
     RowBox[{
      RowBox[{"fdet", "[", "lambda_", "]"}], " ", ":=", " ", 
      RowBox[{"determinant", "[", 
       RowBox[{
       "lambda", ",", " ", "gamma", ",", " ", "Q", ",", " ", "NN", ",", " ", 
        "alpha", ",", " ", "johnsCoeff", ",", " ", "theta"}], "]"}]}], ";", 
     "\n", 
     RowBox[{"roots", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"dets", " ", "=", " ", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lambda", ",", " ", 
            RowBox[{"Log", "@", 
             RowBox[{"Abs", "@", 
              RowBox[{"fdet", "[", "lambda", "]"}]}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"{", 
           RowBox[{"lambda", ",", "0", ",", "4", ",", 
            RowBox[{"4", "/", "1000"}]}], "}"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dets", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lambda", "^", "2"}], ",", " ", 
          RowBox[{"Log", "@", 
           RowBox[{"Abs", "@", 
            RowBox[{"fdet", "[", 
             RowBox[{"lambda", "^", "2"}], "]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"lambda", ",", "0.005", ",", 
          SqrtBox["22"], ",", "0.005"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"threshold", "=", "1.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"segmentRoots", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"FindLocalMinima", "[", 
        RowBox[{"dets", ",", " ", "threshold"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"segmentRoots", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"segmentRoots", "=", 
        RowBox[{"segmentRoots", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"$Failed", ",", "$Failed"}], " ", "}"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", " ", 
      RowBox[{"segmentRoots", ",", " ", "dets"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.950735328013377*^9, 3.950735364826256*^9}, {
   3.9507353975228367`*^9, 3.9507354090979443`*^9}, 3.950738279410178*^9, 
   3.9507385322284184`*^9, {3.950743249993648*^9, 3.9507432633521833`*^9}, {
   3.950743668014216*^9, 3.950743668909659*^9}, {3.950743813135787*^9, 
   3.950743851294572*^9}, 3.950776100994917*^9, 3.9514823317753267`*^9, 
   3.951482380688552*^9, {3.951502132081808*^9, 3.951502139696727*^9}, {
   3.951502253049902*^9, 3.9515022691719513`*^9}, {3.951502707788663*^9, 
   3.951502726577177*^9}, {3.951502826184486*^9, 3.9515028309110203`*^9}, 
   3.951503038680943*^9, {3.951503193521196*^9, 3.95150323651563*^9}, {
   3.9515050309513807`*^9, 3.951505115835867*^9}, {3.9515070535572033`*^9, 
   3.951507062096974*^9}, {3.9525990040165873`*^9, 3.952599004150901*^9}, 
   3.9526013125507383`*^9, {3.953902771580574*^9, 3.953902789380988*^9}, {
   3.9543637509607143`*^9, 3.954363751080908*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"f31f9bba-9986-44f5-8b09-06f0b54bb7c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Increased", " ", "Precision"}], ",", " ", 
    RowBox[{
    "but", " ", "I", " ", "decide", " ", "not", " ", "to", " ", "use", " ", 
     "it", " ", "for", " ", "now"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"getRoot", "[", 
     RowBox[{"setup_", ",", 
      RowBox[{"johnsCoeff_", ":", "johnsCoeff"}], ",", 
      RowBox[{"workingPrecision_", ":", "30"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "plot", ",", "fdet", ",", "roots", ",", "dets", ",", "segmentRoots", ",",
         "tempDisplay", ",", "refinedRoot", ",", "alpha", ",", "Q", ",", "P", 
        ",", "NN", ",", "theta", ",", "gamma", ",", "iterLs", ",", 
        "threshold"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "alpha", ",", "Q", ",", "P", ",", "NN", ",", "theta", ",", "gamma"}],
          "}"}], "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
          "setup"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"johnsCoeff", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
          "johnsCoeff"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"iterLs", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.02"}], ",", "0.6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.4", ",", "1.6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1.3", ",", "5.1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4.9", ",", "8"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fdet", "[", "lambda_", "]"}], ":=", 
        RowBox[{"determinant", "[", 
         RowBox[{
         "lambda", ",", "gamma", ",", "Q", ",", "NN", ",", "alpha", ",", 
          "johnsCoeff", ",", "theta", ",", "workingPrecision"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"roots", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dets", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SetPrecision", "[", 
             RowBox[{"lambda", ",", "workingPrecision"}], "]"}], ",", 
            RowBox[{"Log", "@", 
             RowBox[{"Abs", "@", 
              RowBox[{"fdet", "[", 
               RowBox[{"SetPrecision", "[", 
                RowBox[{"lambda", ",", "workingPrecision"}], "]"}], 
               "]"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"lambda", ",", "0", ",", "4", ",", 
            RowBox[{"4", "/", "1000"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"threshold", "=", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"1.01", ",", "workingPrecision"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"segmentRoots", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"FindLocalMinima", "[", 
           RowBox[{"dets", ",", "threshold"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"segmentRoots", ",", "dets"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.951482334810377*^9, 3.951482374742915*^9}, {
  3.951502283577044*^9, 3.951502293711239*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"ece2424c-45c0-4187-9654-42738487339f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"getRoot", "[", 
    RowBox[{"setup_", ",", 
     RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\n", "  ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "plot", ",", " ", "fdet", ",", " ", "roots", ",", " ", "dets", ",", " ",
        "segmentRoots", ",", " ", "tempDisplay", ",", "\n", "   ", 
       "refinedRoot", ",", " ", "alpha", ",", " ", "Q", ",", " ", "P", ",", 
       " ", "NN", ",", " ", "theta", ",", " ", "gamma", ",", " ", "iterLs", ",",
        "threshold"}], "}"}], ",", "\n", "  ", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "alpha", ",", " ", "Q", ",", " ", "P", ",", " ", "NN", ",", " ", 
         "theta", ",", " ", "gamma"}], "}"}], " ", "=", " ", "setup"}], ";", 
      "\n", 
      RowBox[{"iterLs", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.02"}], ",", "0.6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.4", ",", "1.6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.3", ",", "5.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4.9", ",", "8"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{
       RowBox[{"fdet", "[", "lambda_", "]"}], " ", ":=", " ", 
       RowBox[{"determinant", "[", 
        RowBox[{
        "lambda", ",", " ", "gamma", ",", " ", "Q", ",", " ", "NN", ",", " ", 
         "alpha", ",", " ", "johnsCoeff", ",", " ", "theta"}], "]"}]}], ";", 
      "\n", 
      RowBox[{"roots", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"dets", " ", "=", " ", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lambda", ",", " ", 
              RowBox[{"Log", "@", 
               RowBox[{"Abs", "@", 
                RowBox[{"fdet", "[", "lambda", "]"}]}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", " ", 
            RowBox[{"{", 
             RowBox[{"lambda", ",", " ", 
              RowBox[{"iterL", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{"iterL", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"iterL", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", " ", 
                 RowBox[{"iterL", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "130"}]}], 
             "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"threshold", "=", "1.1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"segmentRoots", " ", "=", " ", 
            RowBox[{"FindLocalMinima", "[", 
             RowBox[{"dets", ",", " ", "threshold"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "segmentRoots"}], ">", "5"}], ",", 
             RowBox[{"threshold", "=", "2"}], ",", "\[IndentingNewLine]", 
             RowBox[{"segmentRoots", "===", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"threshold", "=", "1.1"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"segmentRoots", " ", "=", " ", 
          RowBox[{"FindLocalMinima", "[", 
           RowBox[{"dets", ",", " ", "threshold"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"segmentRoots", " ", "=!=", " ", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"segmentRoots", " ", "=", " ", 
             RowBox[{"segmentRoots", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"tempDisplay", " ", "=", " ", 
             RowBox[{"PrintTemporary", "[", 
              RowBox[{"\"\<Roots are: \>\"", ",", "segmentRoots"}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"roots", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"roots", " ", ",", " ", "segmentRoots"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"refinedRoot", " ", "=", " ", 
                RowBox[{"FindRootBisection", "[", 
                 RowBox[{"fdet", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"root", " ", "-", " ", "0.015"}], ",", " ", 
                    RowBox[{"root", " ", "+", " ", "0.015"}]}], "}"}], ",", 
                  " ", "1*^-17", ",", " ", "120"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"refinedRoot", " ", "=!=", " ", "$Failed"}], ",", 
                 " ", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"tempDisplay", " ", "=", " ", 
                   RowBox[{"PrintTemporary", "[", 
                    RowBox[{"\"\<Roots are: \>\"", ",", "segmentRoots"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"Break", "[", "]"}]}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"root", ",", " ", "segmentRoots"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
        "\n", "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"iterL", ",", " ", "iterLs"}], "}"}]}], "\n", "   ", "]"}], ";",
       "\[IndentingNewLine]", "\n", "  ", 
      RowBox[{"Delete", "[", "tempDisplay", "]"}], ";", "\n", "  ", 
      RowBox[{"{", 
       RowBox[{"refinedRoot", ",", " ", "roots", ",", " ", "dets"}], 
       "}"}]}]}], "\n", "  ", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9487094563343267`*^9, 3.948709533884626*^9}, {
   3.948709650999978*^9, 3.9487096827605886`*^9}, {3.948710088982215*^9, 
   3.948710151158958*^9}, {3.94871032658082*^9, 3.9487105191254683`*^9}, 
   3.948710613864643*^9, {3.948711248251153*^9, 3.948711248656522*^9}, {
   3.948711362167852*^9, 3.94871136609217*^9}, {3.9487114374189453`*^9, 
   3.948711439941732*^9}, {3.948893584087709*^9, 3.948893584744203*^9}, {
   3.9488955691776657`*^9, 3.948895574728745*^9}, {3.9489254663816423`*^9, 
   3.948925470456893*^9}, {3.948925513067197*^9, 3.948925532094693*^9}, {
   3.948925625540255*^9, 3.94892563923528*^9}, {3.948925956213678*^9, 
   3.948925963241806*^9}, {3.949752128074623*^9, 3.9497521282302513`*^9}, {
   3.949752436096258*^9, 3.94975261134797*^9}, {3.9497759621513033`*^9, 
   3.949775963438682*^9}, {3.949789523265766*^9, 3.949789524090733*^9}, {
   3.949888467683527*^9, 3.949888492094507*^9}, {3.949969116072735*^9, 
   3.949969116296842*^9}, 3.950003742653187*^9, {3.950705502615444*^9, 
   3.9507055272832108`*^9}, {3.950706074586578*^9, 3.950706103508712*^9}, 
   3.950706291194654*^9, 3.950735282842269*^9, 3.950735315495682*^9, 
   3.95150230289935*^9, {3.951502884110208*^9, 3.9515028909673033`*^9}, 
   3.9515070465927362`*^9},
 CellLabel->
  "In[175]:=",ExpressionUUID->"c4101054-d238-41fc-b6a2-0eb2df58a8dd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Find Root Bisection", "Subsubsection",
 CellChangeTimes->{{3.948465067610483*^9, 3.9484650742459583`*^9}, {
  3.952523335305353*^9, 
  3.9525233392486362`*^9}},ExpressionUUID->"91853d80-cdcd-43e1-8a93-\
88ea54e28991"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"FindRootBisection", "[", 
    RowBox[{"f_", ",", " ", 
     RowBox[{"{", 
      RowBox[{"a_", ",", " ", "b_"}], "}"}], ",", " ", 
     RowBox[{"tolerance_", " ", ":", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "12"}]}]}], ",", " ", 
     RowBox[{"maxiter_", " ", ":", " ", "150"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"left", " ", "=", " ", "a"}], ",", " ", 
       RowBox[{"right", " ", "=", " ", "b"}], ",", " ", "mid", ",", " ", 
       "fleft", ",", " ", "fright", ",", " ", "fmid", ",", " ", 
       RowBox[{"iter", " ", "=", " ", "0"}]}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"fleft", " ", "=", " ", 
       RowBox[{"f", "[", "left", "]"}]}], ";", "\n", "   ", 
      RowBox[{"fright", " ", "=", " ", 
       RowBox[{"f", "[", "right", "]"}]}], ";", "\n", "   ", "\n", "   ", 
      RowBox[{"(*", 
       RowBox[{
       "Check", " ", "if", " ", "endpoints", " ", "have", " ", "opposite", " ",
         "signs"}], "*)"}], "\n", "   ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sign", "[", "fleft", "]"}], "*", 
          RowBox[{"Sign", "[", "fright", "]"}]}], " ", ">=", " ", "0"}], ",", 
        "\[IndentingNewLine]", " ", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Warning: Endpoints don't bracket a root \>\"", 
          "]"}], ";", "\n", "    ", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", "\n", "   ",
       "\n", "   ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"\"\<Iteration 0\>\"", ",", "\"\<: \>\"", 
          ",", "\"\<left=\>\"", ",", "left", ",", "\"\< (\>\"", ",", "fleft", 
          ",", "\"\<) right=\>\"", ",", "right", ",", "\"\< (\>\"", ",", 
          "fright", ",", "\"\<)\>\""}], "]"}], ";"}], "*)"}], "\n", "   ", 
      RowBox[{"Block", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$MinPrecision", "=", "30"}], "}"}], ",", "\n", "   ", 
        RowBox[{
         RowBox[{"While", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"right", " ", "-", " ", "left"}], "]"}], " ", ">", " ", 
             "tolerance"}], " ", "&&"}], "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"iter", " ", "<", " ", "maxiter"}], ",", " ", 
           RowBox[{
            RowBox[{"mid", " ", "=", " ", 
             RowBox[{"SetPrecision", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"left", " ", "+", " ", "right"}], ")"}], "/", "2"}], 
               ",", " ", "30"}], "]"}]}], ";", "\n", "    ", 
            RowBox[{"fmid", " ", "=", " ", 
             RowBox[{"f", "[", "mid", "]"}]}], ";", "\n", "    ", "\n", 
            RowBox[{"(*", "    ", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "fmid", "]"}], " ", "<", " ", 
                 "tolerance"}], ",", " ", 
                RowBox[{"Return", "[", "mid", "]"}]}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sign", "[", "fleft", "]"}], "*", 
                RowBox[{"Sign", "[", "fmid", "]"}]}], " ", "<=", " ", "0"}], ",",
               " ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"right", " ", "=", " ", "mid"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"fright", " ", "=", " ", "fmid"}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"left", " ", "=", " ", "mid"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"fleft", " ", "=", " ", "fmid"}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"iter", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\n", 
      RowBox[{"(*", "   ", 
       RowBox[{
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"\"\<Iteration \>\"", ",", "iter", ",", "\"\<: \>\"", 
          ",", "\"\<left=\>\"", ",", "left", ",", "\"\< (\>\"", ",", "fleft", 
          ",", "\"\<), \>\"", ",", "\"\<mid=\>\"", ",", "mid", 
          ",", "\"\< (\>\"", ",", "fmid", ",", "\"\<), \>\"", 
          ",", "\"\<right=\>\"", ",", "right", ",", "\"\< (\>\"", ",", 
          "fright", ",", "\"\<)\>\""}], "]"}], ";"}], "*)"}], "\n", "   ", 
      "mid"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.9484650941097727`*^9, 3.949888444718405*^9, {3.950742678148926*^9, 
   3.9507427403095713`*^9}, {3.952431303999102*^9, 3.9524313162813053`*^9}, {
   3.9524318790091267`*^9, 3.952431898851881*^9}, {3.952432049977254*^9, 
   3.95243208213019*^9}, {3.952523355303544*^9, 3.9525234081255007`*^9}, {
   3.9525234411395283`*^9, 3.952523441225925*^9}, 3.952523827733267*^9, {
   3.952524340195386*^9, 3.952524383892767*^9}, {3.9525246217893667`*^9, 
   3.952524642866667*^9}, {3.952524724243997*^9, 3.952524755364554*^9}, {
   3.952524845002308*^9, 3.952524860276719*^9}, {3.952525363392468*^9, 
   3.952525363988764*^9}, 3.952787318145939*^9},
 CellLabel->
  "In[176]:=",ExpressionUUID->"aad5b884-bc07-4301-af69-794ed62a7bfb"],

Cell[CellGroupData[{

Cell[BoxData["\[AliasDelimiter]"], "Input",
 CellChangeTimes->{3.9527875844104548`*^9},
 CellLabel->
  "In[177]:=",ExpressionUUID->"1b9699af-e802-4739-899b-1f17af8491ec"],

Cell[BoxData["\[AliasDelimiter]"], "Output",
 CellChangeTimes->{3.955021100229694*^9},
 CellLabel->
  "Out[177]=",ExpressionUUID->"4873c25d-47db-4ed5-a18a-2f774c2dec8b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["FindLocalMinima", "Subsubsection",
 CellChangeTimes->{
  3.948464870968997*^9},ExpressionUUID->"05ea0d55-3657-4874-9f94-\
24d93636edcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindLocalMinima", "[", 
   RowBox[{"data_", ",", 
    RowBox[{"threshold_", ":", "3"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vals", ",", 
      RowBox[{"windowSize", "=", "5"}], ",", "minIndices", ",", "minima"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Work", " ", "with", " ", "log", " ", "values"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vals", "=", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Find", " ", "local", " ", "minima", " ", "indices"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"minIndices", "=", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"windowSize", "+", "1"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "vals", "]"}], "-", "windowSize"}]}], "]"}],
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Check", " ", "if", " ", "point", " ", "is", " ", "minimum", " ", 
          "in", " ", "its", " ", "window"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"vals", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"#", "-", "windowSize"}], ";;", 
               RowBox[{"#", "+", "windowSize"}]}], "]"}], "]"}], "]"}], "==", 
           
           RowBox[{"vals", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "&&", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Check", " ", "if", " ", "minimum", " ", "is", " ", "\"\<deep\>\"",
             " ", "enough", " ", "relative", " ", "to", " ", "neighbors"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"vals", "[", 
               RowBox[{"[", 
                RowBox[{"#", "-", "1"}], "]"}], "]"}], "-", 
              RowBox[{"vals", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"vals", "[", 
               RowBox[{"[", 
                RowBox[{"#", "+", "1"}], "]"}], "]"}], "-", 
              RowBox[{"vals", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}]}], "]"}], ">", 
           RowBox[{"Log", "[", "threshold", "]"}]}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"data", "[", 
      RowBox[{"[", "minIndices", "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.948709938839471*^9, 3.948710035621501*^9}, {
  3.950706007135643*^9, 3.950706012744081*^9}, {3.952601363877804*^9, 
  3.952601364158093*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"4cd21e2e-94eb-4b23-bffb-7e845306d28a"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["S Matrices", "Subsection",
 CellChangeTimes->{{3.9484650962038593`*^9, 
  3.948465099421315*^9}},ExpressionUUID->"ff92da06-d757-44dd-85b5-\
722525fc0933"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"Smatrices", "[", 
    RowBox[{
    "n_", ",", " ", "root_", ",", " ", "gamma_", ",", " ", "Q_", ",", " ", 
     "NN_", ",", " ", "Dpq_", ",", " ", "Dbar_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "S", "}"}], ",", "\n", "   ", 
     RowBox[{
      RowBox[{"S", " ", "=", " ", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Q", " ", "+", " ", "1"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "root"}], " ", "+", " ", 
          RowBox[{"gamma", " ", 
           RowBox[{"(", 
            RowBox[{"n", " ", "+", " ", "NN", " ", "+", " ", "1"}], ")"}]}]}],
          ")"}]}]}], ";", "\n", "   ", 
      RowBox[{"Do", "[", "\n", "    ", 
       RowBox[{
        RowBox[{"S", " ", "=", " ", 
         RowBox[{"Inverse", "[", "\n", "      ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "root"}], " ", "+", " ", 
              RowBox[{"gamma", "*", 
               RowBox[{"(", 
                RowBox[{"k", " ", "+", " ", "n"}], ")"}]}]}], ")"}], "*", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{"Q", " ", "+", " ", "1"}], "]"}]}], " ", "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", " ", "+", " ", "k", " ", "+", " ", "1"}], ")"}], "*", 
            RowBox[{"Dpq", " ", ".", " ", "S", " ", ".", " ", "Dbar"}]}]}], 
          "\n", "      ", "]"}]}], ",", "\n", "    ", 
        RowBox[{"{", 
         RowBox[{"k", ",", " ", "NN", ",", " ", "1", ",", " ", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"n", " ", "+", " ", "1"}], "]"}]}], "*", 
       RowBox[{"S", " ", ".", " ", "Dbar"}]}]}]}], "\n", "   ", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.948465116417615*^9, 3.951482007791759*^9, {3.951520815488064*^9, 
   3.951520817849868*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"e07363cc-f2e9-4651-b139-2f53220d97fd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Smatrices", "[", 
    RowBox[{
    "n_", ",", "root_", ",", "gamma_", ",", "Q_", ",", "NN_", ",", "Dpq_", ",",
      "Dbar_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "workingPrecision"}], "}"}], ",", 
     RowBox[{
      RowBox[{"workingPrecision", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"Precision", "[", "root", "]"}], ",", 
         RowBox[{"Precision", "[", "gamma", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{
        RowBox[{"SetPrecision", "[", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"Q", "+", "1"}], "]"}], ",", "workingPrecision"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "root"}], "+", 
          RowBox[{"gamma", " ", 
           RowBox[{"(", 
            RowBox[{"n", "+", "NN", "+", "1"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"S", "=", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "root"}], "+", 
                RowBox[{"gamma", "*", 
                 RowBox[{"(", 
                  RowBox[{"k", "+", "n"}], ")"}]}]}], ")"}], "*", 
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"Q", "+", "1"}], "]"}]}], ",", "workingPrecision"}], 
            "]"}], "-", 
           RowBox[{
            RowBox[{"SetPrecision", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "+", "k", "+", "1"}], ")"}], ",", 
              "workingPrecision"}], "]"}], "*", 
            RowBox[{"Dpq", ".", "S", ".", "Dbar"}]}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "NN", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ",", "workingPrecision"}], "]"}], "]"}]}],
        "*", 
       RowBox[{"S", ".", "Dbar"}]}]}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.951482008826034*^9, 3.95148200882965*^9}, 
   3.9515208232380877`*^9},
 CellLabel->
  "In[180]:=",ExpressionUUID->"4290ef25-74d1-4dd5-b674-1c8a4293ca4f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculate Right Eigenfunction", "Subsection",
 CellChangeTimes->{{3.9484652338765306`*^9, 
  3.9484652600957127`*^9}},ExpressionUUID->"78001a50-6a96-418f-9744-\
5370b29a1b50"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"calculateEigenfunction", "[", 
    RowBox[{
    "root_", ",", " ", "gamma_", ",", " ", "Q_", ",", " ", "NN_", ",", " ", 
     "P_", ",", " ", "alpha_", ",", " ", "theta_", ",", " ", 
     RowBox[{"johnsCoeff_", " ", ":", "johnsCoeff"}], ",", 
     RowBox[{"precsion_", ":", "16"}]}], "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"Module", "[", "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Dpq", ",", " ", "Dbar", ",", " ", "K0", ",", " ", "M", ",", " ", "U", ",",
        " ", "S", ",", " ", "V", ",", " ", "c0", ",", " ", "cn", ",", " ", 
       "psi", ",", " ", "PhiX", ",", " ", "normalization", ",", "c", ",", 
       "\n", "    ", "positionPart", ",", " ", "velocityPart", ",", " ", 
       "summationPart", ",", " ", "tempCn", ",", " ", "tempDisplay"}], "}"}], 
     ",", "\n", "   ", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"root", "===", "$Failed"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"$Failed", ",", "$Failed"}], "}"}], "]"}]}], "]"}], ";", 
      "\n", "   ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dpq", ",", " ", "Dbar"}], "}"}], " ", "=", " ", 
       RowBox[{"resizeDMatrices", "[", 
        RowBox[{"Q", ",", "\n", "     ", 
         RowBox[{"\"\<alpha \>\"", " ", "->", " ", "alpha"}], ",", "\n", 
         "     ", 
         RowBox[{"\"\<d1 \>\"", " ", "->", " ", 
          RowBox[{"johnsCoeff", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "     ", 
         RowBox[{"\"\<d2 \>\"", " ", "->", " ", 
          RowBox[{"johnsCoeff", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "     ", 
         RowBox[{"\"\<d3 \>\"", " ", "->", " ", 
          RowBox[{"johnsCoeff", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "     ", 
         RowBox[{"\"\<d4 \>\"", " ", "->", " ", 
          RowBox[{"johnsCoeff", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "     ", 
         RowBox[{"\"\<theta \>\"", " ", "->", " ", "theta"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"K0", " ", "=", " ", 
       RowBox[{"kMatrix", "[", 
        RowBox[{
         RowBox[{"-", "root"}], ",", " ", "gamma", ",", " ", "Q", ",", " ", 
         "NN", ",", " ", "Dpq", ",", " ", "Dbar"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"M", " ", "=", " ", 
         RowBox[{
          RowBox[{"root", "*", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Q", " ", "+", " ", "1"}], "]"}]}], " ", "+", " ", 
          "K0"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"root", "*", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Q", " ", "+", " ", "1"}], "]"}]}], " ", "+", " ", "K0"}],
          ",", "precsion"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<precision of M:\>\"", ",", 
        RowBox[{"Precision", "[", "M", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cn", " ", "=", " ", 
       RowBox[{"NullSpace", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<precision of cn:\>\"", ",", 
          RowBox[{"Precision", "[", "cn", "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tempDisplay", " ", "=", " ", 
         RowBox[{"PrintTemporary", "[", 
          RowBox[{"\"\<length of NullSpace[M]: \>\"", ",", " ", 
           RowBox[{"Length", "[", "cn", "]"}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "cn", "]"}], " ", "!=", " ", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", 
          "[", "\"\<Warning: Null Space wrong dimension, Check inputs \>\"", 
          "]"}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"$Failed", ",", "$Failed"}], "}"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Delete", "[", "tempDisplay", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tempDisplay", " ", "=", " ", 
         RowBox[{"PrintTemporary", "[", 
          RowBox[{"\"\<length of NullSpace[M]: \>\"", ",", " ", 
           RowBox[{"Length", "[", "cn", "]"}], ",", 
           "\[IndentingNewLine]", "\"\<; Norm of M . C0: \>\"", ",", " ", 
           RowBox[{"Norm", "[", " ", 
            RowBox[{"M", " ", ".", " ", 
             RowBox[{"cn", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
       "*)"}], "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tempDisplay", " ", "=", " ", 
         RowBox[{"PrintTemporary", "[", 
          RowBox[{"\"\<Norm of M . C0: \>\"", ",", " ", 
           RowBox[{"Norm", "[", " ", 
            RowBox[{"M", " ", ".", " ", 
             RowBox[{"cn", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
       "*)"}], "\n", "   ", "\n", "   ", "\[IndentingNewLine]", "   ", 
      RowBox[{"Do", "[", "\n", "       ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"tempCn", " ", "=", " ", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Smatrices", "[", 
              RowBox[{
              "n", ",", " ", "root", ",", " ", "gamma", ",", " ", "Q", ",", 
               " ", "NN", ",", " ", "Dpq", ",", " ", "Dbar"}], "]"}], " ", ".",
              " ", 
             RowBox[{"cn", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "10"}], "]"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempCn", " ", "=", " ", 
          RowBox[{
           RowBox[{"Smatrices", "[", 
            RowBox[{
            "n", ",", " ", "root", ",", " ", "gamma", ",", " ", "Q", ",", " ",
              "NN", ",", " ", "Dpq", ",", " ", "Dbar"}], "]"}], " ", ".", " ", 
           RowBox[{"cn", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]",
          "\n", "       ", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"cn", ",", " ", "tempCn"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "0", ",", " ", 
          RowBox[{"P", " ", "-", " ", "1"}]}], "}"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<precision of cn:\>\"", ",", 
          RowBox[{"Precision", "[", "cn", "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "[", "n_", "]"}], " ", ":=", " ", 
       RowBox[{"cn", "[", 
        RowBox[{"[", 
         RowBox[{"n", " ", "+", " ", "1"}], "]"}], "]"}]}], ";", 
      RowBox[{"PhiX", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "[", 
          RowBox[{"i", ",", " ", 
           RowBox[{"alpha", "  ", "x"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "0", ",", " ", "Q"}], "}"}]}], "]"}]}], ";", 
      
      RowBox[{"normalization", " ", "=", " ", 
       RowBox[{"N", "[", 
        RowBox[{"positionPrefactor", "[", 
         RowBox[{"theta", ",", " ", "johnsCoeff"}], "]"}], "]"}]}], ";", 
      RowBox[{"velocityPart", " ", "=", " ", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"alpha", " ", "/", "theta"}], " ", ")"}], 
         RowBox[{"1", "/", "2"}]], " ", 
        RowBox[{"\[Phi]", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"v", "/", 
           SqrtBox["theta"]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"positionPart", " ", "=", " ", 
       RowBox[{
        SqrtBox["normalization"], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Potential", "[", 
             RowBox[{"x", ",", " ", "johnsCoeff"}], "]"}]}], "/", "2"}], "/", 
          "theta"}], "]"}]}]}], ";", 
      RowBox[{"summationPart", " ", "=", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "n", "]"}], " ", ".", " ", "PhiX"}], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"n", ",", " ", 
            RowBox[{"v", "/", 
             SqrtBox["theta"]}]}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"n", ",", " ", "0", ",", " ", "P"}], "}"}]}], "]"}]}], ";", 
      
      RowBox[{"psi", " ", "=", " ", 
       RowBox[{
       "positionPart", " ", "*", " ", "velocityPart", " ", "*", " ", 
        "summationPart"}]}], ";", 
      RowBox[{"Delete", "[", "tempDisplay", "]"}], ";", 
      RowBox[{"{", 
       RowBox[{"psi", ",", " ", "cn"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.948614219043635*^9, 3.948614248148921*^9}, {
   3.948614281762002*^9, 3.948614339289147*^9}, {3.948614369539445*^9, 
   3.94861440225175*^9}, {3.948722682126652*^9, 3.9487226848814983`*^9}, {
   3.948825827745764*^9, 3.9488258339835653`*^9}, {3.948825865825408*^9, 
   3.948825960173532*^9}, {3.948905903521625*^9, 3.948905908465239*^9}, {
   3.9489261020662737`*^9, 3.9489261512467327`*^9}, 3.951312601033538*^9, 
   3.951481423438601*^9, 3.951519992062063*^9, {3.952465574336423*^9, 
   3.952465598299027*^9}, {3.9525258314898252`*^9, 3.952525881560416*^9}, {
   3.9525259767021008`*^9, 3.9525259937027607`*^9}, {3.952526806678302*^9, 
   3.952526808235538*^9}, 3.9526042526524467`*^9, {3.9527311183743258`*^9, 
   3.95273114592736*^9}, 3.9536323150962*^9, {3.9538124125295267`*^9, 
   3.953812422699725*^9}, 3.9543712173712597`*^9, {3.954430113937145*^9, 
   3.954430158823571*^9}, {3.9544312507549343`*^9, 3.954431290186736*^9}, {
   3.954431351170053*^9, 3.954431358557864*^9}, {3.9544318977695227`*^9, 
   3.954431899112958*^9}, {3.954452296886818*^9, 3.954452325802908*^9}, {
   3.954452482694252*^9, 3.95445249938107*^9}, {3.954496188156519*^9, 
   3.95449620022255*^9}, {3.954503042245623*^9, 3.954503065937598*^9}, {
   3.9545069976901817`*^9, 3.9545069997867813`*^9}, {3.954511779638398*^9, 
   3.9545117829274273`*^9}, {3.954591739051243*^9, 3.954591762660837*^9}, {
   3.954756759001294*^9, 3.954756759896543*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"a2655175-c00e-45ec-88e1-6394deba7692"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"calculateEigenfunction", "[", 
    RowBox[{
    "root_", ",", "gamma_", ",", "Q_", ",", "NN_", ",", "P_", ",", "alpha_", ",",
      "theta_", ",", 
     RowBox[{"johnsCoeff_", ":", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], ",", 
     RowBox[{"workingPrecision_", ":", "30"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Dpq", ",", "Dbar", ",", "K0", ",", "M", ",", "U", ",", "S", ",", "V", ",",
        "c0", ",", "cn", ",", "psi", ",", "PhiX", ",", "normalization", ",", 
       "c", ",", "positionPart", ",", "velocityPart", ",", "summationPart", ",",
        "tempCn", ",", "tempDisplay"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dpq", ",", "Dbar"}], "}"}], "=", 
       RowBox[{"resizeDMatrices", "[", 
        RowBox[{"Q", ",", 
         RowBox[{"\"\<alpha \>\"", "->", "alpha"}], ",", 
         RowBox[{"\"\<d1 \>\"", "->", 
          RowBox[{"johnsCoeff", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<d2 \>\"", "->", 
          RowBox[{"johnsCoeff", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<d3 \>\"", "->", 
          RowBox[{"johnsCoeff", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<d4 \>\"", "->", 
          RowBox[{"johnsCoeff", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<theta \>\"", "->", "theta"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"K0", "=", 
       RowBox[{"kMatrix", "[", 
        RowBox[{
         RowBox[{"-", "root"}], ",", "gamma", ",", "Q", ",", "NN", ",", "Dpq",
          ",", "Dbar"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{
        RowBox[{"root", "*", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Q", "+", "1"}], "]"}]}], "+", "K0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cn", "=", 
       RowBox[{"NullSpace", "[", 
        RowBox[{"SetPrecision", "[", 
         RowBox[{"M", ",", "workingPrecision"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "cn", "]"}], "!=", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "PrintTemporary", 
           "[", "\"\<Warning: Null Space wrong dimension, Check inputs \>\"", 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", 
          "[", "\"\<Warning: Null Space wrong dimension, Check inputs \>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"$Failed", ",", "$Failed"}], "}"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tempDisplay", "=", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Norm of M . C0: \>\"", ",", 
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"SetPrecision", "[", 
            RowBox[{"M", ",", "workingPrecision"}], "]"}], ".", 
           RowBox[{"cn", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tempCn", "=", 
          RowBox[{
           RowBox[{"Smatrices", "[", 
            RowBox[{
            "n", ",", "root", ",", "gamma", ",", "Q", ",", "NN", ",", "Dpq", ",",
              "Dbar"}], "]"}], ".", 
           RowBox[{"cn", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"cn", ",", "tempCn"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "0", ",", 
          RowBox[{"P", "-", "1"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "[", "n_", "]"}], ":=", 
       RowBox[{"cn", "[", 
        RowBox[{"[", 
         RowBox[{"n", "+", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"PhiX", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "[", 
          RowBox[{"i", ",", 
           RowBox[{"alpha", " ", "x"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "Q"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"normalization", "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"positionPrefactor", "[", 
          RowBox[{"theta", ",", "johnsCoeff"}], "]"}], ",", 
         "workingPrecision"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"velocityPart", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"alpha", "/", "theta"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}], " ", 
        RowBox[{"\[Phi]", "[", 
         RowBox[{"0", ",", 
          RowBox[{"v", "/", 
           RowBox[{"Sqrt", "[", "theta", "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"positionPart", "=", 
       RowBox[{
        RowBox[{"Sqrt", "[", "normalization", "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Potential", "[", 
             RowBox[{"x", ",", "johnsCoeff"}], "]"}]}], "/", "2"}], "/", 
          "theta"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"summationPart", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "n", "]"}], ".", "PhiX"}], " ", 
          RowBox[{"\[Phi]", "[", 
           RowBox[{"n", ",", 
            RowBox[{"v", "/", 
             RowBox[{"Sqrt", "[", "theta", "]"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", "P"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"psi", "=", 
       RowBox[{"positionPart", "*", "velocityPart", "*", "summationPart"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Delete", "[", "tempDisplay", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"psi", ",", "cn"}], "}"}]}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9514814262865067`*^9, 3.951481426290173*^9}, {
   3.951506085970668*^9, 3.9515061197963037`*^9}, {3.951506944923697*^9, 
   3.9515069854739656`*^9}, 3.9515208054456367`*^9},
 CellLabel->
  "In[182]:=",ExpressionUUID->"c6f58fb5-d02e-4f43-86e6-297ec0eab6c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Left Eigenfunction", "Subsection",
 CellChangeTimes->{{3.948465265006545*^9, 
  3.948465267707761*^9}},ExpressionUUID->"aecafedc-4f67-4674-a8d3-\
0d6de3cfc227"],

Cell[BoxData[
 RowBox[{"Clear", "[", "leftEigenfunction", "]"}]], "Input",
 CellChangeTimes->{{3.9526254526825037`*^9, 3.952625456879362*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"7339fc23-2f83-4eb9-b303-8ab2eb985f89"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"leftEigenfunction", "[", 
    RowBox[{"eigenfunctionR_", ",", " ", "johnsCoeff_", ",", " ", "theta_"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eigenfunctionL", ",", " ", "inverseV"}], "}"}], ",", "\n", 
     "   ", 
     RowBox[{
      RowBox[{"inverseV", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"v", " ", "->", " ", 
         RowBox[{"-", "v"}]}], "}"}]}], ";", "\n", "   ", 
      RowBox[{"eigenfunctionL", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"eigenfunctionR", " ", "/.", " ", "inverseV"}], ")"}], "/", 
         "\n", "      ", 
         RowBox[{"wst", "[", 
          RowBox[{"theta", ",", " ", "johnsCoeff"}], "]"}]}], "/", "\n", 
        "     ", 
        RowBox[{"N", "@", 
         RowBox[{"positionPrefactor", "[", 
          RowBox[{"theta", ",", " ", "johnsCoeff"}], "]"}]}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.9484652735908422`*^9, {3.948926198303372*^9, 3.948926203217259*^9}, {
   3.952625376784237*^9, 3.9526253796083612`*^9}, {3.952625426694132*^9, 
   3.952625462121468*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"cbabe79b-e397-4585-bcd3-411aae382399"]
}, Closed]],

Cell[CellGroupData[{

Cell["Overlaps (reduced max T)", "Subsection",
 CellChangeTimes->{{3.948465288670533*^9, 3.9484652898556347`*^9}, {
  3.952784878102944*^9, 
  3.9527848838494587`*^9}},ExpressionUUID->"4132f726-6777-4da1-802b-\
95810ec0bc0c"],

Cell[CellGroupData[{

Cell["Calculate Overlaps", "Subsubsection",
 CellChangeTimes->{{3.948465377095552*^9, 
  3.948465382357379*^9}},ExpressionUUID->"ee859923-fcef-45a0-b970-\
2cf0a9ce8695"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"calculateOverlap", "[", 
    RowBox[{"leftEigenfunction_", ",", "johnsCoeff_", ",", "bathTemp_", ",", 
     RowBox[{"divisions_", ":", "23"}], ",", 
     RowBox[{"workingPrecision_", ":", "30"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "minT", ",", "maxT", ",", "xs", ",", "boundy", ",", "boundx", ",", 
       "listTheta", ",", "overlaps", ",", "exponent", ",", "tempPlot"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"minT", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"0.1", "*", "bathTemp"}], ",", "workingPrecision"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"maxT", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"6", "*", "bathTemp"}], ",", "workingPrecision"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"boundx", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"Sqrt", "[", "bathTemp", "]"}]}], ",", "workingPrecision"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"boundy", "=", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"6", " ", 
          RowBox[{"Sqrt", "[", "bathTemp", "]"}]}], ",", "workingPrecision"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exponent", "=", "5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"listTheta", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"increment", "^", "exponent"}], ",", "workingPrecision"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"increment", ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"minT", "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
             "workingPrecision"}], "]"}], ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"maxT", "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
             "workingPrecision"}], "]"}], ",", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"maxT", "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "exponent"}], ")"}]}], "-", 
                RowBox[{"minT", "^", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "exponent"}], ")"}]}]}], ")"}], "/", 
              "divisions"}], ",", "workingPrecision"}], "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"overlaps", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"wst", "[", 
                RowBox[{
                 RowBox[{"SetPrecision", "[", 
                  RowBox[{"theta", ",", "workingPrecision"}], "]"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"#", ",", "workingPrecision"}], "]"}], "&"}], ",",
                    "johnsCoeff"}], "]"}]}], "]"}], " ", 
               "leftEigenfunction"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"-", "boundx"}], ",", "boundx"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v", ",", 
                RowBox[{"-", "boundy"}], ",", "boundy"}], "}"}], ",", 
              RowBox[{"PrecisionGoal", "->", "10"}], ",", 
              RowBox[{"WorkingPrecision", "->", "workingPrecision"}], ",", 
              RowBox[{"MaxRecursion", "->", "40"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"theta", ",", "listTheta"}], "}"}]}], "]"}]}], ";"}], ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          
          RowBox[{"\"\<Inner Progress: \>\"", ",", "theta", ",", "\"\< / \>\"",
            ",", "maxT", ",", "\"\< \>\"", ",", 
           RowBox[{"ProgressIndicator", "[", 
            RowBox[{
             RowBox[{"theta", "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"minT", "^", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
               RowBox[{"maxT", "^", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "exponent"}], ")"}]}]}], "}"}]}], "]"}]}], 
          "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"listTheta", ",", "overlaps"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"bathTemp", ",", "0"}], "}"}], "}"}]}], "}"}]}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.951481264894268*^9, 3.951481274924234*^9}, {
  3.9515206283813553`*^9, 3.9515206288253613`*^9}, {3.951520788356833*^9, 
  3.951520792209735*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"46dd4934-dce9-4537-844d-cb2d77fa488c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "calculateOverlap", "]"}], ";", 
  RowBox[{
   RowBox[{"calculateOverlap", "[", 
    RowBox[{"leftEigenfunction_", ",", 
     RowBox[{"johnsCoeff_", ":", "johnsCoeff"}], ",", "bathTemp_", ",", 
     RowBox[{"divisions_", ":", "23"}], ",", 
     RowBox[{"minfactor_", ":", "0.1"}], ",", " ", 
     RowBox[{"maxfactor_", ":", "8"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "minT", ",", "maxT", ",", "xs", ",", "boundy", ",", "boundx", ",", 
       "listTheta", ",", "overlaps", ",", "exponent", ",", "tempPlot", ",", 
       "lowMinima", ",", "highMinima"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"minT", "=", 
       RowBox[{"minfactor", "*", "bathTemp"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxT", "=", 
       RowBox[{"maxfactor", "*", "bathTemp"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"boundx", "=", 
         RowBox[{"1", "+", 
          RowBox[{"Sqrt", "[", "bathTemp", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"boundy", "=", 
         RowBox[{"7", 
          RowBox[{"Sqrt", "[", "bathTemp", "]"}]}]}], ";"}], "*)"}], 
      RowBox[{"lowMinima", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"force", "[", 
             RowBox[{"x", ",", "johnsCoeff"}], "]"}], "==", "0"}], ",", "x"}],
           "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"highMinima", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"force", "[", 
             RowBox[{"x", ",", "johnsCoeff"}], "]"}], "==", "0"}], ",", "x"}],
           "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"boundy", "[", "T_", "]"}], ":=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"2", 
          SqrtBox[
           RowBox[{"2", "T"}]]}], ",", 
         RowBox[{"2", 
          SqrtBox[
           RowBox[{"2", " ", "8", " ", "bathTemp"}]]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"boundx", "=", 
       RowBox[{"1.6", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"johnsCoeff", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "/", "4"}], "bathTemp"}], ")"}], 
         
         RowBox[{"1", "/", "4"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exponent", "=", "5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"listTheta", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["increment", "exponent"], ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{"increment", ",", "\[IndentingNewLine]", 
           SuperscriptBox["minT", 
            RowBox[{"1", "/", "exponent"}]], ",", "\[IndentingNewLine]", 
           SuperscriptBox["maxT", 
            RowBox[{"1", "/", "exponent"}]], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["maxT", 
               RowBox[{"1", "/", "exponent"}]], "-", 
              SuperscriptBox["minT", 
               RowBox[{"1", "/", "exponent"}]]}], ")"}], "/", "divisions"}]}],
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"overlaps", " ", "=", " ", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"wst", "[", 
              RowBox[{"theta", ",", "johnsCoeff"}], "]"}], " ", 
             "leftEigenfunction"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"lowMinima", "-", "boundx"}], ",", 
              RowBox[{"highMinima", "+", "boundx"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", 
               RowBox[{"boundy", "[", "theta", "]"}]}], ",", 
              RowBox[{"boundy", "[", "theta", "]"}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"theta", ",", "listTheta"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"listTheta", ",", "overlaps"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"bathTemp", ",", "0"}], "}"}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.948614479928423*^9, {3.948618995295372*^9, 3.9486189979992228`*^9}, {
   3.948733235054933*^9, 3.948733247823818*^9}, {3.948733315252163*^9, 
   3.9487333205052843`*^9}, {3.9487347201111727`*^9, 3.948734724792701*^9}, {
   3.948747877941992*^9, 3.948747879379551*^9}, {3.948749082906036*^9, 
   3.94874909449157*^9}, {3.9487494818341846`*^9, 3.948749483756081*^9}, {
   3.948749661483403*^9, 3.948749665850597*^9}, {3.9488722869812517`*^9, 
   3.94887231045643*^9}, {3.948895621370247*^9, 3.948895622043202*^9}, {
   3.9488981750476103`*^9, 3.948898190625811*^9}, {3.9488985650633802`*^9, 
   3.948898585395658*^9}, 3.948898733439003*^9, {3.9488989989271593`*^9, 
   3.948899051117056*^9}, 3.948917574258502*^9, 3.9489180247361298`*^9, {
   3.948918241440515*^9, 3.948918274676495*^9}, {3.948924496152424*^9, 
   3.948924501123345*^9}, {3.948924729702195*^9, 3.948924747692814*^9}, {
   3.948926425262393*^9, 3.948926448851076*^9}, {3.9489268461194057`*^9, 
   3.948926861094561*^9}, {3.948927082957106*^9, 3.9489271865603933`*^9}, {
   3.948927367977066*^9, 3.948927374002756*^9}, {3.948927614232545*^9, 
   3.9489276529399633`*^9}, {3.9489276977062197`*^9, 3.948927698269987*^9}, {
   3.948928342424011*^9, 3.94892834254709*^9}, 3.9489287471278067`*^9, {
   3.948929222764909*^9, 3.948929233546376*^9}, {3.948956271877733*^9, 
   3.948956335730747*^9}, {3.9489564825099087`*^9, 3.948956493159206*^9}, {
   3.948960003211514*^9, 3.9489600073094807`*^9}, {3.94896365287302*^9, 
   3.948963677434124*^9}, {3.9490742863526077`*^9, 3.9490743049831047`*^9}, {
   3.949256873023085*^9, 3.949256879920795*^9}, {3.949265318994759*^9, 
   3.9492653206598473`*^9}, {3.9492768536575737`*^9, 3.9492768761556177`*^9}, 
   3.9497533660352907`*^9, {3.94977607887269*^9, 3.949776078984749*^9}, 
   3.94996590192381*^9, {3.950704791957477*^9, 3.950704808525811*^9}, {
   3.95077564209023*^9, 3.950775644562255*^9}, {3.9514027419456167`*^9, 
   3.951402744053935*^9}, 3.95148128930046*^9, 3.9515207853807287`*^9, {
   3.951646136091153*^9, 3.951646137296159*^9}, {3.9516569871399183`*^9, 
   3.951656995853641*^9}, {3.951729490467092*^9, 3.95172950429631*^9}, {
   3.952465558177886*^9, 3.952465565283894*^9}, {3.9525027819146833`*^9, 
   3.952502784246978*^9}, {3.9525191488990707`*^9, 3.95251915591208*^9}, {
   3.9526042943935957`*^9, 3.952604296582095*^9}, {3.952604446480341*^9, 
   3.952604457546815*^9}, {3.952731291097948*^9, 3.9527312975765047`*^9}, {
   3.952781475834931*^9, 3.9527814891160717`*^9}, {3.952781524109724*^9, 
   3.9527815337324123`*^9}, {3.952781678715385*^9, 3.952781681166209*^9}, 
   3.9527818224508877`*^9, 3.952784873436721*^9, 3.953115779783675*^9, {
   3.9537955158926287`*^9, 3.9537955175586863`*^9}, {3.9542710661557198`*^9, 
   3.954271104833852*^9}, {3.9542711572044973`*^9, 3.954271232820347*^9}, {
   3.954271364718295*^9, 3.954271418971974*^9}, {3.954271512551505*^9, 
   3.9542715179611*^9}, {3.954317306154208*^9, 3.954317315210108*^9}, {
   3.954364992076049*^9, 3.9543650171528482`*^9}, {3.954365104525299*^9, 
   3.9543651073265676`*^9}, {3.9543652466121283`*^9, 
   3.9543652791793327`*^9}, {3.954365329523818*^9, 3.954365332418498*^9}, {
   3.9543673229992*^9, 3.9543673258713427`*^9}, {3.954368032627035*^9, 
   3.9543680483792686`*^9}, {3.954368359361307*^9, 3.9543684225228043`*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"50903e4b-a676-4fa2-95ed-473b63f5fa6f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parallel Version", "Subsubsection",
 CellChangeTimes->{{3.9492558132774277`*^9, 
  3.949255819557642*^9}},ExpressionUUID->"0ab5b63b-57a3-43b1-ad26-\
943353080a59"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"calculateOverlapParallel", "[", 
    RowBox[{"leftEigenfunction_", ",", "johnsCoeff_", ",", "bathTemp_", ",", 
     RowBox[{"divisions_", ":", "23"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "minT", ",", "maxT", ",", "xs", ",", "boundy", ",", "boundx", ",", 
       "listTheta", ",", "overlaps", ",", "exponent", ",", "tempPlot"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$MinPrecision", "=", "30"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"minT", "=", 
          RowBox[{"0.1", "*", "bathTemp"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"maxT", "=", 
          RowBox[{"8", "*", "bathTemp"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"boundx", "=", 
          RowBox[{"3", "+", 
           RowBox[{
            RowBox[{"Sqrt", "[", "bathTemp", "]"}], "/", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"boundy", "=", 
          RowBox[{"3", "+", 
           RowBox[{
            RowBox[{"Sqrt", "[", "bathTemp", "]"}], "/", "2"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"exponent", "=", "5"}], ";", "\[IndentingNewLine]", 
         RowBox[{"listTheta", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"increment", "^", "exponent"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"increment", ",", 
              RowBox[{"minT", "^", 
               RowBox[{"(", 
                RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"maxT", "^", 
               RowBox[{"(", 
                RowBox[{"1", "/", "exponent"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"maxT", "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "exponent"}], ")"}]}], "-", 
                 RowBox[{"minT", "^", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "exponent"}], ")"}]}]}], ")"}], "/", 
               "divisions"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Initialize", " ", "parallel", " ", "kernels", " ", "if", " ", 
           "not", " ", "already", " ", "done"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"ParallelKernels", "[", "]"}], "]"}], "==", "0"}], ",", 
           RowBox[{
            RowBox[{"LaunchKernels", "[", "]"}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Distribute", " ", "necessary", " ", "definitions", " ", "to", " ", 
           "parallel", " ", "kernels"}], "*)"}], 
         RowBox[{"DistributeDefinitions", "[", 
          RowBox[{"wst", ",", "leftEigenfunction", ",", "johnsCoeff"}], "]"}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Create", " ", "a", " ", "progress", " ", "monitor", " ", 
           "variable"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"progressCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Parallel", " ", "computation", " ", "with", " ", "progress", " ", 
           "monitoring"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"overlaps", "=", "\[IndentingNewLine]", 
          RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Block", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"progressCounter", "++"}], ";", "\[IndentingNewLine]", 
               
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"result", "=", "\[IndentingNewLine]", 
                  RowBox[{"Quiet", "@", 
                   RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"wst", "[", 
                    RowBox[{"theta", ",", "johnsCoeff"}], "]"}], " ", 
                    "leftEigenfunction"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"-", "boundx"}], ",", "boundx"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"v", ",", 
                    RowBox[{"-", "boundy"}], ",", "boundy"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PrecisionGoal", "->", "10"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"MaxRecursion", "->", "40"}]}], 
                    "\[IndentingNewLine]", "]"}]}]}], ";"}], "*)"}], 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"result", "=", 
                RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"wst", "[", 
                    RowBox[{"theta", ",", "johnsCoeff"}], "]"}], " ", 
                   "leftEigenfunction"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", 
                    RowBox[{"-", "boundx"}], ",", "boundx"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"v", ",", 
                    RowBox[{"-", "boundy"}], ",", "boundy"}], "}"}], ",", 
                  RowBox[{"Method", "->", "\"\<MultidimensionalRule\>\""}], ",", 
                  RowBox[{"WorkingPrecision", "->", "25"}], ",", 
                  RowBox[{"PrecisionGoal", "->", "10"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", "result"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"theta", ",", "listTheta"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"listTheta", ",", "overlaps"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"bathTemp", ",", "0"}], "}"}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Optional", ":", 
    RowBox[{
    "Function", " ", "to", " ", "clean", " ", "up", " ", "parallel", " ", 
     "kernels", " ", "when", " ", "done"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cleanupParallelKernels", "[", "]"}], ":=", 
  RowBox[{"CloseKernels", "[", "]"}]}]}], "Input",
 CellChangeTimes->{{3.9492558218974457`*^9, 3.9492558889021063`*^9}, {
  3.949255928954125*^9, 3.9492559372750683`*^9}, {3.949256825573102*^9, 
  3.949256867743657*^9}, {3.949257046254754*^9, 3.949257142284462*^9}, {
  3.949260673472973*^9, 3.949260694486878*^9}, {3.952519329844719*^9, 
  3.952519339133185*^9}, {3.952519379049431*^9, 3.9525193987421227`*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"2c7bc348-fe5d-40be-8185-f7c33c01f973"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
-----------------------
 Wrapping 
 -----------------------\
\>", "Subsection",
 CellChangeTimes->{{3.94846531191602*^9, 3.948465313691968*^9}, {
  3.948465402920411*^9, 3.948465405748117*^9}, {3.9484691475657*^9, 
  3.948469150251185*^9}, {3.948893131932681*^9, 3.94889314137112*^9}, {
  3.9509642647480297`*^9, 
  3.950964266422268*^9}},ExpressionUUID->"537b6d9e-81e8-4046-a9b2-\
e9e00ca6f130"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Wrapped", "[", 
   RowBox[{"initSetup_", ",", " ", 
    RowBox[{"johnsCoeff_", ":", "johnsCoeff"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eigenfunctionR", ",", "eigenfunctionL", ",", "cn", ",", "inverseV", ",",
       "FPeigenfunctionL", ",", "\[IndentingNewLine]", "overlaps", ",", 
      "delta", ",", "dets", ",", "listTheta", ",", "divisions", ",", 
      "checkpoint", ",", "roots", ",", "root", ",", "fdet", ",", 
      "\[IndentingNewLine]", "alpha", ",", "Q", ",", "P", ",", "NN", ",", 
      "theta", ",", "gamma", ",", "number", ",", "setup", ",", 
      "refinedRoot"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "alpha", ",", "Q", ",", "P", ",", "NN", ",", "theta", ",", "gamma"}], 
       "}"}], "=", "initSetup"}], ";", "\[IndentingNewLine]", 
     RowBox[{"alpha", " ", "=", 
      RowBox[{"optimizeAlpha", "[", 
       RowBox[{"initSetup", ",", "johnsCoeff"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"setup", "=", 
      RowBox[{"{", 
       RowBox[{
       "alpha", ",", "Q", ",", "P", ",", "NN", ",", "theta", ",", "gamma"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<alpha updates to: \>\"", ",", "alpha"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"root", ",", "roots", ",", "dets"}], "}"}], "=", 
        RowBox[{"getRoot", "[", 
         RowBox[{"johnsCoeff", ",", "setup"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eigenfunctionR", ",", "cn"}], "}"}], "=", 
        RowBox[{"calculateEigenfunction", "[", 
         RowBox[{
         "root", ",", "gamma", ",", "Q", ",", "NN", ",", "P", ",", "alpha", ",",
           "bathT", ",", "johnsCoeff"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"eigenfunctionR", "===", "$Failed"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           
           RowBox[{"\"\<        !Failed for BathT: \>\"", ",", "bathT", 
            ",", "\"\<, gamma: \>\"", ",", "gamma"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"roots", ",", "dets"}], "}"}], "=", 
      RowBox[{"getRoot", "[", 
       RowBox[{"setup", ",", "johnsCoeff"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"roots", "==", "$Failed"}], ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fdet", "[", "lambda_", "]"}], " ", ":=", " ", 
      RowBox[{"determinant", "[", 
       RowBox[{
       "lambda", ",", " ", "gamma", ",", " ", "Q", ",", " ", "NN", ",", " ", 
        "alpha", ",", " ", "johnsCoeff", ",", " ", "theta"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"delta", "=", 
         RowBox[{"0.006", " ", "+", 
          RowBox[{
           RowBox[{"root", "/", "12"}], "*", "0.065"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"refinedRoot", " ", "=", " ", 
         RowBox[{"FindRootBisection", "[", 
          RowBox[{"fdet", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"root", " ", "-", " ", "delta"}], ",", " ", 
             RowBox[{"root", " ", "+", " ", "delta"}]}], "}"}], ",", " ", 
           "1*^-17", ",", " ", "120"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"eigenfunctionR", ",", "cn"}], "}"}], "=", 
         RowBox[{"calculateEigenfunction", "[", 
          RowBox[{
          "refinedRoot", ",", "gamma", ",", "Q", ",", "NN", ",", "P", ",", 
           "alpha", ",", "theta", ",", "johnsCoeff"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"eigenfunctionR", "=!=", "$Failed"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Selected \>\"", ",", 
             RowBox[{"N", "[", 
              RowBox[{"refinedRoot", ",", "2"}], "]"}], ",", "\"\< out of\>\"",
              ",", 
             RowBox[{"N", "[", 
              RowBox[{"roots", ",", "2"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"root", ",", "roots"}], "}"}]}], "\[IndentingNewLine]", "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"eigenfunctionR", "===", 
        RowBox[{
         RowBox[{"$Failed", " ", "Or", " ", "roots"}], "==", 
         RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eigenfunctionL", "=", 
      RowBox[{"leftEigenfunction", "[", 
       RowBox[{"eigenfunctionR", ",", "johnsCoeff", ",", "theta"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"divisions", "=", "24"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"divisions", "=", "3"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Start calculating Overlap\>\"", "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"overlaps", "=", 
      RowBox[{"calculateOverlap", "[", 
       RowBox[{
       "eigenfunctionL", ",", "johnsCoeff", ",", "theta", ",", "divisions"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"listTheta", ",", "overlaps"}], "}"}], "=", 
        RowBox[{"calculateOverlapParallel", "[", 
         RowBox[{
         "eigenfunctionL", ",", "johnsCoeff", ",", "bathT", ",", 
          "divisions"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"checkpoint", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<theta\>\"", "->", "theta"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"\"\<alpha\>\"", "->", "alpha"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"\"\<gamma\>\"", "->", "gamma"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"\"\<coeff\>\"", "->", "johnsCoeff"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<dets\>\"", "->", "dets"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<cn\>\"", "->", "cn"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<setup\>\"", "->", "setup"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"\"\<roots\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"refinedRoot", ",", "roots"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<overlaps\>\"", "->", "overlaps"}]}], 
       "\[IndentingNewLine]", "|>"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9484647057061663`*^9, 3.9484647265764*^9}, {
   3.948464977522608*^9, 3.9484649904295073`*^9}, {3.948465026890727*^9, 
   3.948465150734321*^9}, {3.948465191372362*^9, 3.948465298627886*^9}, {
   3.948465370679484*^9, 3.948465398174244*^9}, {3.9484690689391727`*^9, 
   3.948469070341529*^9}, 3.948615043132144*^9, {3.9486180198097553`*^9, 
   3.948618027671383*^9}, {3.948618099222567*^9, 3.948618134581859*^9}, {
   3.948618182149969*^9, 3.9486182014845867`*^9}, {3.948619273289452*^9, 
   3.948619290169381*^9}, {3.948728169543456*^9, 3.9487281850121193`*^9}, {
   3.9487282439099283`*^9, 3.948728260452959*^9}, 3.948731153669807*^9, 
   3.948749639553624*^9, {3.948825414761018*^9, 3.9488255180938377`*^9}, {
   3.948825788979466*^9, 3.948825795838188*^9}, {3.948894875456683*^9, 
   3.9488948974052467`*^9}, {3.948894998343903*^9, 3.948895005464828*^9}, {
   3.9488950947639847`*^9, 3.9488950987180367`*^9}, {3.948895279342903*^9, 
   3.94889528229347*^9}, {3.948895359791535*^9, 3.948895368841511*^9}, {
   3.948895408030815*^9, 3.948895430508668*^9}, 3.9488954990122557`*^9, 
   3.94889554731454*^9, {3.9488989164330807`*^9, 3.948898940067704*^9}, {
   3.948899409108027*^9, 3.948899417947838*^9}, {3.948919676849802*^9, 
   3.94891968207445*^9}, {3.948928710731451*^9, 3.948928721245751*^9}, {
   3.948929084504201*^9, 3.948929116434887*^9}, {3.949068762692774*^9, 
   3.949068788773045*^9}, {3.949258439041092*^9, 3.949258450509851*^9}, 
   3.949261742295473*^9, {3.949261880391404*^9, 3.949261898929528*^9}, {
   3.949276894258306*^9, 3.949276899308907*^9}, {3.949310259015582*^9, 
   3.949310265060409*^9}, {3.9493108246404123`*^9, 3.949310825463901*^9}, {
   3.949495803366798*^9, 3.949495814104891*^9}, {3.94996659537717*^9, 
   3.949966600544034*^9}, {3.950735417263919*^9, 3.950735490691476*^9}, {
   3.950735895936899*^9, 3.950735927417185*^9}, {3.950741840319581*^9, 
   3.9507418556082563`*^9}, {3.9507447589231567`*^9, 3.950744759598978*^9}, {
   3.950744835810504*^9, 3.950744838003607*^9}, {3.950744872498884*^9, 
   3.9507448863587*^9}, 3.950775132088237*^9, 3.9507756676802692`*^9, {
   3.950775765093336*^9, 3.950775816076679*^9}, 3.950775937332591*^9, {
   3.950777281205104*^9, 3.95077733343546*^9}, {3.951222760908938*^9, 
   3.951222806575927*^9}, {3.9512228744502897`*^9, 3.9512228903344927`*^9}, {
   3.951222980205069*^9, 3.95122299653738*^9}, {3.9514040098954277`*^9, 
   3.95140403355262*^9}, {3.9514219553252163`*^9, 3.951421960908581*^9}, {
   3.9514219996467037`*^9, 3.951422007634001*^9}, {3.951482621343625*^9, 
   3.951482636725898*^9}, {3.9515023146949587`*^9, 3.9515023289709797`*^9}, {
   3.951505123059986*^9, 3.951505157719737*^9}, {3.9523693033245697`*^9, 
   3.952369306721126*^9}, {3.9523829072820673`*^9, 3.952382912338234*^9}, {
   3.952382977504681*^9, 3.952382979559617*^9}, {3.9524317932253857`*^9, 
   3.952431796059373*^9}, {3.952506417184917*^9, 3.9525064537871113`*^9}, {
   3.952519253977418*^9, 3.952519271899332*^9}, {3.952525509189025*^9, 
   3.952525590227098*^9}, {3.952601321821169*^9, 3.952601340215798*^9}, {
   3.9526044783766127`*^9, 3.952604492623904*^9}, {3.952732116539049*^9, 
   3.952732118827036*^9}, {3.9543223573257713`*^9, 3.954322419545947*^9}, {
   3.9543690444691963`*^9, 3.954369046443165*^9}, {3.9543691120533752`*^9, 
   3.954369126111355*^9}, {3.954371152193863*^9, 3.954371181285037*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"a4823945-820a-41e9-9a34-eabbd26aa124"]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking for the effect", "Subsection",
 CellChangeTimes->{{3.948616488129167*^9, 
  3.9486165002174253`*^9}},ExpressionUUID->"f4736f96-c3d3-4c6d-826d-\
6adf8308796e"],

Cell[CellGroupData[{

Cell["Strong", "Subsubsection",
 CellChangeTimes->{
  3.94951710815476*^9},ExpressionUUID->"773d1c6f-c7da-4295-9b0d-4b958b0a5631"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StrongMpembaQ", "[", "checkpoint_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "DMEstate", ",", "IMEstate", ",", "theta", ",", "overlaps", ",", "type", 
      ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "checkpoint", "]"}], "=!=", "Association"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Corrupted Checkpoint\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"theta", ",", "overlaps"}], "}"}], " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"checkpoint", "[", 
         RowBox[{"[", "\"\<overlaps\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"DMEstate", ",", "IMEstate"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ind", "=", "1"}], ",", 
       RowBox[{"ind", "<", 
        RowBox[{"Length", "[", "overlaps", "]"}]}], ",", 
       RowBox[{"ind", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sign", "[", 
             RowBox[{"overlaps", "[", 
              RowBox[{"[", "ind", "]"}], "]"}], "]"}], "=!=", 
            RowBox[{"Sign", "[", 
             RowBox[{"overlaps", "[", 
              RowBox[{"[", 
               RowBox[{"ind", "+", "1"}], "]"}], "]"}], "]"}]}], "&&", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"theta", "[", 
              RowBox[{"[", "ind", "]"}], "]"}], ">", 
             RowBox[{"checkpoint", "[", 
              RowBox[{"[", 
               
               RowBox[{"\"\<theta\>\"", "\"\<]]|| checkpoint[[\>\"", 
                "theta", "\"\<\>\""}], "]"}], "]"}], ">", 
             RowBox[{"theta", "[", 
              RowBox[{"[", 
               RowBox[{"ind", "+", "1"}], "]"}], "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DMEstate", "===", "False"}], "&&", 
              RowBox[{
               RowBox[{"theta", "[", 
                RowBox[{"[", "ind", "]"}], "]"}], ">", 
               RowBox[{"checkpoint", "[", 
                RowBox[{"[", 
                 
                 RowBox[{"\"\<theta\>\"", \
"\"\<]],\[IndentingNewLine]DMEstate=True];\[IndentingNewLine]\
\[IndentingNewLine]If[IMEstate===False&&theta[[ind]]<checkpoint[[\>\"", 
                  "theta", "\"\<\>\""}], "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IMEstate", " ", "=", " ", "True"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", " ", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IMEstate", "   ", "&&", "    ", "DMEstate"}], ",", "2", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"IMEstate", "   ", "&&", " ", 
         RowBox[{"!", "DMEstate"}]}], ",", 
        RowBox[{"-", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"!", "IMEstate"}], "&&", "    ", "DMEstate"}], ",", "1", ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"!", "DMEstate"}], "&&", " ", 
         RowBox[{"!", "IMEstate"}]}], ",", "0"}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9486165081248703`*^9, 3.948616617341029*^9}, {
   3.948616648633191*^9, 3.9486167511502657`*^9}, {3.948619130835945*^9, 
   3.9486192075445833`*^9}, {3.948619362022678*^9, 3.9486195332774277`*^9}, {
   3.94861962432008*^9, 3.948619660531488*^9}, {3.948619698861425*^9, 
   3.948619822092078*^9}, 3.948731321389688*^9, {3.9487317996394033`*^9, 
   3.948731863843717*^9}, 3.948731895058469*^9, {3.9487320047004766`*^9, 
   3.948732054443671*^9}, 3.9487321416829243`*^9, {3.9487322494289494`*^9, 
   3.9487323340829363`*^9}, {3.948732373354253*^9, 3.948732395117753*^9}, 
   3.9488953031300297`*^9, {3.948922155428713*^9, 3.9489221701751013`*^9}, {
   3.948922215030998*^9, 3.9489223047627497`*^9}, {3.948922461652895*^9, 
   3.948922472072445*^9}, {3.948928599800762*^9, 3.9489286191143217`*^9}, 
   3.948954787950817*^9, {3.948954977661559*^9, 3.948954981703179*^9}, {
   3.948955219262743*^9, 3.948955266784865*^9}, {3.9489570922574244`*^9, 
   3.948957116901936*^9}, {3.948957464042658*^9, 3.948957507720756*^9}, {
   3.948957884579102*^9, 3.9489579287852087`*^9}, {3.948958180015614*^9, 
   3.948958182654131*^9}, {3.94906584981721*^9, 3.94906585170166*^9}, {
   3.949067017816308*^9, 3.949067034139781*^9}, {3.949068287180599*^9, 
   3.949068289466165*^9}, {3.949485460031389*^9, 3.949485490049787*^9}, {
   3.949485567861217*^9, 3.9494856115185328`*^9}, {3.94948608949727*^9, 
   3.949486115527054*^9}, {3.949486326104444*^9, 3.9494864193009033`*^9}, 
   3.949486483942346*^9, {3.949486514473254*^9, 3.9494865374548903`*^9}, {
   3.949486582305709*^9, 3.94948667783438*^9}, {3.949486770011243*^9, 
   3.9494867712174187`*^9}, {3.949487008903326*^9, 3.94948702905371*^9}, {
   3.94948723144631*^9, 3.9494872361662817`*^9}, {3.949490546891946*^9, 
   3.9494905488611317`*^9}, {3.949490693796867*^9, 3.949490736040015*^9}, {
   3.949494326087199*^9, 3.949494404290782*^9}, {3.949494521537462*^9, 
   3.949494546589486*^9}, {3.9494946699343*^9, 3.949494670738326*^9}, 
   3.949522770611812*^9, 3.949966615959221*^9, {3.95005528188476*^9, 
   3.950055305746108*^9}, {3.950055390759945*^9, 3.950055411776462*^9}, 
   3.950055575110962*^9, 3.950056076858979*^9, {3.954399298321842*^9, 
   3.9543992988467216`*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"25ca6ac1-f371-49da-925b-daea596129cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weak", "Subsubsection",
 CellChangeTimes->{{3.94951711527857*^9, 
  3.9495171162083607`*^9}},ExpressionUUID->"c1e10939-d642-4c6d-a6f2-\
524c35c3b9b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WeakMpembaQ", "[", "checkpoint_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "DMEstate", ",", "IMEstate", ",", "theta", ",", "overlaps", ",", "type",
        ",", "result", ",", "cross"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "checkpoint", "]"}], "=!=", "Association"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Corrupted Checkpoint\>\"", "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"theta", ",", "overlaps"}], "}"}], " ", "=", " ", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"checkpoint", "[", 
          RowBox[{"[", "\"\<overlaps\>\"", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DMEstate", ",", "IMEstate"}], "}"}], " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"False", ",", "False"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cross", "[", "ind_", "]"}], ":=", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Sign", "[", 
         RowBox[{
          RowBox[{"overlaps", "[", 
           RowBox[{"[", "ind", "]"}], "]"}], "-", 
          RowBox[{"overlaps", "[", 
           RowBox[{"[", 
            RowBox[{"ind", "+", "1"}], "]"}], "]"}]}], "]"}], "=!=", 
        RowBox[{"Sign", "[", 
         RowBox[{
          RowBox[{"overlaps", "[", 
           RowBox[{"[", 
            RowBox[{"ind", "+", "1"}], "]"}], "]"}], "-", 
          RowBox[{"overlaps", "[", 
           RowBox[{"[", 
            RowBox[{"ind", "+", "2"}], "]"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ind", "=", "1"}], ",", 
        RowBox[{"ind", "<", 
         RowBox[{
          RowBox[{"Length", "[", "overlaps", "]"}], "-", "2"}]}], ",", 
        RowBox[{"ind", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"cross", "[", "ind", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DMEstate", "===", "False"}], "&&", 
               RowBox[{
                RowBox[{"theta", "[", 
                 RowBox[{"[", "ind", "]"}], "]"}], ">", 
                RowBox[{"checkpoint", "[", 
                 RowBox[{"[", 
                  
                  RowBox[{"\"\<theta\>\"", \
"\"\<]],\[IndentingNewLine]DMEstate=True];\[IndentingNewLine]\
\[IndentingNewLine]If[IMEstate===False&&theta[[ind]]<checkpoint[[\>\"", 
                   "theta", "\"\<\>\""}], "]"}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"IMEstate", " ", "=", " ", "True"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", " ", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IMEstate", "   ", "&&", "    ", "DMEstate"}], ",", "2", ",",
          "\[IndentingNewLine]", 
         RowBox[{"IMEstate", "   ", "&&", " ", 
          RowBox[{"!", "DMEstate"}]}], ",", 
         RowBox[{"-", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"!", "IMEstate"}], "&&", "    ", "DMEstate"}], ",", "1", ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"!", "DMEstate"}], "&&", " ", 
          RowBox[{"!", "IMEstate"}]}], ",", "0"}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "result"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StrongMpembaQ", "[", "checkpoint_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "DMEstate", ",", "IMEstate", ",", "theta", ",", "overlaps", ",", "type", 
      ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"checkpoint", "===", "$Failed"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Corrupted Checkpoint\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"theta", ",", "overlaps"}], "}"}], " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"checkpoint", "[", 
         RowBox[{"[", "\"\<overlaps\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"DMEstate", ",", "IMEstate"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ind", "=", "1"}], ",", 
       RowBox[{"ind", "<", 
        RowBox[{"Length", "[", "overlaps", "]"}]}], ",", 
       RowBox[{"ind", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sign", "[", 
             RowBox[{"overlaps", "[", 
              RowBox[{"[", "ind", "]"}], "]"}], "]"}], "=!=", 
            RowBox[{"Sign", "[", 
             RowBox[{"overlaps", "[", 
              RowBox[{"[", 
               RowBox[{"ind", "+", "1"}], "]"}], "]"}], "]"}]}], "&&", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"theta", "[", 
              RowBox[{"[", "ind", "]"}], "]"}], ">", 
             RowBox[{"checkpoint", "[", 
              RowBox[{"[", 
               
               RowBox[{"\"\<theta\>\"", "\"\<]]|| checkpoint[[\>\"", 
                "theta", "\"\<\>\""}], "]"}], "]"}], ">", 
             RowBox[{"theta", "[", 
              RowBox[{"[", 
               RowBox[{"ind", "+", "1"}], "]"}], "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DMEstate", "===", "False"}], "&&", 
              RowBox[{
               RowBox[{"theta", "[", 
                RowBox[{"[", "ind", "]"}], "]"}], ">", 
               RowBox[{"checkpoint", "[", 
                RowBox[{"[", 
                 
                 RowBox[{"\"\<theta\>\"", \
"\"\<]],\[IndentingNewLine]DMEstate=True];\[IndentingNewLine]\
\[IndentingNewLine]If[IMEstate===False&&theta[[ind]]<checkpoint[[\>\"", 
                  "theta", "\"\<\>\""}], "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"IMEstate", " ", "=", " ", "True"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", " ", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IMEstate", "   ", "&&", "    ", "DMEstate"}], ",", "2", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"IMEstate", "   ", "&&", " ", 
         RowBox[{"!", "DMEstate"}]}], ",", 
        RowBox[{"-", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"!", "IMEstate"}], "&&", "    ", "DMEstate"}], ",", "1", ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"!", "DMEstate"}], "&&", " ", 
         RowBox[{"!", "IMEstate"}]}], ",", "0"}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.948616624407888*^9, 3.948616645747787*^9}, {
   3.948616762280587*^9, 3.948616766915872*^9}, {3.9495171250529213`*^9, 
   3.9495171257609577`*^9}, {3.949517184463935*^9, 3.9495172421938334`*^9}, {
   3.9495173277543287`*^9, 3.9495173279110813`*^9}, {3.949517508805974*^9, 
   3.949517556933577*^9}, {3.949522082568499*^9, 3.949522117357502*^9}, {
   3.949522159280283*^9, 3.949522203071588*^9}, {3.949522691610812*^9, 
   3.94952269198039*^9}, {3.9495227626252613`*^9, 3.9495227644118757`*^9}, {
   3.949523134503137*^9, 3.949523135526801*^9}, 3.949966624209188*^9, {
   3.9500546977222967`*^9, 3.9500547004564867`*^9}, 3.950054732376556*^9, {
   3.950055133219626*^9, 3.9500551337496243`*^9}, 3.9500552724820347`*^9, 
   3.950055418135824*^9, {3.950055552023535*^9, 3.950055560065735*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"04b62cc5-4d35-47d0-a4d6-21b91abcf4f1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase space visualize", "Subsection",
 CellChangeTimes->{{3.948615700882386*^9, 
  3.948615714449568*^9}},ExpressionUUID->"7324fb25-37d6-44c2-9b9d-\
e640549b13d9"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.948797629191649*^9, 3.948797719580393*^9}, {
  3.9487979470736732`*^9, 3.948797947293523*^9}, {3.9487981675953074`*^9, 
  3.948798182388719*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"ed49c4a6-8735-4857-8438-e34f0a933545"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"eb7a872b-40d9-4abe-86f6-89337babe0b8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 162, 3, 144, "Title",ExpressionUUID->"09f445ad-8fd2-4ccf-b0ef-7cea5dd83cd9"],
Cell[741, 27, 170, 3, 78, "Subtitle",ExpressionUUID->"85351fd8-07d9-459e-a28d-3f90274c1bdd"],
Cell[CellGroupData[{
Cell[936, 34, 203, 4, 79, "Subsection",ExpressionUUID->"5343f9c6-9da5-429e-9fb4-f2612009e761"],
Cell[CellGroupData[{
Cell[1164, 42, 164, 3, 65, "Subsubsection",ExpressionUUID->"845d9d88-4bdb-4de3-b4be-d5c723641334"],
Cell[1331, 47, 1717, 45, 319, "Input",ExpressionUUID->"8a44a3e0-ce0e-478b-a929-7a2e7cfc0eed"]
}, Closed]],
Cell[CellGroupData[{
Cell[3085, 97, 168, 3, 51, "Subsubsection",ExpressionUUID->"cd6019d3-1057-4669-a05f-335ecf1bc5bc"],
Cell[3256, 102, 749, 24, 74, "Input",ExpressionUUID->"22409a06-d305-448b-b3ca-dbf9cb9d53fa"],
Cell[4008, 128, 4994, 150, 779, "Input",ExpressionUUID->"ac1628b7-5631-4b90-bbba-27a097c10511"]
}, Closed]],
Cell[CellGroupData[{
Cell[9039, 283, 132, 3, 51, "Subsubsection",ExpressionUUID->"be8553f3-73ea-4005-9bef-72756efc5527"],
Cell[9174, 288, 4057, 116, 442, "Input",ExpressionUUID->"1ab9cb8d-fc86-4811-aa32-71453ebee0e2"]
}, Closed]],
Cell[CellGroupData[{
Cell[13268, 409, 160, 3, 51, "Subsubsection",ExpressionUUID->"2b337ebe-4c1d-45b7-be66-b21119cf15d6"],
Cell[13431, 414, 1594, 42, 172, "Input",ExpressionUUID->"7e5332de-bf2e-4279-99be-02318fcd2cf7"],
Cell[15028, 458, 9191, 255, 1326, "Input",ExpressionUUID->"dc067ecb-e4cd-45b1-88d7-7eeb7232c110"]
}, Closed]],
Cell[CellGroupData[{
Cell[24256, 718, 167, 3, 51, "Subsubsection",ExpressionUUID->"cea11edd-e0e9-4dcf-9815-c826d70b07f6"],
Cell[24426, 723, 5620, 158, 790, "Input",ExpressionUUID->"5fed0403-3447-42bf-a31e-614a2f87427c"]
}, Closed]],
Cell[CellGroupData[{
Cell[30083, 886, 161, 3, 51, "Subsubsection",ExpressionUUID->"94f8b1c0-51cb-48ee-a7ed-df4c126c3c99"],
Cell[30247, 891, 4362, 104, 993, "Input",ExpressionUUID->"a4480444-a9e3-4d7e-89d0-14b1e8d35e8c"]
}, Closed]],
Cell[CellGroupData[{
Cell[34646, 1000, 211, 4, 51, "Subsubsection",ExpressionUUID->"be6dee1c-5dc2-41be-b9d5-df19c79476e8"],
Cell[34860, 1006, 2725, 76, 434, "Input",ExpressionUUID->"f85de152-6baf-4a20-995b-1a52777e7f66"],
Cell[37588, 1084, 1375, 35, 350, "Input",ExpressionUUID->"1934686c-c9c1-4b7d-beb3-abb47521777a"]
}, Closed]],
Cell[CellGroupData[{
Cell[39000, 1124, 173, 3, 51, "Subsubsection",ExpressionUUID->"64a03f8f-149f-479f-b225-8d102722ef81"],
Cell[39176, 1129, 4858, 120, 656, "Input",ExpressionUUID->"c13e62f2-66b5-4831-85cf-78b22c183fee"],
Cell[44037, 1251, 4843, 117, 626, "Input",ExpressionUUID->"bbfd5e5c-4b1a-49ca-a78d-6f68930f8aab"],
Cell[48883, 1370, 6838, 163, 840, "Input",ExpressionUUID->"0d88eeca-9a79-477d-85be-837b81ac15b4"]
}, Closed]],
Cell[CellGroupData[{
Cell[55758, 1538, 224, 4, 51, "Subsubsection",ExpressionUUID->"6858b706-db17-4b23-b969-86666657f48e"],
Cell[55985, 1544, 1712, 37, 442, "Input",ExpressionUUID->"b18cf67a-9ca1-490c-90b3-c5971f07769a"],
Cell[57700, 1583, 4430, 104, 901, "Input",ExpressionUUID->"70801402-dd40-4066-8871-939eea576b03"]
}, Closed]],
Cell[CellGroupData[{
Cell[62167, 1692, 229, 4, 51, "Subsubsection",ExpressionUUID->"055b5b06-41ce-42f3-9ea1-b07ca801af20"],
Cell[62399, 1698, 3898, 100, 577, "Input",ExpressionUUID->"f0216daa-c746-49fd-bb46-9f67f4bfcc44"],
Cell[66300, 1800, 151, 3, 44, "Input",ExpressionUUID->"886a97c8-46de-489a-b081-3a4dff20acf4"],
Cell[66454, 1805, 936, 21, 220, "Input",ExpressionUUID->"0088a4a6-b716-43c4-ad99-d5900b60b03f"]
}, Closed]],
Cell[CellGroupData[{
Cell[67427, 1831, 168, 3, 51, "Subsubsection",ExpressionUUID->"b56b3974-6db4-4562-a31e-b6df241879fb"],
Cell[67598, 1836, 6276, 154, 1116, "Input",ExpressionUUID->"e18050f7-4b3c-40c3-a133-96d25aa5644e"]
}, Closed]],
Cell[CellGroupData[{
Cell[73911, 1995, 161, 3, 51, "Subsubsection",ExpressionUUID->"5b6e98e7-56ab-4d04-8588-71ff3611f58d"],
Cell[74075, 2000, 999, 23, 411, "Input",ExpressionUUID->"a64aabc7-d176-4ec2-8dea-bc02c6d2a8ab"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75123, 2029, 210, 4, 79, "Subsection",ExpressionUUID->"c18f6b7c-ccd7-4988-ba16-056a9c05ecd6"],
Cell[75336, 2035, 3977, 98, 503, "Input",ExpressionUUID->"720a1c30-c974-417f-8acb-07716b32a410"],
Cell[79316, 2135, 3876, 98, 687, "Input",ExpressionUUID->"df1f743c-67d1-48b2-9b73-d8f5e180957b"]
}, Closed]],
Cell[CellGroupData[{
Cell[83229, 2238, 251, 4, 53, "Subsection",ExpressionUUID->"72da9c91-0a17-485c-994d-d9bb38e9fccb"],
Cell[83483, 2244, 3012, 65, 350, "Input",ExpressionUUID->"1acbc846-6247-409e-bf27-435cfc4065dd"],
Cell[86498, 2311, 2466, 65, 381, "Input",ExpressionUUID->"8067a5dc-3696-4baa-b2dc-5c8e69df295c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89001, 2381, 160, 3, 79, "Subsection",ExpressionUUID->"a531008a-1fe4-4fff-adaf-bc5d705e3c83"],
Cell[CellGroupData[{
Cell[89186, 2388, 750, 18, 135, "Input",ExpressionUUID->"9de187fe-5489-41f6-915b-8f543abc3306"],
Cell[89939, 2408, 1918, 60, 120, "Output",ExpressionUUID->"892a9f89-b579-4805-b8e2-ab18d74ae583"]
}, Open  ]],
Cell[91872, 2471, 7750, 199, 1453, "Input",ExpressionUUID->"082266ed-2d80-4a26-bf2b-4c6eda139d45"],
Cell[99625, 2672, 6009, 153, 748, "Input",ExpressionUUID->"d1c20dd7-c6a5-4122-95bd-2617eb62e504"],
Cell[CellGroupData[{
Cell[105659, 2829, 182, 3, 65, "Subsubsection",ExpressionUUID->"9076a0aa-c5a3-4e57-8fff-d5f0cdce68a4"],
Cell[105844, 2834, 7037, 167, 796, "Input",ExpressionUUID->"599e526c-26cd-468a-9c16-4b3cb286875a"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112930, 3007, 234, 4, 79, "Subsection",ExpressionUUID->"60f16c4a-cdc8-45f7-bd3d-dce4652bcfa4"],
Cell[113167, 3013, 2756, 63, 595, "Input",ExpressionUUID->"c8379d4f-5c71-42bf-b5ad-48f7182ad0b4"],
Cell[115926, 3078, 3467, 81, 595, "Input",ExpressionUUID->"f17955f2-34e6-4968-a092-703f98899044"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119430, 3164, 156, 3, 79, "Subsection",ExpressionUUID->"23e736b2-e322-4f7b-8611-2594bea1c9e1"],
Cell[CellGroupData[{
Cell[119611, 3171, 168, 3, 65, "Subsubsection",ExpressionUUID->"49a67774-febb-408a-96e2-fc9d9e68e36f"],
Cell[119782, 3176, 1442, 33, 166, "Input",ExpressionUUID->"d3decc74-24b2-4429-b815-0e4b2ee88564"],
Cell[121227, 3211, 4849, 110, 983, "Input",ExpressionUUID->"f31f9bba-9986-44f5-8b09-06f0b54bb7c0"],
Cell[126079, 3323, 4021, 102, 595, "Input",ExpressionUUID->"ece2424c-45c0-4187-9654-42738487339f"],
Cell[130103, 3427, 7815, 164, 1514, "Input",ExpressionUUID->"c4101054-d238-41fc-b6a2-0eb2df58a8dd"]
}, Closed]],
Cell[CellGroupData[{
Cell[137955, 3596, 223, 4, 51, "Subsubsection",ExpressionUUID->"91853d80-cdcd-43e1-8a93-88ea54e28991"],
Cell[138181, 3602, 5561, 121, 1085, "Input",ExpressionUUID->"aad5b884-bc07-4301-af69-794ed62a7bfb"],
Cell[CellGroupData[{
Cell[143767, 3727, 170, 3, 44, "Input",ExpressionUUID->"1b9699af-e802-4739-899b-1f17af8491ec"],
Cell[143940, 3732, 169, 3, 70, "Output",ExpressionUUID->"4873c25d-47db-4ed5-a18a-2f774c2dec8b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[144158, 3741, 142, 3, 51, "Subsubsection",ExpressionUUID->"05ea0d55-3657-4874-9f94-24d93636edcc"],
Cell[144303, 3746, 3121, 77, 534, "Input",ExpressionUUID->"4cd21e2e-94eb-4b23-bffb-7e845306d28a"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[147473, 3829, 160, 3, 79, "Subsection",ExpressionUUID->"ff92da06-d757-44dd-85b5-722525fc0933"],
Cell[147636, 3834, 2118, 54, 289, "Input",ExpressionUUID->"e07363cc-f2e9-4651-b139-2f53220d97fd"],
Cell[149757, 3890, 2522, 69, 227, "Input",ExpressionUUID->"4290ef25-74d1-4dd5-b674-1c8a4293ca4f"]
}, Closed]],
Cell[CellGroupData[{
Cell[152316, 3964, 181, 3, 53, "Subsection",ExpressionUUID->"78001a50-6a96-418f-9744-5370b29a1b50"],
Cell[152500, 3969, 10964, 251, 1681, "Input",ExpressionUUID->"a2655175-c00e-45ec-88e1-6394deba7692"],
Cell[163467, 4222, 6743, 172, 840, "Input",ExpressionUUID->"c6f58fb5-d02e-4f43-86e6-297ec0eab6c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170247, 4399, 176, 3, 79, "Subsection",ExpressionUUID->"aecafedc-4f67-4674-a8d3-0d6de3cfc227"],
Cell[170426, 4404, 225, 4, 44, "Input",ExpressionUUID->"7339fc23-2f83-4eb9-b303-8ab2eb985f89"],
Cell[170654, 4410, 1340, 34, 258, "Input",ExpressionUUID->"cbabe79b-e397-4585-bcd3-411aae382399"]
}, Closed]],
Cell[CellGroupData[{
Cell[172031, 4449, 225, 4, 53, "Subsection",ExpressionUUID->"4132f726-6777-4da1-802b-95810ec0bc0c"],
Cell[CellGroupData[{
Cell[172281, 4457, 169, 3, 65, "Subsubsection",ExpressionUUID->"ee859923-fcef-45a0-b970-2cf0a9ce8695"],
Cell[172453, 4462, 5405, 135, 840, "Input",ExpressionUUID->"46dd4934-dce9-4537-844d-cb2d77fa488c"],
Cell[177861, 4599, 8289, 172, 943, "Input",ExpressionUUID->"50903e4b-a676-4fa2-95ed-473b63f5fa6f"]
}, Closed]],
Cell[CellGroupData[{
Cell[186187, 4776, 169, 3, 51, "Subsubsection",ExpressionUUID->"0ab5b63b-57a3-43b1-ad26-943353080a59"],
Cell[186359, 4781, 7641, 169, 1606, "Input",ExpressionUUID->"2c7bc348-fe5d-40be-8185-f7c33c01f973"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[194049, 4956, 406, 10, 158, "Subsection",ExpressionUUID->"537b6d9e-81e8-4046-a9b2-e9e00ca6f130"],
Cell[194458, 4968, 11282, 232, 2219, "Input",ExpressionUUID->"a4823945-820a-41e9-9a34-eabbd26aa124"]
}, Closed]],
Cell[CellGroupData[{
Cell[205777, 5205, 173, 3, 53, "Subsection",ExpressionUUID->"f4736f96-c3d3-4c6d-826d-6adf8308796e"],
Cell[CellGroupData[{
Cell[205975, 5212, 130, 2, 65, "Subsubsection",ExpressionUUID->"773d1c6f-c7da-4295-9b0d-4b958b0a5631"],
Cell[206108, 5216, 6473, 135, 963, "Input",ExpressionUUID->"25ca6ac1-f371-49da-925b-daea596129cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212618, 5356, 156, 3, 65, "Subsubsection",ExpressionUUID->"c1e10939-d642-4c6d-a6f2-524c35c3b9b5"],
Cell[212777, 5361, 9286, 218, 2035, "Input",ExpressionUUID->"04b62cc5-4d35-47d0-a4d6-21b91abcf4f1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[222112, 5585, 169, 3, 79, "Subsection",ExpressionUUID->"7324fb25-37d6-44c2-9b9d-e640549b13d9"],
Cell[222284, 5590, 296, 5, 98, "Input",ExpressionUUID->"ed49c4a6-8735-4857-8438-e34f0a933545"]
}, Open  ]]
}, Open  ]]
}
]
*)

